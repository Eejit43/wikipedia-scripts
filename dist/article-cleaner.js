// <nowiki>
// Note: This script was compiled and minified from TypeScript. For a more readable version, see https://github.com/Eejit43/wikipedia-scripts/blob/main/scripts/article-cleaner.ts

"use strict";(()=>{mw.config.get("wgNamespaceNumber")<0||mw.config.get("wgIsProbablyEditable")&&mw.loader.using(["mediawiki.util","jquery.textSelection"],()=>{mw.util.addCSS(`
#article-cleaner {
    display: none;
}

#content:has(#wpTextbox1) #article-cleaner {
    display: unset;
}`),mw.util.addPortletLink(mw.config.get("skin")==="minerva"?"p-navigation":"p-cactions","#","Perform article cleanup","article-cleaner").addEventListener("click",f=>{f.preventDefault();let p=$("#wpTextbox1");if(p.length===0)return mw.notify("Edit box not found!",{type:"error",autoHideSeconds:"short"});let r=p.textSelection("getContents");if(!r)return mw.notify("Edit box value not found!",{type:"error",autoHideSeconds:"short"});r=g(r),p.textSelection("setContents",r),p.textSelection("setSelection",{start:0})})});function g(u){let f;(e=>(e[e.Expanded=0]="Expanded",e[e.ExpandedAligned=1]="ExpandedAligned",e[e.Minimized=2]="Minimized",e[e.MinimizedSpaced=3]="MinimizedSpaced"))(f||={});class p{location;isNested=!1;fullText;fullTextEscaped;name;parameters=[];subTemplates=[];pipeEscapeRegexes=[/(\[\[[^\]]*?)\|(.*?]])/g,/(<!--.*?)\|(.*?-->)/g,/(<nowiki>.*?)\|(.*?<\/nowiki>)/g];defaultTemplateStyles={1:["infobox","speciesbox","taxobox","automatic taxobox","osm location map","motorsport season"],2:["coord","start date","end date"]};constructor(t){this.location={start:t}}parse(){this.fullText=u.slice(this.location.start,this.location.end),this.fullTextEscaped=this.fullText;for(let e of this.subTemplates)e.parse(),this.fullTextEscaped=this.fullTextEscaped.replace(e.fullText,"");let t=this.fullTextEscaped.slice(2,-2).trim();for(let e of this.pipeEscapeRegexes)for(;e.test(t);)t=t.replaceAll(e,"$1$2");let i=t.split("|").map(e=>e.replaceAll("","|").trim());this.name=i.shift();let o=i.map(e=>{let l=e.indexOf("=");return l===-1?{key:null,value:e.trim()}:{key:e.slice(0,l).trim(),value:e.slice(l+1).trim()}});this.parameters=o}getStyle(){for(let[t,i]of Object.entries(this.defaultTemplateStyles))for(let o of i)if(this.name.toLowerCase().startsWith(o))return Number.parseInt(t)}format(){this.fullText||this.parse();let t=this.getStyle();if(t===void 0)return this.fullText;let i=[`{{${this.name}`];if(t===0||t===1){let e=0;t===1&&(e=Math.max(...this.parameters.map(l=>l.key?.length??0)));for(let l of this.parameters)i.push(`| ${l.key?`${l.key.padEnd(e)} = `:""}${l.value}`)}else for(let e of this.parameters)e.value&&i.push(`|${e.key?`${e.key}=`:""}${e.value}`);i.push("}}"),i.length===2?(i[0]+="}}",i.pop()):t===3&&(i[i.length-2]+="}}",i.pop());let o=i.join(t===0||t===1?`
`:t===3?" ":"");for(let e of this.subTemplates)o=o.replace("",e.format());return o}}let r=[],c=[],m=!1,d=!1,h=!1,n=0;function a(s,t=!0){let i=u.slice(n,n+s.length)===s;return i&&t&&(n+=s.length),i}for(;n<u.length;)if(a("<nowiki>"))d=!0;else if(a("</nowiki>"))d=!1;else if(a("<!--"))h=!0;else if(a("-->"))h=!1;else if(!d&&!h)if(a("[["))m=!0;else if(m&&a("]]"))m=!1;else if(a("{{")){let s=new p(n-2);c.length>0&&(s.isNested=!0,c.at(-1)?.subTemplates.push(s)),c.push(s)}else if(a("}}")){let s=c.pop();if(!s)continue;s.location.end=n,r.push(s)}else n++;else n++;let x=u;for(let s of r)s.isNested||(s.parse(),x=x.replace(s.fullText,s.format()));return x}})();

// </nowiki>
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc2NyaXB0cy9hcnRpY2xlLWNsZWFuZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIigoKSA9PiB7XG4gICAgaWYgKG13LmNvbmZpZy5nZXQoJ3dnTmFtZXNwYWNlTnVtYmVyJykgPCAwKSByZXR1cm47IC8vIERvbid0IHJ1biBpbiB2aXJ0dWFsIG5hbWVzcGFjZXNcbiAgICBpZiAoIW13LmNvbmZpZy5nZXQoJ3dnSXNQcm9iYWJseUVkaXRhYmxlJykpIHJldHVybjsgLy8gRG9uJ3QgcnVuIGlmIHVzZXIgY2FuJ3QgZWRpdCBwYWdlXG5cbiAgICBtdy5sb2FkZXIudXNpbmcoWydtZWRpYXdpa2kudXRpbCcsICdqcXVlcnkudGV4dFNlbGVjdGlvbiddLCAoKSA9PiB7XG4gICAgICAgIG13LnV0aWwuYWRkQ1NTKGBcbiNhcnRpY2xlLWNsZWFuZXIge1xuICAgIGRpc3BsYXk6IG5vbmU7XG59XG5cbiNjb250ZW50Omhhcygjd3BUZXh0Ym94MSkgI2FydGljbGUtY2xlYW5lciB7XG4gICAgZGlzcGxheTogdW5zZXQ7XG59YCk7XG5cbiAgICAgICAgY29uc3QgbGluayA9IG13LnV0aWwuYWRkUG9ydGxldExpbmsoXG4gICAgICAgICAgICBtdy5jb25maWcuZ2V0KCdza2luJykgPT09ICdtaW5lcnZhJyA/ICdwLW5hdmlnYXRpb24nIDogJ3AtY2FjdGlvbnMnLFxuICAgICAgICAgICAgJyMnLFxuICAgICAgICAgICAgJ1BlcmZvcm0gYXJ0aWNsZSBjbGVhbnVwJyxcbiAgICAgICAgICAgICdhcnRpY2xlLWNsZWFuZXInLFxuICAgICAgICApITtcblxuICAgICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBjb25zdCBlZGl0Qm94ID0gJCgnI3dwVGV4dGJveDEnKTtcbiAgICAgICAgICAgIGlmIChlZGl0Qm94Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIG13Lm5vdGlmeSgnRWRpdCBib3ggbm90IGZvdW5kIScsIHsgdHlwZTogJ2Vycm9yJywgYXV0b0hpZGVTZWNvbmRzOiAnc2hvcnQnIH0pO1xuXG4gICAgICAgICAgICBsZXQgdGV4dCA9IGVkaXRCb3gudGV4dFNlbGVjdGlvbignZ2V0Q29udGVudHMnKTtcbiAgICAgICAgICAgIGlmICghdGV4dCkgcmV0dXJuIG13Lm5vdGlmeSgnRWRpdCBib3ggdmFsdWUgbm90IGZvdW5kIScsIHsgdHlwZTogJ2Vycm9yJywgYXV0b0hpZGVTZWNvbmRzOiAnc2hvcnQnIH0pO1xuXG4gICAgICAgICAgICB0ZXh0ID0gZm9ybWF0VGVtcGxhdGVzKHRleHQpO1xuXG4gICAgICAgICAgICBlZGl0Qm94LnRleHRTZWxlY3Rpb24oJ3NldENvbnRlbnRzJywgdGV4dCk7XG5cbiAgICAgICAgICAgIGVkaXRCb3gudGV4dFNlbGVjdGlvbignc2V0U2VsZWN0aW9uJywgeyBzdGFydDogMCB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KSgpO1xuXG4vKipcbiAqIEZvcm1hdHMgdGVtcGxhdGUgc3BhY2luZyBpbiBhbiBhcnRpY2xlJ3MgY29udGVudC5cbiAqIEBwYXJhbSBjb250ZW50IFRoZSBhcnRpY2xlIGNvbnRlbnQgdG8gZm9ybWF0LlxuICovXG5mdW5jdGlvbiBmb3JtYXRUZW1wbGF0ZXMoY29udGVudDogc3RyaW5nKSB7XG4gICAgZW51bSBGb3JtYXRTdHlsZSB7XG4gICAgICAgIEV4cGFuZGVkLFxuICAgICAgICBFeHBhbmRlZEFsaWduZWQsXG4gICAgICAgIE1pbmltaXplZCxcbiAgICAgICAgTWluaW1pemVkU3BhY2VkLFxuICAgIH1cblxuICAgIGNsYXNzIFRlbXBsYXRlIHtcbiAgICAgICAgcHVibGljIGxvY2F0aW9uOiB7IHN0YXJ0OiBudW1iZXI7IGVuZD86IG51bWJlciB9O1xuICAgICAgICBwdWJsaWMgaXNOZXN0ZWQgPSBmYWxzZTtcblxuICAgICAgICBwdWJsaWMgZnVsbFRleHQ/OiBzdHJpbmc7XG4gICAgICAgIHByaXZhdGUgZnVsbFRleHRFc2NhcGVkPzogc3RyaW5nO1xuICAgICAgICBwcml2YXRlIG5hbWU/OiBzdHJpbmc7XG4gICAgICAgIHByaXZhdGUgcGFyYW1ldGVyczogeyBrZXk6IHN0cmluZyB8IG51bGw7IHZhbHVlOiBzdHJpbmcgfVtdID0gW107XG4gICAgICAgIHB1YmxpYyBzdWJUZW1wbGF0ZXM6IFRlbXBsYXRlW10gPSBbXTtcblxuICAgICAgICBwcml2YXRlIHBpcGVFc2NhcGVSZWdleGVzID0gWy8oXFxbXFxbW15cXF1dKj8pXFx8KC4qP11dKS9nLCAvKDwhLS0uKj8pXFx8KC4qPy0tPikvZywgLyg8bm93aWtpPi4qPylcXHwoLio/PFxcL25vd2lraT4pL2ddO1xuXG4gICAgICAgIHByaXZhdGUgZGVmYXVsdFRlbXBsYXRlU3R5bGVzID0ge1xuICAgICAgICAgICAgW0Zvcm1hdFN0eWxlLkV4cGFuZGVkQWxpZ25lZF06IFtcbiAgICAgICAgICAgICAgICAnaW5mb2JveCcsXG4gICAgICAgICAgICAgICAgJ3NwZWNpZXNib3gnLFxuICAgICAgICAgICAgICAgICd0YXhvYm94JyxcbiAgICAgICAgICAgICAgICAnYXV0b21hdGljIHRheG9ib3gnLFxuICAgICAgICAgICAgICAgICdvc20gbG9jYXRpb24gbWFwJyxcbiAgICAgICAgICAgICAgICAnbW90b3JzcG9ydCBzZWFzb24nLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFtGb3JtYXRTdHlsZS5NaW5pbWl6ZWRdOiBbJ2Nvb3JkJywgJ3N0YXJ0IGRhdGUnLCAnZW5kIGRhdGUnXSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdHJ1Y3RvcihzdGFydExvY2F0aW9uOiBudW1iZXIpIHtcbiAgICAgICAgICAgIHRoaXMubG9jYXRpb24gPSB7IHN0YXJ0OiBzdGFydExvY2F0aW9uIH07XG4gICAgICAgIH1cblxuICAgICAgICBwdWJsaWMgcGFyc2UoKSB7XG4gICAgICAgICAgICB0aGlzLmZ1bGxUZXh0ID0gY29udGVudC5zbGljZSh0aGlzLmxvY2F0aW9uLnN0YXJ0LCB0aGlzLmxvY2F0aW9uLmVuZCk7XG4gICAgICAgICAgICB0aGlzLmZ1bGxUZXh0RXNjYXBlZCA9IHRoaXMuZnVsbFRleHQ7XG5cbiAgICAgICAgICAgIGZvciAoY29uc3Qgc3ViVGVtcGxhdGUgb2YgdGhpcy5zdWJUZW1wbGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBzdWJUZW1wbGF0ZS5wYXJzZSgpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5mdWxsVGV4dEVzY2FwZWQgPSB0aGlzLmZ1bGxUZXh0RXNjYXBlZC5yZXBsYWNlKHN1YlRlbXBsYXRlLmZ1bGxUZXh0ISwgJ1xcdTAwMDInKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IHRyaW1tZWRJbm5lclRleHQgPSB0aGlzLmZ1bGxUZXh0RXNjYXBlZC5zbGljZSgyLCAtMikudHJpbSgpO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBpcGVFc2NhcGVSZWdleCBvZiB0aGlzLnBpcGVFc2NhcGVSZWdleGVzKVxuICAgICAgICAgICAgICAgIHdoaWxlIChwaXBlRXNjYXBlUmVnZXgudGVzdCh0cmltbWVkSW5uZXJUZXh0KSlcbiAgICAgICAgICAgICAgICAgICAgdHJpbW1lZElubmVyVGV4dCA9IHRyaW1tZWRJbm5lclRleHQucmVwbGFjZUFsbChwaXBlRXNjYXBlUmVnZXgsICckMVxcdTAwMDEkMicpO1xuXG4gICAgICAgICAgICBjb25zdCBwYXJhbWV0ZXJzID0gdHJpbW1lZElubmVyVGV4dC5zcGxpdCgnfCcpLm1hcCgocGFyYW1ldGVyKSA9PiBwYXJhbWV0ZXIucmVwbGFjZUFsbCgnXFx1MDAwMScsICd8JykudHJpbSgpKTtcblxuICAgICAgICAgICAgdGhpcy5uYW1lID0gcGFyYW1ldGVycy5zaGlmdCgpO1xuXG4gICAgICAgICAgICBjb25zdCBzcGxpdFBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzLm1hcCgocGFyYW1ldGVycykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVxdWFsc0xvY2F0aW9uID0gcGFyYW1ldGVycy5pbmRleE9mKCc9Jyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXF1YWxzTG9jYXRpb24gPT09IC0xKSByZXR1cm4geyBrZXk6IG51bGwsIHZhbHVlOiBwYXJhbWV0ZXJzLnRyaW0oKSB9O1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiBwYXJhbWV0ZXJzLnNsaWNlKDAsIGVxdWFsc0xvY2F0aW9uKS50cmltKCksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwYXJhbWV0ZXJzLnNsaWNlKGVxdWFsc0xvY2F0aW9uICsgMSkudHJpbSgpLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gc3BsaXRQYXJhbWV0ZXJzO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJpdmF0ZSBnZXRTdHlsZSgpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2Zvcm1hdFN0eWxlLCB0ZW1wbGF0ZVByZWZpeGVzXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLmRlZmF1bHRUZW1wbGF0ZVN0eWxlcykpXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0ZW1wbGF0ZVByZWZpeCBvZiB0ZW1wbGF0ZVByZWZpeGVzKVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lIS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgodGVtcGxhdGVQcmVmaXgpKSByZXR1cm4gTnVtYmVyLnBhcnNlSW50KGZvcm1hdFN0eWxlKSBhcyBGb3JtYXRTdHlsZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHB1YmxpYyBmb3JtYXQoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZnVsbFRleHQpIHRoaXMucGFyc2UoKTtcblxuICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSB0aGlzLmdldFN0eWxlKCk7XG4gICAgICAgICAgICBpZiAoc3R5bGUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMuZnVsbFRleHQhO1xuXG4gICAgICAgICAgICBjb25zdCBvdXRwdXQgPSBbYHt7JHt0aGlzLm5hbWV9YF07XG5cbiAgICAgICAgICAgIGlmIChzdHlsZSA9PT0gRm9ybWF0U3R5bGUuRXhwYW5kZWQgfHwgc3R5bGUgPT09IEZvcm1hdFN0eWxlLkV4cGFuZGVkQWxpZ25lZCkge1xuICAgICAgICAgICAgICAgIGxldCByZXF1aXJlZEtleUxlbmd0aCA9IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUgPT09IEZvcm1hdFN0eWxlLkV4cGFuZGVkQWxpZ25lZClcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRLZXlMZW5ndGggPSBNYXRoLm1heCguLi50aGlzLnBhcmFtZXRlcnMubWFwKChwYXJhbWV0ZXIpID0+IHBhcmFtZXRlci5rZXk/Lmxlbmd0aCA/PyAwKSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcmFtZXRlciBvZiB0aGlzLnBhcmFtZXRlcnMpXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKGB8ICR7cGFyYW1ldGVyLmtleSA/IGAke3BhcmFtZXRlci5rZXkucGFkRW5kKHJlcXVpcmVkS2V5TGVuZ3RoKX0gPSBgIDogJyd9JHtwYXJhbWV0ZXIudmFsdWV9YCk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcmFtZXRlciBvZiB0aGlzLnBhcmFtZXRlcnMpXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbWV0ZXIudmFsdWUpIG91dHB1dC5wdXNoKGB8JHtwYXJhbWV0ZXIua2V5ID8gYCR7cGFyYW1ldGVyLmtleX09YCA6ICcnfSR7cGFyYW1ldGVyLnZhbHVlfWApO1xuXG4gICAgICAgICAgICBvdXRwdXQucHVzaCgnfX0nKTtcblxuICAgICAgICAgICAgaWYgKG91dHB1dC5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRbMF0gKz0gJ319JztcblxuICAgICAgICAgICAgICAgIG91dHB1dC5wb3AoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3R5bGUgPT09IEZvcm1hdFN0eWxlLk1pbmltaXplZFNwYWNlZCkge1xuICAgICAgICAgICAgICAgIG91dHB1dFtvdXRwdXQubGVuZ3RoIC0gMl0gKz0gJ319JztcblxuICAgICAgICAgICAgICAgIG91dHB1dC5wb3AoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGpvaW5lZE91dHB1dCA9IG91dHB1dC5qb2luKFxuICAgICAgICAgICAgICAgIHN0eWxlID09PSBGb3JtYXRTdHlsZS5FeHBhbmRlZCB8fCBzdHlsZSA9PT0gRm9ybWF0U3R5bGUuRXhwYW5kZWRBbGlnbmVkXG4gICAgICAgICAgICAgICAgICAgID8gJ1xcbidcbiAgICAgICAgICAgICAgICAgICAgOiBzdHlsZSA9PT0gRm9ybWF0U3R5bGUuTWluaW1pemVkU3BhY2VkXG4gICAgICAgICAgICAgICAgICAgICAgPyAnICdcbiAgICAgICAgICAgICAgICAgICAgICA6ICcnLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBzdWJUZW1wbGF0ZSBvZiB0aGlzLnN1YlRlbXBsYXRlcykgam9pbmVkT3V0cHV0ID0gam9pbmVkT3V0cHV0LnJlcGxhY2UoJ1xcdTAwMDInLCBzdWJUZW1wbGF0ZS5mb3JtYXQoKSk7XG5cbiAgICAgICAgICAgIHJldHVybiBqb2luZWRPdXRwdXQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBhbGxUZW1wbGF0ZXM6IFRlbXBsYXRlW10gPSBbXTtcblxuICAgIGNvbnN0IGluc2lkZVRlbXBsYXRlczogVGVtcGxhdGVbXSA9IFtdO1xuICAgIGxldCBpc0luc2lkZUxpbmsgPSBmYWxzZTtcbiAgICBsZXQgaXNJbnNpZGVOb3dpa2kgPSBmYWxzZTtcbiAgICBsZXQgaXNJbnNpZGVDb21tZW50ID0gZmFsc2U7XG5cbiAgICBsZXQgY3VycmVudExvY2F0aW9uID0gMDtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgY29udGVudCBmb2xsb3dpbmcgdGhlIGN1cnJlbnQgbG9jYXRpb24gbWF0Y2hlcyB0aGUgZGVzaXJlZCBzdHJpbmcuXG4gICAgICogQHBhcmFtIGRlc2lyZWRTdHJpbmcgVGhlIHN0cmluZyB0byBzZWFyY2ggZm9yLlxuICAgICAqIEBwYXJhbSBzaG91bGRJbmNyZW1lbnQgV2hldGhlciB0byBpbmNyZW1lbnQgdGhlIGN1cnJlbnQgbG9jYXRpb24gaWYgdGhlIHN0cmluZyBpcyBmb3VuZC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0F0U3RyaW5nKGRlc2lyZWRTdHJpbmc6IHN0cmluZywgc2hvdWxkSW5jcmVtZW50ID0gdHJ1ZSkge1xuICAgICAgICBjb25zdCBpc0F0U3RyaW5nID0gY29udGVudC5zbGljZShjdXJyZW50TG9jYXRpb24sIGN1cnJlbnRMb2NhdGlvbiArIGRlc2lyZWRTdHJpbmcubGVuZ3RoKSA9PT0gZGVzaXJlZFN0cmluZztcblxuICAgICAgICBpZiAoaXNBdFN0cmluZyAmJiBzaG91bGRJbmNyZW1lbnQpIGN1cnJlbnRMb2NhdGlvbiArPSBkZXNpcmVkU3RyaW5nLmxlbmd0aDtcblxuICAgICAgICByZXR1cm4gaXNBdFN0cmluZztcbiAgICB9XG5cbiAgICB3aGlsZSAoY3VycmVudExvY2F0aW9uIDwgY29udGVudC5sZW5ndGgpXG4gICAgICAgIGlmIChpc0F0U3RyaW5nKCc8bm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJzwvbm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IGZhbHNlO1xuICAgICAgICBlbHNlIGlmIChpc0F0U3RyaW5nKCc8IS0tJykpIGlzSW5zaWRlQ29tbWVudCA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJy0tPicpKSBpc0luc2lkZUNvbW1lbnQgPSBmYWxzZTtcbiAgICAgICAgZWxzZSBpZiAoIWlzSW5zaWRlTm93aWtpICYmICFpc0luc2lkZUNvbW1lbnQpXG4gICAgICAgICAgICBpZiAoaXNBdFN0cmluZygnW1snKSkgaXNJbnNpZGVMaW5rID0gdHJ1ZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzSW5zaWRlTGluayAmJiBpc0F0U3RyaW5nKCddXScpKSBpc0luc2lkZUxpbmsgPSBmYWxzZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJ3t7JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IG5ldyBUZW1wbGF0ZShjdXJyZW50TG9jYXRpb24gLSAyKTtcblxuICAgICAgICAgICAgICAgIGlmIChpbnNpZGVUZW1wbGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZS5pc05lc3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluc2lkZVRlbXBsYXRlcy5hdCgtMSk/LnN1YlRlbXBsYXRlcy5wdXNoKHRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpbnNpZGVUZW1wbGF0ZXMucHVzaCh0ZW1wbGF0ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXRTdHJpbmcoJ319JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0VGVtcGxhdGUgPSBpbnNpZGVUZW1wbGF0ZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFsYXN0VGVtcGxhdGUpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgbGFzdFRlbXBsYXRlLmxvY2F0aW9uLmVuZCA9IGN1cnJlbnRMb2NhdGlvbjtcblxuICAgICAgICAgICAgICAgIGFsbFRlbXBsYXRlcy5wdXNoKGxhc3RUZW1wbGF0ZSk7XG4gICAgICAgICAgICB9IGVsc2UgY3VycmVudExvY2F0aW9uKys7XG4gICAgICAgIGVsc2UgY3VycmVudExvY2F0aW9uKys7XG5cbiAgICBsZXQgbmV3Q29udGVudCA9IGNvbnRlbnQ7XG5cbiAgICBmb3IgKGNvbnN0IHRlbXBsYXRlIG9mIGFsbFRlbXBsYXRlcylcbiAgICAgICAgaWYgKCF0ZW1wbGF0ZS5pc05lc3RlZCkge1xuICAgICAgICAgICAgdGVtcGxhdGUucGFyc2UoKTtcblxuICAgICAgICAgICAgbmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZSh0ZW1wbGF0ZS5mdWxsVGV4dCEsIHRlbXBsYXRlLmZvcm1hdCgpKTtcbiAgICAgICAgfVxuXG4gICAgcmV0dXJuIG5ld0NvbnRlbnQ7XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7bUJBQ1EsR0FBRyxPQUFPLElBQUksbUJBQW1CLEVBQUksR0FDcEMsR0FBRyxPQUFPLElBQUksc0JBQXNCLEdBRXpDLEdBQUcsT0FBTyxNQUFNLENBQUMsaUJBQWtCLHNCQUFzQixFQUFHLElBQU0sQ0FDOUQsR0FBRyxLQUFLLE9BQU87QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9yQixFQUVtQixHQUFHLEtBQUssZUFDakIsR0FBRyxPQUFPLElBQUksTUFBTSxJQUFNLFVBQVksZUFBaUIsYUFDdkQsSUFDQSwwQkFDQSxpQkFDSixFQUVLLGlCQUFpQixRQUFVQSxHQUFVLENBQ3RDQSxFQUFNLGVBQWUsRUFFckIsSUFBTUMsRUFBVSxFQUFFLGFBQWEsRUFDL0IsR0FBSUEsRUFBUSxTQUFXLEVBQUcsT0FBTyxHQUFHLE9BQU8sc0JBQXVCLENBQUUsS0FBTSxRQUFTLGdCQUFpQixPQUFRLENBQUMsRUFFN0csSUFBSUMsRUFBT0QsRUFBUSxjQUFjLGFBQWEsRUFDOUMsR0FBSSxDQUFDQyxFQUFNLE9BQU8sR0FBRyxPQUFPLDRCQUE2QixDQUFFLEtBQU0sUUFBUyxnQkFBaUIsT0FBUSxDQUFDLEVBRXBHQSxFQUFPQyxFQUFnQkQsQ0FBSSxFQUUzQkQsRUFBUSxjQUFjLGNBQWVDLENBQUksRUFFekNELEVBQVEsY0FBYyxlQUFnQixDQUFFLE1BQU8sQ0FBRSxDQUFDLENBQ3RELENBQUMsQ0FDTCxD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QUFXLElBQUksRUFBRyxDQUN6QixJQUFNSSxFQUFlVCxFQUFnQixJQUFJLEVBQ3pDLEdBQUksQ0FBQ1MsRUFBYyxTQUVuQkEsRUFBYSxTQUFTLElBQU1MLEVBRTVCTCxFQUFhLEtBQUtVLENBQVksQ0FDbEMsTUFBT0wsU0FDTkEsSUFFVCxJQUFJTSxFQUFhN0IsRUFFakIsUUFBVzJCLEtBQVlULEVBQ2RTLEVBQVMsV0FDVkEsRUFBUyxNQUFNLEVBRWZFLEVBQWFBLEVBQVcsUUFBUUYsRUFBUyxTQUFXQSxFQUFTLE9BQU8sQ0FBQyxHQUc3RSxPQUFPRSxDQUNYIiwKICAibmFtZXMiOiBbImV2ZW50IiwgImVkaXRCb3giLCAidGV4dCIsICJmb3JtYXRUZW1wbGF0ZXMiLCAiY29udGVudCIsICJGb3JtYXRTdHlsZSIsICJUZW1wbGF0ZSIsICJzdGFydExvY2F0aW9uIiwgInN1YlRlbXBsYXRlIiwgInRyaW1tZWRJbm5lclRleHQiLCAicGlwZUVzY2FwZVJlZ2V4IiwgInBhcmFtZXRlcnMiLCAicGFyYW1ldGVyIiwgInNwbGl0UGFyYW1ldGVycyIsICJlcXVhbHNMb2NhdGlvbiIsICJmb3JtYXRTdHlsZSIsICJ0ZW1wbGF0ZVByZWZpeGVzIiwgInRlbXBsYXRlUHJlZml4IiwgInN0eWxlIiwgIm91dHB1dCIsICJyZXF1aXJlZEtleUxlbmd0aCIsICJqb2luZWRPdXRwdXQiLCAiYWxsVGVtcGxhdGVzIiwgImluc2lkZVRlbXBsYXRlcyIsICJpc0luc2lkZUxpbmsiLCAiaXNJbnNpZGVOb3dpa2kiLCAiaXNJbnNpZGVDb21tZW50IiwgImN1cnJlbnRMb2NhdGlvbiIsICJpc0F0U3RyaW5nIiwgImRlc2lyZWRTdHJpbmciLCAic2hvdWxkSW5jcmVtZW50IiwgInRlbXBsYXRlIiwgImxhc3RUZW1wbGF0ZSIsICJuZXdDb250ZW50Il0KfQo=
