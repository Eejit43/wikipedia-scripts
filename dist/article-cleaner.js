// <pre>
// Note: This script was compiled and minified from TypeScript. For a more readable version, see https://github.com/Eejit43/wikipedia-scripts/blob/main/scripts/article-cleaner.ts

"use strict";(()=>{var L=new mw.Api;async function A(e){return(await L.get({action:"query",formatversion:"2",prop:"revisions",rvprop:"content",rvslots:"main",titles:e})).query.pages[0].revisions?.[0].slots.main.content.trim()}(()=>{if(mw.config.get("wgNamespaceNumber")<0||!mw.config.get("wgIsProbablyEditable"))return;let e=["mediawiki.util","jquery.textSelection"];mw.config.get("skin")!=="minerva"&&e.push("mobile.editor.overlay"),mw.loader.using(e,()=>{let m=!1,d="Cleaned up article content (via [[User:Eejit43/scripts/article-cleaner|article-cleaner]])";function h(n){n.value.includes(d.slice(1))||(n.value&&!n.value.startsWith("/* ")&&!n.value.endsWith(" */ ")?n.value+=`; ${d.charAt(0).toLowerCase()+d.slice(1)}`:n.value=`${n.value}${d}`),m=!1}async function u(n){n.preventDefault();let f=$(mw.config.get("skin")==="minerva"?"#wikitext-editor":"#wpTextbox1");if(f.length===0)return mw.notify("Edit box not found!",{type:"error",autoHideSeconds:"short"});let g=f.textSelection("getContents"),a=g;if(a=R(a),a=N(a),a=I(a),a=M(a),a=P(a),a=F(a,[O,D]),a=_(a),a=y(a),a=H(a),a=await U(a),a=W(a),a=y(a,!0),a=j(a),g===a)mw.notify("No changes to be made to the article!",{type:"warn",autoHideSeconds:"short"});else{if(ve.init){let s=ve.init.target.getSurface().getModel();s.getLinearFragment(s.getRangeFromSourceOffsets(0,g.length)).insertContent(a),s.setSelection(new ve.dm.LinearSelection(new ve.Range(0,0)))}else f.textSelection("setContents",a),f.textSelection("setSelection",{start:0});mw.notify("Article cleanup complete!",{type:"success",autoHideSeconds:"short"});let r=document.querySelector("#wpSummary");r?h(r):m=!0}}mw.config.get("skin")==="minerva"?(mw.hook("mobileFrontend.editorOpened").add(()=>{let n=document.querySelector(".overlay-header .switcher-container"),g=new OO.ui.ButtonWidget({icon:"articleCheck",framed:!1}).$element[0];g.addEventListener("click",u),n.before(g)}),mw.hook("wikipage.content").add(n=>{if(n[0]?.classList.contains("preview")&&m){let f=document.querySelector(".summary-input textarea");h(f)}})):(mw.util.addCSS(`
#article-cleaner {
    display: none;
}

#content:has(#wpTextbox1) #article-cleaner {
    display: unset;
}`),mw.util.addPortletLink(mw.config.get("skin")==="minerva"?"p-navigation":"p-cactions","#","Perform article cleanup","article-cleaner").addEventListener("click",u),mw.hook("ve.saveDialog.stateChanged").add(()=>{if(m){let f=document.querySelector(".ve-ui-mwSaveDialog-summary textarea");h(f)}}))})})();function x(e){return e.replaceAll(/[$()*+.?[\\\]^{|}]/g,"\\$&")}function R(e){let m=/[\u0000-\u0009\u000B\u000C\u000E-\u001F\u007F\u00AD\u200B-\u200F\u202A-\u202E\u2060\u2063\uFEFF]/g;return m.test(e)&&(e=e.replaceAll(m,"")),e}function N(e){let m={"See also":["also see"],References:["reference","source","sources","citation","citations"],"Further reading":["further reading"],"External links":["external link","weblink","weblinks"]},d=["and","birth","career","death","education","life","of","or"],h=Object.fromEntries(Object.entries(m).flatMap(([a,r])=>[[a.toLowerCase(),a],...r.map(s=>[s,a])])),n=[...e.matchAll(/(?<=^|\n)\n*(?<startMarkup>=+) *(?<name>.*?) *(?<endMarkup>=+)(\n+|$)/g)].map(a=>{let{name:r}=a.groups,{startMarkup:s,endMarkup:o}=a.groups;r=r.replaceAll(/'{3}/g,"");let w=r.matchAll(/\[\[(.+?)]]/g).toArray();for(let t of w)r=r.replace(t[0],t[1].split("|").at(-1));let p=Math.max(s.length,o.length,2);return{name:r,depth:p,original:a[0]}}),f=new Set(n.map(a=>a.name)),g=n.length>0&&/^\n*=+ | =+\n+$/.test(n[0].original)?" ":"";for(let a of n){let r=a.name.toLowerCase(),o=r in h&&!f.has(h[r])?h[r]:a.name;for(let p of d)o=o.replaceAll(new RegExp(`\\b${p}\\b`,"gi"),p);o=o.charAt(0).toUpperCase()+o.slice(1);let w=`${"=".repeat(a.depth)}${g}${o}${g}${"=".repeat(a.depth)}`;a.original!==w&&(e=e.replace(a.original,`

${w}
`))}return e}function I(e){return e.replaceAll(/__(INDEX|NOINDEX|NEWSECTIONLINK|NONEWSECTIONLINK|NOEDITSECTION|DISAMBIG|STATICREDIRECT|FORCETOC)__\n*/g,"")}function M(e){let d=[...e.matchAll(/{{(displaytitle|defaultsort)[:|](.*?)}}/gi)].map(u=>{let[n,f,g]=u;return{type:f.toUpperCase(),value:g,original:n}}),h=mw.Title.newFromText(mw.config.get("wgPageName"));for(let u of d){let n=new RegExp(`${x(u.original)}
*`,"g"),f=mw.Title.newFromText(u.value);if(!f)continue;let g=mw.Title.makeTitle(h.getNamespaceId(),f.getMainText());if(!g)continue;let a=u.type==="DISPLAYTITLE"?h.toText():h.getMainText(),r=u.type==="DISPLAYTITLE"?g.toText():g.getMainText();if(a===r){e=e.replace(n,"");continue}let s=`{{${u.type}:${r}}}
`;e=e.replace(n,s)}return e}function P(e){return e.replaceAll(/(\[\[|}}):?category:(.*?)(]]|}})/gi,`[[${mw.config.get("wgCanonicalNamespace")==="Draft"?":":""}Category:$2]]`)}function F(e,m){let d=[],h=[],u=!1,n=!1,f=0;function g(s,o=!0){let w=e.slice(f,f+s.length)===s;return w&&o&&(f+=s.length),w}for(;f<e.length;)if(g("<nowiki>"))u=!0;else if(g("</nowiki>"))u=!1;else if(g("<!--"))n=!0;else if(g("-->"))n=!1;else if(!u&&!n)if(g("[["))h.push({start:f-2,end:-1,isNested:h.length>0});else if(g("]]")){let s=h.pop();if(!s)continue;s.end=f,d.push(s)}else f++;else f++;let a=[],r=Object.values(mw.config.get("wgFormattedNamespaces"));for(let s of d){let o=e.slice(s.start+2,s.end-2),[w,...p]=o.split("|");e=e.slice(0,s.start+2)+"\0".repeat(w.length)+e.slice(s.start+2+w.length);let t=w.replaceAll("_"," ").trim(),i=p.join("|");i=i===" "?" ":i.trim();let c=t.startsWith(":");c&&(t=t.slice(1));let T=!1,l=t.charAt(0).toUpperCase()+t.slice(1),b=t.charAt(0).toLowerCase()+t.slice(1),k=t.split(":")[0];k=k.charAt(0).toUpperCase()+k.slice(1),t.includes(":")&&(l.startsWith("Image:")&&(t=`${t.startsWith("Image:")?"F":"f"}ile:${t.slice(6)}`),c&&(["Image","File","Category"].includes(l.split(":")[0])||!r.includes(k))&&(T=!0));let S="";if(/[!,.:;?]$/.test(i)&&!["Image","File","Category"].includes(l.split(":")[0])){let E=i.slice(-1);t.endsWith(E)||(S=E,i=i.slice(0,-1))}t===i?i="":new RegExp(`^${x(t)}[a-z]+$`).test(i)&&(S=i.slice(t.length)+S,i="");for(let E of[l,b])E===i?(t=E,i=""):new RegExp(`^${x(E)}[a-z]+$`).test(i)&&(t=E,S=i.slice(E.length)+S,i="");(i&&t.includes(":")&&r.includes(k)||t.startsWith("file:")||t.startsWith("category:"))&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t=`${T?":":""}${t}`,t=t.padStart(w.length,"\0");let v=`[[${t}${i?`|${i}`:""}]]${S}`;a.push([s,v])}for(let s of m)e=s(e,1);for(let s=0;s<2;s++)for(let[o,w]of a)s===0&&o.isNested||s===1&&!o.isNested||(e=e.slice(0,o.start)+w.padEnd(o.end-o.start,"\0")+e.slice(o.end));for(let s of m)e=s(e,2);return e.replaceAll("\0","")}function O(e,m){let d="\x7F",h="\x9F";return m===1?(e=e.replaceAll(/[“”„‟]/g,'"'),e=e.replaceAll(/[‘’‚‛]/g,"'"),e=e.replaceAll("\u2026",d),e=e.replaceAll("\xA0",h)):(e=e.replaceAll(d,"..."),e=e.replaceAll(h,"&nbsp;")),e}function D(e,m){return m===1&&(e=e.replaceAll(/(\(\d{3,4}) ?[‒–−-] ?(\d{3,4}\))/g,(d,h,u)=>`${h}\u2013${u}`.padEnd(d.length,"\0"))),e}function _(e){let m=[/'+(Bold|Italic)( text)?'+ */g,/(<big>)+Big( text)?(<\/big>)+ */g,/(<small>)+Small( text)?(<\/small>)+ */g,/(<sup>)+Superscript( text)?(<\/sup>)+ */g,/(<sub>)+Subscript( text)?(<\/sub>)+ */g,/(<s>)+Strikethrough(<\/s>)+ */g,/(<u>)+Underline(<\/u>)+ */g,/(<code>)+Computer code(<\/code>)+ */g,/(<nowiki>)+Insert non-formatted text here(<\/nowiki>)+ */g,/=+ Heading text =+ */g,/\* Bulleted list item */g,/# Numbered list item */g,/<gallery>\nExample.jpg\|Caption1\nExample.jpg\|Caption2\n<\/gallery> */g,/#REDIRECT \[\[Target page name]] */g,/<!-- Invisible comment --> */g,/<\s*(big|small|sup|sub|s|u|code|nowiki|noinclude|onlyinclude|includeonly|center|blockquote|gallery)\s*(\s+[^<>]*)?>\s*<\s*\/\s*\1\s*>/gi];for(let d of m)for(;d.test(e);)e=e.replace(d,"");return e}function y(e,m=!1){return e=e.replaceAll(/(\b|\p{Punctuation}|\]\]|\}\}|\w>) {2,}(\b|\p{Punctuation}|\[\[|\{\{|<\w)/gu,"$1 $2"),m||(e=e.replaceAll(/^ +| +$/gm,"")),e=e.replaceAll(/\n{3,}/g,`

`),e=e.replace(/\s*({{[^}]*stub}})/i,`

$1`),e=e.replaceAll(/\s+$/g,""),e=e.replaceAll(/^([#*]+) */gm,"$1 "),e=e.replaceAll(/^([#*]+ .*)\n+(?=[#*]+ )/gm,`$1
`),m||(e=e.replaceAll(/(?<!\|)\s+(?=<ref(?!erences))/g,"")),e=e.replaceAll(/<\/([A-Za-z]+) +>/g,"</$1>"),e=e.replaceAll(/^(=+.*?=+)$\n{2,}(?=^=+.*?=+$)/gm,`$1
`),e=e.trim(),e}function H(e){e=e.replaceAll(/((?:<ref(?!erences)[^/]*?>.*?<\/ref>|<ref(?!erences).*?\/>)+)([!,.;?])?/g,(r,s,o)=>(o??"")+s);let m=[],d=!1,h=!1,u=0;function n(r){let s=e.slice(u,u+r.length)===r;return s&&(u+=r.length),s}function f(r){for(;u<e.length&&!n(r);)u++}for(;u<e.length;)if(n("<nowiki>"))d=!0;else if(n("</nowiki>"))d=!1;else if(n("<!--"))h=!0;else if(n("-->"))h=!1;else if(!d&&!h)if(!n("<references")&&n("<ref")){let r=u-4;f(">");let s=e.slice(r,u-1).trim().endsWith("/");m.push(s?{start:r,end:u,isSelfClosing:s}:{start:r,end:-1})}else n("</ref>")?m.at(-1).end=u:u++;else u++;let g=new DOMParser,a=[];for(let r of m){let s=e.slice(r.start,r.end),o=/<ref(?!erences).*?>/is.exec(s)[0],p=g.parseFromString(r.isSelfClosing?o.replace(/ *\/ *>/," />"):o+"</ref>","text/html").body.firstChild.outerHTML.replaceAll("&amp;","&"),t=s.slice(o.length,-6).trim().replaceAll(/^\[ *([^ \]]*) *]$/gm,"$1").trim();p=r.isSelfClosing||t.length===0?p.replace(/>\s*<\/ref>/," />"):`${p.slice(0,-6)}${t}</ref>`,s!==p&&a.push([s,p])}for(let[r,s]of a)e=e.replace(r,s);return e}var C;async function U(e){let m;(T=>(T[T.Expanded=0]="Expanded",T[T.ExpandedAligned=1]="ExpandedAligned",T[T.Minimized=2]="Minimized",T[T.MinimizedSpaced=3]="MinimizedSpaced"))(m||={});let d;(c=>(c[c.User=2]="User",c[c.Template=10]="Template",c[c.Draft=118]="Draft"))(d||={}),C??=JSON.parse(await A("User:Eejit43/scripts/article-cleaner.json")??"[]");let h=Object.fromEntries(C.flatMap(p=>p.from.map(t=>[t.charAt(0).toLowerCase()+t.slice(1),p.to])));class u{location;isNested=!1;fullText;fullTextEscaped;rawName;name;parameters=[];subTemplates=[];PLACEHOLDER_STRINGS=["\u{F0000}","\u{10FFFF}","\u{FFFFE}"];PIPE_ESCAPE_REGEXES=[/(\[\[[^\]]*?)\|(.*?]])/g,/(<!--.*?)\|(.*?-->)/g,/(<nowiki>.*?)\|(.*?<\/nowiki>)/g];TAG_EQUALS_ESCAPE_REGEXES=[/<(\w+)( [^<>]+?)(?<!\/)>.*?<\/\1>/g,/<(\w+)( [^<>]+?)\/>/g];templateAliases=h;defaultTemplateStyles={1:["album rating","album reviews","american football uniform","australian rules football kit","automatic taxobox","baseball uniform","basketball kit","beachhandball kit","blockquote","chembox","cricket uniform","election box","episode list","external music video","extra album cover","field hockey kit","football box","football kit","footballbox","handball kit","hybridbox","icehockey kit","ichnobox","infobox","infraspeciesbox","judo bracket","judo repechage","listen","location map","medical resources","motorsport season","multiple image","music ratings","mycomorphbox","navbox","oobox","orbitbox","osm location map","quote box","repechage","rugbybox","sidebar","single ratings","singles","song ratings","speciesbox","starbox","succession box","taxobox","team bracket","track listing","tweet","virusbox","volleyball kit","nteambracket","2nteam-nteambracket","2teambracket","3teambracket","3teamrr","4teambracket","4teamrr","5teambracket","5teamrr","6teambracket","6teamrr","7teambracket","7teamrr","8teambracket","8teamroundrobin","8teamrr","9teambracket","10teambracket","11teambracket","12teambracket","13teambracket","14teambracket","15teambracket","16teambracket","18teambracket","20teambracket","24teambracket","27teambracket","32teambracket","40teambracket","48teambracket","64teambracket","128teambracket"],2:["birth date","coord","death date","end date","lang","start date"],3:["infobox mapframe"]};namespaceSpecificTemplates={118:["afc comment","afc submission","afc submission/draft","afc topic","draft article","draft categories","draft topics","draft","drafts moved from mainspace","preloaddraft submit"],2:["dashboard.wikiedu.org sandbox","user sandbox","userspace draft"]};templatesToKeepContent=["draft categories"];templatesToSubst=["articlepagename","articlespace","basepagename","fullpagename","namespace","namespacenumber","pagename","rootpagename","subjectpagename","subjectspace","subpagename","talkpagename","talkspace","pagenamebase"];constructor(t){this.location={start:t}}parse(){this.fullText=e.slice(this.location.start,this.location.end),this.fullTextEscaped=this.fullText;for(let l of this.subTemplates)l.parse(),this.fullTextEscaped=this.fullTextEscaped.replace(l.fullText,this.PLACEHOLDER_STRINGS[0]);let t=this.fullTextEscaped.slice(2,-2).trim();for(let l of this.PIPE_ESCAPE_REGEXES)for(;l.test(t);)t=t.replaceAll(l,`$1${this.PLACEHOLDER_STRINGS[1]}$2`);for(let l of this.TAG_EQUALS_ESCAPE_REGEXES)t=t.replaceAll(l,(b,k,S)=>b.replace(S,S.replaceAll("=",this.PLACEHOLDER_STRINGS[2])));let i=t.split("|").map(l=>l.replaceAll(this.PLACEHOLDER_STRINGS[1],"|").trim());this.rawName=i.shift(),this.name=this.rawName.replaceAll("_"," "),this.name.toLowerCase().startsWith("template:")&&(this.name=this.name.slice(9));let c=this.name.charAt(0).toLowerCase()+this.name.slice(1);if(c in this.templateAliases){let l=this.name.startsWith(this.name.charAt(0).toLowerCase()),b=this.templateAliases[c];this.name=l?b.charAt(0).toLowerCase()+b.slice(1):b}let T=i.map(l=>{let b=l.indexOf("=");if(b===-1)return{key:null,value:l.replaceAll(this.PLACEHOLDER_STRINGS[2],"=").trim()};let k=l.slice(b+1).replaceAll(this.PLACEHOLDER_STRINGS[2],"=");return{key:l.slice(0,b).trim(),value:`${k.startsWith(`
`)?`
`:""}${k.trim()}`}});this.parameters=T}shouldBeRemoved(){for(let[t,i]of Object.entries(this.namespaceSpecificTemplates))if(mw.config.get("wgNamespaceNumber")!==Number.parseInt(t)&&i.includes(this.name.toLowerCase()))return!0;return!1}getStyle(){let t=0,i;for(let[c,T]of Object.entries(this.defaultTemplateStyles))for(let l of T)this.name.toLowerCase().startsWith(l)&&l.length>=t&&(t=l.length,i=Number.parseInt(c));return i}cleanupParameters(){let t=new Set(["cover","image_flag","image","logo","map_image"]);for(let i=1;i<=10;i++)t.add(`image${i}`);this.parameters=this.parameters.map(({key:i,value:c})=>(i&&t.has(i)&&(c=c.trim(),c.startsWith("[[")&&c.endsWith("]]")&&(c=/\[\[(.*?)]]/g.exec(c)[1].split("|")[0]),c=c.replace(/^(File|Image):/,"").replaceAll("_"," ")),{key:i,value:c}))}format(){if(this.fullText||this.parse(),this.shouldBeRemoved())return this.templatesToKeepContent.includes(this.name.toLowerCase())?this.parameters[0].value:"";let t=mw.config.get("wgNamespaceNumber")!==10&&this.templatesToSubst.some(l=>l===this.name.toLowerCase()||this.name.toLowerCase().startsWith(`${l}:`)),i=this.getStyle();if(i===void 0){let l=this.name;this.name.toLowerCase().startsWith("template:")&&(l=this.name.slice(9)),t&&(l=`subst:${l}`),l!==this.rawName&&(this.fullTextEscaped=this.fullTextEscaped.replace(this.rawName,l));for(let b of this.subTemplates)this.fullTextEscaped=this.fullTextEscaped.replace(this.PLACEHOLDER_STRINGS[0],b.format());return this.fullTextEscaped}let c=[`{{${t?"subst:":""}${this.name}`];if(this.cleanupParameters(),i===0||i===1){let l=0;i===1&&(l=Math.max(...this.parameters.map(b=>b.key?.length??0)));for(let[b,k]of this.parameters.entries())!k.key&&!k.value&&this.parameters.slice(b+1).every(S=>S.key??!S.value)||c.push(`| ${k.key?`${k.key.padEnd(l)} = `:""}${k.value}`)}else for(let[l,b]of this.parameters.entries())!b.value&&(b.key||this.parameters.slice(l+1).every(k=>k.key??!k.value))||c.push(`|${b.key?`${b.key}=`:""}${b.value}`);c.push("}}"),c.length===2?(c[0]+="}}",c.pop()):i===3&&(c[c.length-2]+="}}",c.pop());let T=c.join(i===0||i===1?`
`:i===3?" ":"");for(let l of this.subTemplates)T=T.replace(this.PLACEHOLDER_STRINGS[0],l.format());return T}}let n=[],f=[],g=!1,a=!1,r=!1,s=0;function o(p){let t=e.slice(s,s+p.length)===p;return t&&(s+=p.length),t}for(;s<e.length;)if(o("<nowiki>"))a=!0;else if(o("</nowiki>"))a=!1;else if(o("<!--"))r=!0;else if(o("-->"))r=!1;else if(!a&&!r)if(o("[["))g=!0;else if(g&&o("]]"))g=!1;else if(o("{{")){let p=new u(s-2);f.length>0&&(p.isNested=!0,f.at(-1)?.subTemplates.push(p)),f.push(p)}else if(o("}}")){let p=f.pop();if(!p)continue;p.location.end=s,n.push(p)}else s++;else s++;let w=e;for(let p of n)p.isNested||(p.parse(),w=w.replace(p.fullText,p.format()));return w}function W(e){if(mw.config.get("wgNamespaceNumber")!==0)return e;let m=["Do not remove this line","EDIT BELOW THIS LINE","Important, do not remove anything above this line before article has been created","Important, do not remove this line before article has been created","Inline citations added to your article will automatically display here","Note: The following pages were redirects to "];for(let d of m)e=e.replaceAll(new RegExp(` *<!-- ?${x(d)}.*?--> *
?`,"gs"),"");return e}function j(e){let m=[...e.matchAll(/\[\[Category:/g)].length;return e=e.replaceAll(/\n*{{(uncategorized|improve categories)(\|.+?)?}}\n*/gi,""),m===0&&!/{{uncategorized/i.test(e)?e+=`

{{Uncategorized|{{subst:CURRENTMONTHNAME}} {{subst:CURRENTYEAR}}}}`:m===1&&!/{{improve categories/i.test(e)&&(e+=`

{{Improve categories|{{subst:CURRENTMONTHNAME}} {{subst:CURRENTYEAR}}}}`),e}})();

// </pre>
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vdXRpbGl0eS50cyIsICIuLi9zY3JpcHRzL2FydGljbGUtY2xlYW5lci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHR5cGUgeyBBcGlRdWVyeVJldmlzaW9uc1BhcmFtcyB9IGZyb20gJ3R5cGVzLW1lZGlhd2lraS9hcGlfcGFyYW1zJztcbmltcG9ydCB0eXBlIHsgUGFnZVJldmlzaW9uc1Jlc3VsdCB9IGZyb20gJy4vZ2xvYmFsLXR5cGVzJztcblxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBtdy5BcGkoKTtcblxuLyoqXG4gKiBGZXRjaGVzIHRoZSBjb250ZW50IG9mIGEgZ2l2ZW4gcGFnZS5cbiAqIEBwYXJhbSB0aXRsZSBUaGUgdGl0bGUgdG8gZmV0Y2guXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQYWdlQ29udGVudCh0aXRsZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIChcbiAgICAgICAgKGF3YWl0IGFwaS5nZXQoe1xuICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgZm9ybWF0dmVyc2lvbjogJzInLFxuICAgICAgICAgICAgcHJvcDogJ3JldmlzaW9ucycsXG4gICAgICAgICAgICBydnByb3A6ICdjb250ZW50JyxcbiAgICAgICAgICAgIHJ2c2xvdHM6ICdtYWluJyxcbiAgICAgICAgICAgIHRpdGxlczogdGl0bGUsXG4gICAgICAgIH0gc2F0aXNmaWVzIEFwaVF1ZXJ5UmV2aXNpb25zUGFyYW1zKSkgYXMgUGFnZVJldmlzaW9uc1Jlc3VsdFxuICAgICkucXVlcnkucGFnZXNbMF0ucmV2aXNpb25zPy5bMF0uc2xvdHMubWFpbi5jb250ZW50LnRyaW0oKTtcbn1cbiIsICJpbXBvcnQgeyBnZXRQYWdlQ29udGVudCB9IGZyb20gJy4uL3V0aWxpdHknO1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHRyYW5lb3VzLWNsYXNzXG4gICAgY2xhc3MgVmVSYW5nZSB7XG4gICAgICAgIGNvbnN0cnVjdG9yKHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKTtcbiAgICB9XG5cbiAgICBjbGFzcyBWZUZyYWdtZW50IHtcbiAgICAgICAgaW5zZXJ0Q29udGVudChjb250ZW50OiBzdHJpbmcpOiB2b2lkO1xuICAgIH1cblxuICAgIGNsYXNzIFZlU3VyZmFjZU1vZGVsIHtcbiAgICAgICAgZ2V0TGluZWFyRnJhZ21lbnQocmFuZ2U6IFZlUmFuZ2UpOiBWZUZyYWdtZW50O1xuICAgICAgICBnZXRSYW5nZUZyb21Tb3VyY2VPZmZzZXRzKHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKTogVmVSYW5nZTtcbiAgICAgICAgc2V0U2VsZWN0aW9uKHNlbGVjdGlvbjogVmVMaW5lYXJTZWxlY3Rpb24pOiB2b2lkO1xuICAgIH1cblxuICAgIGNsYXNzIFZlVGFyZ2V0IHtcbiAgICAgICAgZ2V0U3VyZmFjZSgpOiB7IGdldE1vZGVsKCk6IFZlU3VyZmFjZU1vZGVsIH07XG4gICAgfVxuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHRyYW5lb3VzLWNsYXNzXG4gICAgY2xhc3MgVmVMaW5lYXJTZWxlY3Rpb24ge1xuICAgICAgICBjb25zdHJ1Y3RvcihyYW5nZTogVmVSYW5nZSk7XG4gICAgfVxuXG4gICAgY29uc3QgdmU6IHtcbiAgICAgICAgUmFuZ2U6IHR5cGVvZiBWZVJhbmdlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxuICAgICAgICBkbTogeyBMaW5lYXJTZWxlY3Rpb246IHR5cGVvZiBWZUxpbmVhclNlbGVjdGlvbiB9OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxuICAgICAgICBpbml0PzogeyB0YXJnZXQ6IFZlVGFyZ2V0IH07XG4gICAgfTtcbn1cblxuZXhwb3J0IHt9O1xuXG4oKCkgPT4ge1xuICAgIGlmIChtdy5jb25maWcuZ2V0KCd3Z05hbWVzcGFjZU51bWJlcicpIDwgMCkgcmV0dXJuOyAvLyBEb24ndCBydW4gaW4gdmlydHVhbCBuYW1lc3BhY2VzXG4gICAgaWYgKCFtdy5jb25maWcuZ2V0KCd3Z0lzUHJvYmFibHlFZGl0YWJsZScpKSByZXR1cm47IC8vIERvbid0IHJ1biBpZiB1c2VyIGNhbid0IGVkaXQgcGFnZVxuXG4gICAgY29uc3QgZGVwZW5kZW5jaWVzID0gWydtZWRpYXdpa2kudXRpbCcsICdqcXVlcnkudGV4dFNlbGVjdGlvbiddO1xuXG4gICAgaWYgKG13LmNvbmZpZy5nZXQoJ3NraW4nKSAhPT0gJ21pbmVydmEnKSBkZXBlbmRlbmNpZXMucHVzaCgnbW9iaWxlLmVkaXRvci5vdmVybGF5Jyk7XG5cbiAgICBtdy5sb2FkZXIudXNpbmcoZGVwZW5kZW5jaWVzLCAoKSA9PiB7XG4gICAgICAgIGxldCBzaG91bGRBZGRTY3JpcHRNZXNzYWdlID0gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgU0NSSVBUX01FU1NBR0UgPSAnQ2xlYW5lZCB1cCBhcnRpY2xlIGNvbnRlbnQgKHZpYSBbW1VzZXI6RWVqaXQ0My9zY3JpcHRzL2FydGljbGUtY2xlYW5lcnxhcnRpY2xlLWNsZWFuZXJdXSknO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVcGRhdGVzIHRoZSBzdW1tYXJ5IHRleHRhcmVhIHdpdGggdGhlIHNjcmlwdCBtZXNzYWdlIGlmIGl0IGlzIG5vdCBhbHJlYWR5IHByZXNlbnQuXG4gICAgICAgICAqIEBwYXJhbSB0ZXh0YXJlYSBUaGUgc3VtbWFyeSB0ZXh0YXJlYSBlbGVtZW50IHRvIHVwZGF0ZS5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVN1bW1hcnkodGV4dGFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQgfCBIVE1MSW5wdXRFbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAoIXRleHRhcmVhLnZhbHVlLmluY2x1ZGVzKFNDUklQVF9NRVNTQUdFLnNsaWNlKDEpKSlcbiAgICAgICAgICAgICAgICBpZiAodGV4dGFyZWEudmFsdWUgJiYgIXRleHRhcmVhLnZhbHVlLnN0YXJ0c1dpdGgoJy8qICcpICYmICF0ZXh0YXJlYS52YWx1ZS5lbmRzV2l0aCgnICovICcpKVxuICAgICAgICAgICAgICAgICAgICB0ZXh0YXJlYS52YWx1ZSArPSBgOyAke1NDUklQVF9NRVNTQUdFLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgU0NSSVBUX01FU1NBR0Uuc2xpY2UoMSl9YDtcbiAgICAgICAgICAgICAgICBlbHNlIHRleHRhcmVhLnZhbHVlID0gYCR7dGV4dGFyZWEudmFsdWV9JHtTQ1JJUFRfTUVTU0FHRX1gO1xuXG4gICAgICAgICAgICBzaG91bGRBZGRTY3JpcHRNZXNzYWdlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlcyB0aGUgY2xpY2sgZXZlbnQgZm9yIHRoZSBhY3RpdmF0aW9uIGJ1dHRvbi5cbiAgICAgICAgICogQHBhcmFtIGV2ZW50IFRoZSBtb3VzZSBldmVudCB0aGF0IHRyaWdnZXJlZCB0aGUgY2xpY2suXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyBmdW5jdGlvbiBoYW5kbGVBY3RpdmF0aW9uKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBjb25zdCBlZGl0b3IgPSAkKG13LmNvbmZpZy5nZXQoJ3NraW4nKSA9PT0gJ21pbmVydmEnID8gJyN3aWtpdGV4dC1lZGl0b3InIDogJyN3cFRleHRib3gxJyk7XG4gICAgICAgICAgICBpZiAoZWRpdG9yLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG13Lm5vdGlmeSgnRWRpdCBib3ggbm90IGZvdW5kIScsIHsgdHlwZTogJ2Vycm9yJywgYXV0b0hpZGVTZWNvbmRzOiAnc2hvcnQnIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBvcmlnaW5hbFRleHQgPSBlZGl0b3IudGV4dFNlbGVjdGlvbignZ2V0Q29udGVudHMnKTtcblxuICAgICAgICAgICAgbGV0IGZpbmFsVGV4dCA9IG9yaWdpbmFsVGV4dDtcblxuICAgICAgICAgICAgZmluYWxUZXh0ID0gY2xlYW51cFN0cmF5VW5pY29kZUNoYXJhY3RlcnMoZmluYWxUZXh0KTtcbiAgICAgICAgICAgIGZpbmFsVGV4dCA9IGNsZWFudXBTZWN0aW9uSGVhZGVycyhmaW5hbFRleHQpO1xuICAgICAgICAgICAgZmluYWxUZXh0ID0gY2xlYW51cE1hZ2ljV29yZHMoZmluYWxUZXh0KTtcbiAgICAgICAgICAgIGZpbmFsVGV4dCA9IGNsZWFudXBEaXNwbGF5dGl0bGVzQW5kRGVmYXVsdHNvcnRzKGZpbmFsVGV4dCk7XG4gICAgICAgICAgICBmaW5hbFRleHQgPSBjbGVhbnVwQ2F0ZWdvcmllcyhmaW5hbFRleHQpO1xuICAgICAgICAgICAgZmluYWxUZXh0ID0gY2xlYW51cExpbmtzKGZpbmFsVGV4dCwgW2NsZWFudXBJbXByb3BlckNoYXJhY3RlcnMsIGNsZWFudXBZZWFyUmFuZ2VzXSk7XG4gICAgICAgICAgICBmaW5hbFRleHQgPSBjbGVhbnVwU3RyYXlNYXJrdXAoZmluYWxUZXh0KTtcbiAgICAgICAgICAgIGZpbmFsVGV4dCA9IGNsZWFudXBTcGFjaW5nKGZpbmFsVGV4dCk7XG4gICAgICAgICAgICBmaW5hbFRleHQgPSBjbGVhbnVwUmVmZXJlbmNlcyhmaW5hbFRleHQpO1xuICAgICAgICAgICAgZmluYWxUZXh0ID0gYXdhaXQgZm9ybWF0VGVtcGxhdGVzKGZpbmFsVGV4dCk7XG4gICAgICAgICAgICBmaW5hbFRleHQgPSByZW1vdmVDb21tZW50cyhmaW5hbFRleHQpO1xuICAgICAgICAgICAgZmluYWxUZXh0ID0gY2xlYW51cFNwYWNpbmcoZmluYWxUZXh0LCB0cnVlKTtcbiAgICAgICAgICAgIGZpbmFsVGV4dCA9IGF1dG9UYWdQYWdlKGZpbmFsVGV4dCk7XG5cbiAgICAgICAgICAgIGlmIChvcmlnaW5hbFRleHQgPT09IGZpbmFsVGV4dCkgbXcubm90aWZ5KCdObyBjaGFuZ2VzIHRvIGJlIG1hZGUgdG8gdGhlIGFydGljbGUhJywgeyB0eXBlOiAnd2FybicsIGF1dG9IaWRlU2Vjb25kczogJ3Nob3J0JyB9KTtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh2ZS5pbml0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1cmZhY2VNb2RlbCA9IHZlLmluaXQudGFyZ2V0LmdldFN1cmZhY2UoKS5nZXRNb2RlbCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcmFnbWVudCA9IHN1cmZhY2VNb2RlbC5nZXRMaW5lYXJGcmFnbWVudChzdXJmYWNlTW9kZWwuZ2V0UmFuZ2VGcm9tU291cmNlT2Zmc2V0cygwLCBvcmlnaW5hbFRleHQubGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50Lmluc2VydENvbnRlbnQoZmluYWxUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgc3VyZmFjZU1vZGVsLnNldFNlbGVjdGlvbihuZXcgdmUuZG0uTGluZWFyU2VsZWN0aW9uKG5ldyB2ZS5SYW5nZSgwLCAwKSkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci50ZXh0U2VsZWN0aW9uKCdzZXRDb250ZW50cycsIGZpbmFsVGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnRleHRTZWxlY3Rpb24oJ3NldFNlbGVjdGlvbicsIHsgc3RhcnQ6IDAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbXcubm90aWZ5KCdBcnRpY2xlIGNsZWFudXAgY29tcGxldGUhJywgeyB0eXBlOiAnc3VjY2VzcycsIGF1dG9IaWRlU2Vjb25kczogJ3Nob3J0JyB9KTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTElucHV0RWxlbWVudD4oJyN3cFN1bW1hcnknKTtcbiAgICAgICAgICAgICAgICBpZiAoc3VtbWFyeUlucHV0KSB1cGRhdGVTdW1tYXJ5KHN1bW1hcnlJbnB1dCk7XG4gICAgICAgICAgICAgICAgZWxzZSBzaG91bGRBZGRTY3JpcHRNZXNzYWdlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtdy5jb25maWcuZ2V0KCdza2luJykgPT09ICdtaW5lcnZhJykge1xuICAgICAgICAgICAgLy8gU2V0IHVwIGhvb2sgdG8gYWRkIGJ1dHRvbiB0byBlZGl0aW5nIHRvb2xiYXJcbiAgICAgICAgICAgIG13Lmhvb2soJ21vYmlsZUZyb250ZW5kLmVkaXRvck9wZW5lZCcpLmFkZCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyU3dpdGNoZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxEaXZFbGVtZW50PignLm92ZXJsYXktaGVhZGVyIC5zd2l0Y2hlci1jb250YWluZXInKSE7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0b29sID0gbmV3IE9PLnVpLkJ1dHRvbldpZGdldCh7IGljb246ICdhcnRpY2xlQ2hlY2snLCBmcmFtZWQ6IGZhbHNlIH0pO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gdG9vbC4kZWxlbWVudFswXTtcbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVBY3RpdmF0aW9uKTtcblxuICAgICAgICAgICAgICAgIGhlYWRlclN3aXRjaGVyLmJlZm9yZShidXR0b24pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFNldCB1cCBob29rIGZvciB1cGRhdGluZyBlZGl0IHN1bW1hcnlcbiAgICAgICAgICAgIG13Lmhvb2soJ3dpa2lwYWdlLmNvbnRlbnQnKS5hZGQoKGNvbnRlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgaWYgdHJpZ2dlcmVkIGJ5IG1haW4gY29udGVudCBsb2FkIGluc3RlYWQgb2YgcHJldmlld1xuICAgICAgICAgICAgICAgIGlmICghY29udGVudFswXT8uY2xhc3NMaXN0LmNvbnRhaW5zKCdwcmV2aWV3JykpIHJldHVybjsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5uZWNlc3NhcnktY29uZGl0aW9uXG5cbiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkQWRkU2NyaXB0TWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJ5SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KCcuc3VtbWFyeS1pbnB1dCB0ZXh0YXJlYScpITtcblxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVTdW1tYXJ5KHN1bW1hcnlJbnB1dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBTZXQgdXAgbGluayBpbiBzaWRlIG1lbnVcbiAgICAgICAgICAgIG13LnV0aWwuYWRkQ1NTKGBcbiNhcnRpY2xlLWNsZWFuZXIge1xuICAgIGRpc3BsYXk6IG5vbmU7XG59XG5cbiNjb250ZW50Omhhcygjd3BUZXh0Ym94MSkgI2FydGljbGUtY2xlYW5lciB7XG4gICAgZGlzcGxheTogdW5zZXQ7XG59YCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBtdy51dGlsLmFkZFBvcnRsZXRMaW5rKFxuICAgICAgICAgICAgICAgIG13LmNvbmZpZy5nZXQoJ3NraW4nKSA9PT0gJ21pbmVydmEnID8gJ3AtbmF2aWdhdGlvbicgOiAncC1jYWN0aW9ucycsXG4gICAgICAgICAgICAgICAgJyMnLFxuICAgICAgICAgICAgICAgICdQZXJmb3JtIGFydGljbGUgY2xlYW51cCcsXG4gICAgICAgICAgICAgICAgJ2FydGljbGUtY2xlYW5lcicsXG4gICAgICAgICAgICApITtcbiAgICAgICAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVBY3RpdmF0aW9uKTtcblxuICAgICAgICAgICAgLy8gU2V0IHVwIGhvb2sgZm9yIHVwZGF0aW5nIGVkaXQgc3VtbWFyeSBpbiBWaXN1YWxFZGl0b3JcbiAgICAgICAgICAgIG13Lmhvb2soJ3ZlLnNhdmVEaWFsb2cuc3RhdGVDaGFuZ2VkJykuYWRkKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkQWRkU2NyaXB0TWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJ5SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KCcudmUtdWktbXdTYXZlRGlhbG9nLXN1bW1hcnkgdGV4dGFyZWEnKSE7XG5cbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU3VtbWFyeShzdW1tYXJ5SW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuXG4vKipcbiAqIEVzY2FwZXMgcmVnZXggY2hhcmFjdGVycyBpbiBhIHN0cmluZy5cbiAqIEBwYXJhbSBzdHJpbmcgVGhlIHN0cmluZyB0byBlc2NhcGUgcmVnZXggY2hhcmFjdGVycyBpbi5cbiAqL1xuZnVuY3Rpb24gZXNjYXBlUmVnZXhDaGFyYWN0ZXJzKHN0cmluZzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlQWxsKC9bJCgpKisuP1tcXFxcXFxdXnt8fV0vZywgJ1xcXFwkJicpO1xufVxuXG4vKipcbiAqIENsZWFucyB1cCBzdHJheSBVbmljb2RlIGNoYXJhY3RlcnMgaW4gYW4gYXJ0aWNsZSdzIGNvbnRlbnQuXG4gKiBAcGFyYW0gY29udGVudCBUaGUgYXJ0aWNsZSBjb250ZW50IHRvIGNsZWFuIHVwLlxuICovXG5mdW5jdGlvbiBjbGVhbnVwU3RyYXlVbmljb2RlQ2hhcmFjdGVycyhjb250ZW50OiBzdHJpbmcpIHtcbiAgICAvLyBUaGlzIHJlZ2V4IHJlbW92ZXM6XG4gICAgLy8gICAtIEFTQ0lJIGNvbnRyb2wgY2hhcmFjdGVycyAoXFx1MDAwMC1cXHUwMDA5LCBcXHUwMDBCLVxcdTAwMEMsIFxcdTAwMEUtXFx1MDAxRilcbiAgICAvLyAgIC0gREVMIChcXHUwMDdGKVxuICAgIC8vICAgLSBTb2Z0IGh5cGhlbiAoXFx1MDBBRClcbiAgICAvLyAgIC0gWmVyby13aWR0aCBjaGFyYWN0ZXJzIGFuZCBkaXJlY3Rpb25hbGl0eSBtYXJrcyAoXFx1MjAwQi1cXHUyMDBGKVxuICAgIC8vICAgLSBCaWRpIG92ZXJyaWRlIGFuZCBmb3JtYXR0aW5nIGNoYXJhY3RlcnMgKFxcdTIwMkEtXFx1MjAyRSlcbiAgICAvLyAgIC0gV29yZCBqb2luZXIgYW5kIGludmlzaWJsZSBzZXBhcmF0b3IgKFxcdTIwNjAsIFxcdTIwNjMpXG4gICAgLy8gICAtIEJ5dGUgb3JkZXIgbWFyayAoQk9NKSAoXFx1RkVGRilcbiAgICBjb25zdCBzdHJheVVuaWNvZGVSZWdleCA9IC9bXFx1MDAwMC1cXHUwMDA5XFx1MDAwQlxcdTAwMENcXHUwMDBFLVxcdTAwMUZcXHUwMDdGXFx1MDBBRFxcdTIwMEItXFx1MjAwRlxcdTIwMkEtXFx1MjAyRVxcdTIwNjBcXHUyMDYzXFx1RkVGRl0vZzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb250cm9sLXJlZ2V4XG5cbiAgICBpZiAoc3RyYXlVbmljb2RlUmVnZXgudGVzdChjb250ZW50KSkgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbChzdHJheVVuaWNvZGVSZWdleCwgJycpO1xuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8qKlxuICogQ2xlYW5zIHVwIHNlY3Rpb24gaGVhZGVycyBpbiBhbiBhcnRpY2xlJ3MgY29udGVudC5cbiAqIEBwYXJhbSBjb250ZW50IFRoZSBhcnRpY2xlIGNvbnRlbnQgdG8gY2xlYW4gdXAuXG4gKi9cbmZ1bmN0aW9uIGNsZWFudXBTZWN0aW9uSGVhZGVycyhjb250ZW50OiBzdHJpbmcpIHtcbiAgICBjb25zdCBjb21tb25SZXBsYWNlbWVudHMgPSB7XG4gICAgICAgIC8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvbiAqL1xuICAgICAgICAnU2VlIGFsc28nOiBbJ2Fsc28gc2VlJ10sXG4gICAgICAgICdSZWZlcmVuY2VzJzogWydyZWZlcmVuY2UnLCAnc291cmNlJywgJ3NvdXJjZXMnLCAnY2l0YXRpb24nLCAnY2l0YXRpb25zJ10sXG4gICAgICAgICdGdXJ0aGVyIHJlYWRpbmcnOiBbJ2Z1cnRoZXIgcmVhZGluZyddLFxuICAgICAgICAnRXh0ZXJuYWwgbGlua3MnOiBbJ2V4dGVybmFsIGxpbmsnLCAnd2VibGluaycsICd3ZWJsaW5rcyddLFxuICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvbiAqL1xuICAgIH07XG5cbiAgICBjb25zdCBjb21tb25NaXNjYXBpdGFsaXplZFdvcmRzID0gWydhbmQnLCAnYmlydGgnLCAnY2FyZWVyJywgJ2RlYXRoJywgJ2VkdWNhdGlvbicsICdsaWZlJywgJ29mJywgJ29yJ107XG5cbiAgICBjb25zdCByZXZlcnNlQ29tbW9uUmVwbGFjZW1lbnRzID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgICBPYmplY3QuZW50cmllcyhjb21tb25SZXBsYWNlbWVudHMpLmZsYXRNYXAoKFtrZXksIHZhbHVlc10pID0+IFtcbiAgICAgICAgICAgIFtrZXkudG9Mb3dlckNhc2UoKSwga2V5XSxcbiAgICAgICAgICAgIC4uLih2YWx1ZXMubWFwKCh2YWx1ZSkgPT4gW3ZhbHVlLCBrZXldKSBhcyBbc3RyaW5nLCBzdHJpbmddW10pLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bm5lY2Vzc2FyeS10eXBlLWFzc2VydGlvblxuICAgICAgICBdKSxcbiAgICApO1xuXG4gICAgY29uc3QgaGVhZGVycyA9IGNvbnRlbnQubWF0Y2hBbGwoLyg/PD1efFxcbilcXG4qKD88c3RhcnRNYXJrdXA+PSspICooPzxuYW1lPi4qPykgKig/PGVuZE1hcmt1cD49KykoXFxuK3wkKS9nKTtcblxuICAgIGNvbnN0IHBhcnNlZEhlYWRlcnMgPSBbLi4uaGVhZGVyc10ubWFwKChoZWFkZXIpID0+IHtcbiAgICAgICAgbGV0IHsgbmFtZSB9ID0gaGVhZGVyLmdyb3VwcyE7XG4gICAgICAgIGNvbnN0IHsgc3RhcnRNYXJrdXAsIGVuZE1hcmt1cCB9ID0gaGVhZGVyLmdyb3VwcyE7XG5cbiAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZUFsbCgvJ3szfS9nLCAnJyk7XG5cbiAgICAgICAgY29uc3QgbGlua3MgPSBuYW1lLm1hdGNoQWxsKC9cXFtcXFsoLis/KV1dL2cpLnRvQXJyYXkoKTtcblxuICAgICAgICBmb3IgKGNvbnN0IGxpbmsgb2YgbGlua3MpIG5hbWUgPSBuYW1lLnJlcGxhY2UobGlua1swXSwgbGlua1sxXS5zcGxpdCgnfCcpLmF0KC0xKSEpO1xuXG4gICAgICAgIGNvbnN0IGRlcHRoID0gTWF0aC5tYXgoc3RhcnRNYXJrdXAubGVuZ3RoLCBlbmRNYXJrdXAubGVuZ3RoLCAyKTtcblxuICAgICAgICByZXR1cm4geyBuYW1lLCBkZXB0aCwgb3JpZ2luYWw6IGhlYWRlclswXSB9O1xuICAgIH0pO1xuXG4gICAgY29uc3QgaGVhZGVyc1NldCA9IG5ldyBTZXQocGFyc2VkSGVhZGVycy5tYXAoKGhlYWRlcikgPT4gaGVhZGVyLm5hbWUpKTtcblxuICAgIGNvbnN0IHRpdGxlU3BhY2VyID0gcGFyc2VkSGVhZGVycy5sZW5ndGggPiAwID8gKC9eXFxuKj0rIHwgPStcXG4rJC8udGVzdChwYXJzZWRIZWFkZXJzWzBdLm9yaWdpbmFsKSA/ICcgJyA6ICcnKSA6ICcnO1xuXG4gICAgZm9yIChjb25zdCBoZWFkZXIgb2YgcGFyc2VkSGVhZGVycykge1xuICAgICAgICBjb25zdCBsb3dlcmNhc2VOYW1lID0gaGVhZGVyLm5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBjb25zdCByZXBsYWNlZE5hbWUgPVxuICAgICAgICAgICAgbG93ZXJjYXNlTmFtZSBpbiByZXZlcnNlQ29tbW9uUmVwbGFjZW1lbnRzICYmICFoZWFkZXJzU2V0LmhhcyhyZXZlcnNlQ29tbW9uUmVwbGFjZW1lbnRzW2xvd2VyY2FzZU5hbWVdKVxuICAgICAgICAgICAgICAgID8gcmV2ZXJzZUNvbW1vblJlcGxhY2VtZW50c1tsb3dlcmNhc2VOYW1lXVxuICAgICAgICAgICAgICAgIDogaGVhZGVyLm5hbWU7XG5cbiAgICAgICAgbGV0IGNhcGl0YWxpemVkTmFtZSA9IHJlcGxhY2VkTmFtZTtcblxuICAgICAgICBmb3IgKGNvbnN0IHdvcmQgb2YgY29tbW9uTWlzY2FwaXRhbGl6ZWRXb3JkcykgY2FwaXRhbGl6ZWROYW1lID0gY2FwaXRhbGl6ZWROYW1lLnJlcGxhY2VBbGwobmV3IFJlZ0V4cChgXFxcXGIke3dvcmR9XFxcXGJgLCAnZ2knKSwgd29yZCk7XG5cbiAgICAgICAgY2FwaXRhbGl6ZWROYW1lID0gY2FwaXRhbGl6ZWROYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgY2FwaXRhbGl6ZWROYW1lLnNsaWNlKDEpO1xuXG4gICAgICAgIGNvbnN0IG91dHB1dCA9IGAkeyc9Jy5yZXBlYXQoaGVhZGVyLmRlcHRoKX0ke3RpdGxlU3BhY2VyfSR7Y2FwaXRhbGl6ZWROYW1lfSR7dGl0bGVTcGFjZXJ9JHsnPScucmVwZWF0KGhlYWRlci5kZXB0aCl9YDtcblxuICAgICAgICBpZiAoaGVhZGVyLm9yaWdpbmFsICE9PSBvdXRwdXQpIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoaGVhZGVyLm9yaWdpbmFsLCBgXFxuXFxuJHtvdXRwdXR9XFxuYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8qKlxuICogUmVtb3ZlcyB1bm5lY2Vzc2FyeSBtYWdpYyB3b3JkcyBmcm9tIGFuIGFydGljbGUncyBjb250ZW50LlxuICogQHBhcmFtIGNvbnRlbnQgVGhlIGFydGljbGUgY29udGVudCB0byBjbGVhbiB1cC5cbiAqL1xuZnVuY3Rpb24gY2xlYW51cE1hZ2ljV29yZHMoY29udGVudDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGNvbnRlbnQucmVwbGFjZUFsbCgvX18oSU5ERVh8Tk9JTkRFWHxORVdTRUNUSU9OTElOS3xOT05FV1NFQ1RJT05MSU5LfE5PRURJVFNFQ1RJT058RElTQU1CSUd8U1RBVElDUkVESVJFQ1R8Rk9SQ0VUT0MpX19cXG4qL2csICcnKTtcbn1cblxuLyoqXG4gKiBDbGVhbnMgdXAgRElTUExBWVRJVExFcyBhbmQgREVGQVVMVFNPUlRzIGluIGFuIGFydGljbGUncyBjb250ZW50LlxuICogQHBhcmFtIGNvbnRlbnQgVGhlIGFydGljbGUgY29udGVudCB0byBjbGVhbiB1cC5cbiAqL1xuZnVuY3Rpb24gY2xlYW51cERpc3BsYXl0aXRsZXNBbmREZWZhdWx0c29ydHMoY29udGVudDogc3RyaW5nKSB7XG4gICAgY29uc3QgdGFncyA9IGNvbnRlbnQubWF0Y2hBbGwoL3t7KGRpc3BsYXl0aXRsZXxkZWZhdWx0c29ydClbOnxdKC4qPyl9fS9naSk7XG5cbiAgICBjb25zdCBwYXJzZWRUYWdzID0gWy4uLnRhZ3NdLm1hcCgodGFnKSA9PiB7XG4gICAgICAgIGNvbnN0IFtmdWxsVGFnLCB0eXBlLCB2YWx1ZV0gPSB0YWc7XG5cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogdHlwZS50b1VwcGVyQ2FzZSgpLCB2YWx1ZSwgb3JpZ2luYWw6IGZ1bGxUYWcgfTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGN1cnJlbnRUaXRsZSA9IG13LlRpdGxlLm5ld0Zyb21UZXh0KG13LmNvbmZpZy5nZXQoJ3dnUGFnZU5hbWUnKSkhO1xuXG4gICAgZm9yIChjb25zdCB0YWcgb2YgcGFyc2VkVGFncykge1xuICAgICAgICBjb25zdCBvcmlnaW5hbFRhZ1JlZ2V4ID0gbmV3IFJlZ0V4cChgJHtlc2NhcGVSZWdleENoYXJhY3RlcnModGFnLm9yaWdpbmFsKX1cXG4qYCwgJ2cnKTtcblxuICAgICAgICBjb25zdCB1bnByZWZpeGVkVGl0bGUgPSBtdy5UaXRsZS5uZXdGcm9tVGV4dCh0YWcudmFsdWUpO1xuXG4gICAgICAgIGlmICghdW5wcmVmaXhlZFRpdGxlKSBjb250aW51ZTtcblxuICAgICAgICBjb25zdCB0aXRsZSA9IG13LlRpdGxlLm1ha2VUaXRsZShjdXJyZW50VGl0bGUuZ2V0TmFtZXNwYWNlSWQoKSwgdW5wcmVmaXhlZFRpdGxlLmdldE1haW5UZXh0KCkpO1xuXG4gICAgICAgIGlmICghdGl0bGUpIGNvbnRpbnVlO1xuXG4gICAgICAgIGNvbnN0IGRlZmF1bHRLZXkgPSB0YWcudHlwZSA9PT0gJ0RJU1BMQVlUSVRMRScgPyBjdXJyZW50VGl0bGUudG9UZXh0KCkgOiBjdXJyZW50VGl0bGUuZ2V0TWFpblRleHQoKTtcblxuICAgICAgICBjb25zdCBjdXN0b21LZXkgPSB0YWcudHlwZSA9PT0gJ0RJU1BMQVlUSVRMRScgPyB0aXRsZS50b1RleHQoKSA6IHRpdGxlLmdldE1haW5UZXh0KCk7XG5cbiAgICAgICAgaWYgKGRlZmF1bHRLZXkgPT09IGN1c3RvbUtleSkge1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShvcmlnaW5hbFRhZ1JlZ2V4LCAnJyk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5ld1RleHQgPSBge3ske3RhZy50eXBlfToke2N1c3RvbUtleX19fVxcbmA7XG5cbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShvcmlnaW5hbFRhZ1JlZ2V4LCBuZXdUZXh0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gY29udGVudDtcbn1cblxuLyoqXG4gKiBDbGVhbnMgdXAgY2F0ZWdvcmllcyBpbiBhbiBhcnRpY2xlJ3MgY29udGVudC5cbiAqIEBwYXJhbSBjb250ZW50IFRoZSBhcnRpY2xlIGNvbnRlbnQgdG8gY2xlYW4gdXAuXG4gKi9cbmZ1bmN0aW9uIGNsZWFudXBDYXRlZ29yaWVzKGNvbnRlbnQ6IHN0cmluZykge1xuICAgIHJldHVybiBjb250ZW50LnJlcGxhY2VBbGwoXG4gICAgICAgIC8oXFxbXFxbfH19KTo/Y2F0ZWdvcnk6KC4qPykoXV18fX0pL2dpLFxuICAgICAgICBgW1ske213LmNvbmZpZy5nZXQoJ3dnQ2Fub25pY2FsTmFtZXNwYWNlJykgPT09ICdEcmFmdCcgPyAnOicgOiAnJ31DYXRlZ29yeTokMl1dYCxcbiAgICApO1xufVxuXG5pbnRlcmZhY2UgTGlua0luZm9ybWF0aW9uIHtcbiAgICBzdGFydDogbnVtYmVyO1xuICAgIGVuZDogbnVtYmVyO1xuICAgIGlzTmVzdGVkOiBib29sZWFuO1xufVxuXG4vKipcbiAqIENsZWFucyB1cCBsaW5rcyBpbiBhbiBhcnRpY2xlJ3MgY29udGVudC5cbiAqIEBwYXJhbSBjb250ZW50IFRoZSBhcnRpY2xlIGNvbnRlbnQgdG8gY2xlYW4gdXAuXG4gKiBAcGFyYW0gZnVuY3Rpb25zQ2FsbGVkV2hpbGVFc2NhcGVkIFRoZSBmdW5jdGlvbnMgY2FsbGVkIHdoaWxlIHRoZSBsaW5rcyBhcmUgZXNjYXBlZC5cbiAqL1xuZnVuY3Rpb24gY2xlYW51cExpbmtzKGNvbnRlbnQ6IHN0cmluZywgZnVuY3Rpb25zQ2FsbGVkV2hpbGVFc2NhcGVkOiAoKGNvbnRlbnQ6IHN0cmluZywgcnVuOiAxIHwgMikgPT4gc3RyaW5nKVtdKSB7XG4gICAgY29uc3QgY2xvc2VkTGlua3M6IExpbmtJbmZvcm1hdGlvbltdID0gW107XG4gICAgY29uc3QgbGlua3M6IExpbmtJbmZvcm1hdGlvbltdID0gW107XG5cbiAgICBsZXQgaXNJbnNpZGVOb3dpa2kgPSBmYWxzZTtcbiAgICBsZXQgaXNJbnNpZGVDb21tZW50ID0gZmFsc2U7XG5cbiAgICBsZXQgY3VycmVudExvY2F0aW9uID0gMDtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgY29udGVudCBmb2xsb3dpbmcgdGhlIGN1cnJlbnQgbG9jYXRpb24gbWF0Y2hlcyB0aGUgZGVzaXJlZCBzdHJpbmcuXG4gICAgICogQHBhcmFtIGRlc2lyZWRTdHJpbmcgVGhlIHN0cmluZyB0byBzZWFyY2ggZm9yLlxuICAgICAqIEBwYXJhbSBzaG91bGRJbmNyZW1lbnQgV2hldGhlciB0byBpbmNyZW1lbnQgdGhlIGN1cnJlbnQgbG9jYXRpb24gaWYgdGhlIHN0cmluZyBpcyBmb3VuZC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0F0U3RyaW5nKGRlc2lyZWRTdHJpbmc6IHN0cmluZywgc2hvdWxkSW5jcmVtZW50ID0gdHJ1ZSkge1xuICAgICAgICBjb25zdCBpc0F0U3RyaW5nID0gY29udGVudC5zbGljZShjdXJyZW50TG9jYXRpb24sIGN1cnJlbnRMb2NhdGlvbiArIGRlc2lyZWRTdHJpbmcubGVuZ3RoKSA9PT0gZGVzaXJlZFN0cmluZztcblxuICAgICAgICBpZiAoaXNBdFN0cmluZyAmJiBzaG91bGRJbmNyZW1lbnQpIGN1cnJlbnRMb2NhdGlvbiArPSBkZXNpcmVkU3RyaW5nLmxlbmd0aDtcblxuICAgICAgICByZXR1cm4gaXNBdFN0cmluZztcbiAgICB9XG5cbiAgICB3aGlsZSAoY3VycmVudExvY2F0aW9uIDwgY29udGVudC5sZW5ndGgpXG4gICAgICAgIGlmIChpc0F0U3RyaW5nKCc8bm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJzwvbm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IGZhbHNlO1xuICAgICAgICBlbHNlIGlmIChpc0F0U3RyaW5nKCc8IS0tJykpIGlzSW5zaWRlQ29tbWVudCA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJy0tPicpKSBpc0luc2lkZUNvbW1lbnQgPSBmYWxzZTtcbiAgICAgICAgZWxzZSBpZiAoIWlzSW5zaWRlTm93aWtpICYmICFpc0luc2lkZUNvbW1lbnQpXG4gICAgICAgICAgICBpZiAoaXNBdFN0cmluZygnW1snKSkgbGlua3MucHVzaCh7IHN0YXJ0OiBjdXJyZW50TG9jYXRpb24gLSAyLCBlbmQ6IC0xLCBpc05lc3RlZDogbGlua3MubGVuZ3RoID4gMCB9KTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJ11dJykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluayA9IGxpbmtzLnBvcCgpO1xuICAgICAgICAgICAgICAgIGlmICghbGFzdExpbmspIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgbGFzdExpbmsuZW5kID0gY3VycmVudExvY2F0aW9uO1xuXG4gICAgICAgICAgICAgICAgY2xvc2VkTGlua3MucHVzaChsYXN0TGluayk7XG4gICAgICAgICAgICB9IGVsc2UgY3VycmVudExvY2F0aW9uKys7XG4gICAgICAgIGVsc2UgY3VycmVudExvY2F0aW9uKys7XG5cbiAgICBjb25zdCBuZXdMaW5rQ29udGVudDogW0xpbmtJbmZvcm1hdGlvbiwgc3RyaW5nXVtdID0gW107XG5cbiAgICBjb25zdCBuYW1lc3BhY2VOYW1lcyA9IE9iamVjdC52YWx1ZXMobXcuY29uZmlnLmdldCgnd2dGb3JtYXR0ZWROYW1lc3BhY2VzJykpO1xuXG4gICAgZm9yIChjb25zdCBsaW5rTG9jYXRpb24gb2YgY2xvc2VkTGlua3MpIHtcbiAgICAgICAgY29uc3QgaW5uZXJMaW5rID0gY29udGVudC5zbGljZShsaW5rTG9jYXRpb24uc3RhcnQgKyAyLCBsaW5rTG9jYXRpb24uZW5kIC0gMik7XG5cbiAgICAgICAgY29uc3QgW3VucGFyc2VkTGluaywgLi4ucGFyYW1ldGVyc10gPSBpbm5lckxpbmsuc3BsaXQoJ3wnKTtcblxuICAgICAgICAvLyBSZXBsYWNlIGxpbmsgbmFtZXMgc28gdGhlc2Ugd29uJ3QgYmUgYWZmZWN0ZWQgYnkgZnVuY3Rpb25zIGNhbGxlZCB3aGlsZSBlc2NhcGVkXG4gICAgICAgIGNvbnRlbnQgPVxuICAgICAgICAgICAgY29udGVudC5zbGljZSgwLCBsaW5rTG9jYXRpb24uc3RhcnQgKyAyKSArXG4gICAgICAgICAgICAnXFwwJy5yZXBlYXQodW5wYXJzZWRMaW5rLmxlbmd0aCkgK1xuICAgICAgICAgICAgY29udGVudC5zbGljZShsaW5rTG9jYXRpb24uc3RhcnQgKyAyICsgdW5wYXJzZWRMaW5rLmxlbmd0aCk7XG5cbiAgICAgICAgbGV0IGxpbmsgPSB1bnBhcnNlZExpbmsucmVwbGFjZUFsbCgnXycsICcgJykudHJpbSgpO1xuICAgICAgICBsZXQgYWx0VGV4dCA9IHBhcmFtZXRlcnMuam9pbignfCcpO1xuICAgICAgICBhbHRUZXh0ID0gYWx0VGV4dCA9PT0gJyAnID8gJyAnIDogYWx0VGV4dC50cmltKCk7XG5cbiAgICAgICAgY29uc3QgaXNGaXJzdENoYXJhY3RlckNvbG9uID0gbGluay5zdGFydHNXaXRoKCc6Jyk7XG4gICAgICAgIGlmIChpc0ZpcnN0Q2hhcmFjdGVyQ29sb24pIGxpbmsgPSBsaW5rLnNsaWNlKDEpO1xuXG4gICAgICAgIGxldCBzaG91bGRGaXJzdENoYXJhY3RlckJlQ29sb24gPSBmYWxzZTtcblxuICAgICAgICBjb25zdCBsaW5rVXBwZXJjYXNlU3RhcnQgPSBsaW5rLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbGluay5zbGljZSgxKTtcbiAgICAgICAgY29uc3QgbGlua0xvd2VyY2FzZVN0YXJ0ID0gbGluay5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIGxpbmsuc2xpY2UoMSk7XG5cbiAgICAgICAgbGV0IG5hbWVzcGFjZSA9IGxpbmsuc3BsaXQoJzonKVswXTtcbiAgICAgICAgbmFtZXNwYWNlID0gbmFtZXNwYWNlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZXNwYWNlLnNsaWNlKDEpO1xuXG4gICAgICAgIGlmIChsaW5rLmluY2x1ZGVzKCc6JykpIHtcbiAgICAgICAgICAgIGlmIChsaW5rVXBwZXJjYXNlU3RhcnQuc3RhcnRzV2l0aCgnSW1hZ2U6JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRTdGFydFVwcGVyY2FzZSA9IGxpbmsuc3RhcnRzV2l0aCgnSW1hZ2U6Jyk7XG5cbiAgICAgICAgICAgICAgICBsaW5rID0gYCR7c2hvdWxkU3RhcnRVcHBlcmNhc2UgPyAnRicgOiAnZid9aWxlOiR7bGluay5zbGljZSg2KX1gO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgaXNGaXJzdENoYXJhY3RlckNvbG9uICYmXG4gICAgICAgICAgICAgICAgKFsnSW1hZ2UnLCAnRmlsZScsICdDYXRlZ29yeSddLmluY2x1ZGVzKGxpbmtVcHBlcmNhc2VTdGFydC5zcGxpdCgnOicpWzBdKSB8fCAhbmFtZXNwYWNlTmFtZXMuaW5jbHVkZXMobmFtZXNwYWNlKSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICBzaG91bGRGaXJzdENoYXJhY3RlckJlQ29sb24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGFmdGVyTGlua1RleHQgPSAnJztcblxuICAgICAgICBpZiAoL1shLC46Oz9dJC8udGVzdChhbHRUZXh0KSAmJiAhWydJbWFnZScsICdGaWxlJywgJ0NhdGVnb3J5J10uaW5jbHVkZXMobGlua1VwcGVyY2FzZVN0YXJ0LnNwbGl0KCc6JylbMF0pKSB7XG4gICAgICAgICAgICBjb25zdCBhZGRlZFB1bmN0dWF0aW9uID0gYWx0VGV4dC5zbGljZSgtMSk7XG5cbiAgICAgICAgICAgIGlmICghbGluay5lbmRzV2l0aChhZGRlZFB1bmN0dWF0aW9uKSkge1xuICAgICAgICAgICAgICAgIGFmdGVyTGlua1RleHQgPSBhZGRlZFB1bmN0dWF0aW9uO1xuICAgICAgICAgICAgICAgIGFsdFRleHQgPSBhbHRUZXh0LnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsaW5rID09PSBhbHRUZXh0KSBhbHRUZXh0ID0gJyc7XG4gICAgICAgIGVsc2UgaWYgKG5ldyBSZWdFeHAoYF4ke2VzY2FwZVJlZ2V4Q2hhcmFjdGVycyhsaW5rKX1bYS16XSskYCkudGVzdChhbHRUZXh0KSkge1xuICAgICAgICAgICAgYWZ0ZXJMaW5rVGV4dCA9IGFsdFRleHQuc2xpY2UobGluay5sZW5ndGgpICsgYWZ0ZXJMaW5rVGV4dDtcbiAgICAgICAgICAgIGFsdFRleHQgPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgbmV3TGluayBvZiBbbGlua1VwcGVyY2FzZVN0YXJ0LCBsaW5rTG93ZXJjYXNlU3RhcnRdKVxuICAgICAgICAgICAgaWYgKG5ld0xpbmsgPT09IGFsdFRleHQpIHtcbiAgICAgICAgICAgICAgICBsaW5rID0gbmV3TGluaztcbiAgICAgICAgICAgICAgICBhbHRUZXh0ID0gJyc7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5ldyBSZWdFeHAoYF4ke2VzY2FwZVJlZ2V4Q2hhcmFjdGVycyhuZXdMaW5rKX1bYS16XSskYCkudGVzdChhbHRUZXh0KSkge1xuICAgICAgICAgICAgICAgIGxpbmsgPSBuZXdMaW5rO1xuICAgICAgICAgICAgICAgIGFmdGVyTGlua1RleHQgPSBhbHRUZXh0LnNsaWNlKG5ld0xpbmsubGVuZ3RoKSArIGFmdGVyTGlua1RleHQ7XG4gICAgICAgICAgICAgICAgYWx0VGV4dCA9ICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIChhbHRUZXh0ICYmIGxpbmsuaW5jbHVkZXMoJzonKSAmJiBuYW1lc3BhY2VOYW1lcy5pbmNsdWRlcyhuYW1lc3BhY2UpKSB8fFxuICAgICAgICAgICAgbGluay5zdGFydHNXaXRoKCdmaWxlOicpIHx8XG4gICAgICAgICAgICBsaW5rLnN0YXJ0c1dpdGgoJ2NhdGVnb3J5OicpXG4gICAgICAgIClcbiAgICAgICAgICAgIGxpbmsgPSBsaW5rLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbGluay5zbGljZSgxKTtcblxuICAgICAgICBsaW5rID0gYCR7c2hvdWxkRmlyc3RDaGFyYWN0ZXJCZUNvbG9uID8gJzonIDogJyd9JHtsaW5rfWA7XG5cbiAgICAgICAgbGluayA9IGxpbmsucGFkU3RhcnQodW5wYXJzZWRMaW5rLmxlbmd0aCwgJ1xcMCcpO1xuXG4gICAgICAgIGNvbnN0IG91dHB1dCA9IGBbWyR7bGlua30ke2FsdFRleHQgPyBgfCR7YWx0VGV4dH1gIDogJyd9XV0ke2FmdGVyTGlua1RleHR9YDtcblxuICAgICAgICBuZXdMaW5rQ29udGVudC5wdXNoKFtsaW5rTG9jYXRpb24sIG91dHB1dF0pO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgZnVuY3Rpb25Ub0NhbGwgb2YgZnVuY3Rpb25zQ2FsbGVkV2hpbGVFc2NhcGVkKSBjb250ZW50ID0gZnVuY3Rpb25Ub0NhbGwoY29udGVudCwgMSk7XG5cbiAgICBmb3IgKGxldCBsb29wQ291bnRlciA9IDA7IGxvb3BDb3VudGVyIDwgMjsgbG9vcENvdW50ZXIrKylcbiAgICAgICAgZm9yIChjb25zdCBbbGlua0RhdGEsIGxpbmtDb250ZW50XSBvZiBuZXdMaW5rQ29udGVudCkge1xuICAgICAgICAgICAgaWYgKGxvb3BDb3VudGVyID09PSAwICYmIGxpbmtEYXRhLmlzTmVzdGVkKSBjb250aW51ZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGxvb3BDb3VudGVyID09PSAxICYmICFsaW5rRGF0YS5pc05lc3RlZCkgY29udGludWU7XG5cbiAgICAgICAgICAgIGNvbnRlbnQgPVxuICAgICAgICAgICAgICAgIGNvbnRlbnQuc2xpY2UoMCwgbGlua0RhdGEuc3RhcnQpICsgbGlua0NvbnRlbnQucGFkRW5kKGxpbmtEYXRhLmVuZCAtIGxpbmtEYXRhLnN0YXJ0LCAnXFwwJykgKyBjb250ZW50LnNsaWNlKGxpbmtEYXRhLmVuZCk7XG4gICAgICAgIH1cblxuICAgIGZvciAoY29uc3QgZnVuY3Rpb25Ub0NhbGwgb2YgZnVuY3Rpb25zQ2FsbGVkV2hpbGVFc2NhcGVkKSBjb250ZW50ID0gZnVuY3Rpb25Ub0NhbGwoY29udGVudCwgMik7XG5cbiAgICByZXR1cm4gY29udGVudC5yZXBsYWNlQWxsKCdcXDAnLCAnJyk7XG59XG5cbi8qKlxuICogQ2xlYW5zIHVwIGltcHJvcGVyIGNoYXJhY3RlcnMgaW4gYW4gYXJ0aWNsZSdzIGNvbnRlbnQuXG4gKiBAcGFyYW0gY29udGVudCBUaGUgYXJ0aWNsZSBjb250ZW50IHRvIGNsZWFuIHVwLlxuICogQHBhcmFtIHJ1biBUaGUgcnVuIG51bWJlciBvZiB0aGUgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIGNsZWFudXBJbXByb3BlckNoYXJhY3RlcnMoY29udGVudDogc3RyaW5nLCBydW46IDEgfCAyKSB7XG4gICAgY29uc3QgZWxpcHNpc1BsYWNlaG9sZGVyID0gJ1xcdTAwN0YnO1xuICAgIGNvbnN0IG5ic3BQbGFjZWhvbGRlciA9ICdcXHUwMDlGJztcblxuICAgIGlmIChydW4gPT09IDEpIHtcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvW1x1MjAxQ1x1MjAxRFx1MjAxRVx1MjAxRl0vZywgJ1wiJyk7XG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoL1tcdTIwMThcdTIwMTlcdTIwMUFcdTIwMUJdL2csIFwiJ1wiKTtcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgnXHUyMDI2JywgZWxpcHNpc1BsYWNlaG9sZGVyKTtcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgnXHUwMEEwJywgbmJzcFBsYWNlaG9sZGVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKGVsaXBzaXNQbGFjZWhvbGRlciwgJy4uLicpO1xuICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKG5ic3BQbGFjZWhvbGRlciwgJyZuYnNwOycpO1xuICAgIH1cblxuICAgIHJldHVybiBjb250ZW50O1xufVxuXG4vKipcbiAqIENsZWFucyB1cCB5ZWFyIHJhbmdlcyBpbiBhbiBhcnRpY2xlJ3MgY29udGVudC5cbiAqIEBwYXJhbSBjb250ZW50IFRoZSBhcnRpY2xlIGNvbnRlbnQgdG8gY2xlYW4gdXAuXG4gKiBAcGFyYW0gcnVuIFRoZSBydW4gbnVtYmVyIG9mIHRoZSBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gY2xlYW51cFllYXJSYW5nZXMoY29udGVudDogc3RyaW5nLCBydW46IDEgfCAyKSB7XG4gICAgaWYgKHJ1biA9PT0gMSlcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvKFxcKFxcZHszLDR9KSA/W1x1MjAxMlx1MjAxM1x1MjIxMi1dID8oXFxkezMsNH1cXCkpL2csIChvcmlnaW5hbCwgc3RhcnQsIGVuZCkgPT5cbiAgICAgICAgICAgIGAke3N0YXJ0fVx1MjAxMyR7ZW5kfWAucGFkRW5kKG9yaWdpbmFsLmxlbmd0aCwgJ1xcMCcpLFxuICAgICAgICApO1xuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBzdHJheSBtYXJrdXAgaW4gYW4gYXJ0aWNsZSdzIGNvbnRlbnQuXG4gKiBAcGFyYW0gY29udGVudCBUaGUgYXJ0aWNsZSBjb250ZW50IHRvIGNsZWFuIHVwLlxuICovXG5mdW5jdGlvbiBjbGVhbnVwU3RyYXlNYXJrdXAoY29udGVudDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc3RyYXlNYXJrdXBSZWdleGVzID0gW1xuICAgICAgICAvJysoQm9sZHxJdGFsaWMpKCB0ZXh0KT8nKyAqL2csXG4gICAgICAgIC8oPGJpZz4pK0JpZyggdGV4dCk/KDxcXC9iaWc+KSsgKi9nLFxuICAgICAgICAvKDxzbWFsbD4pK1NtYWxsKCB0ZXh0KT8oPFxcL3NtYWxsPikrICovZyxcbiAgICAgICAgLyg8c3VwPikrU3VwZXJzY3JpcHQoIHRleHQpPyg8XFwvc3VwPikrICovZyxcbiAgICAgICAgLyg8c3ViPikrU3Vic2NyaXB0KCB0ZXh0KT8oPFxcL3N1Yj4pKyAqL2csXG4gICAgICAgIC8oPHM+KStTdHJpa2V0aHJvdWdoKDxcXC9zPikrICovZyxcbiAgICAgICAgLyg8dT4pK1VuZGVybGluZSg8XFwvdT4pKyAqL2csXG4gICAgICAgIC8oPGNvZGU+KStDb21wdXRlciBjb2RlKDxcXC9jb2RlPikrICovZyxcbiAgICAgICAgLyg8bm93aWtpPikrSW5zZXJ0IG5vbi1mb3JtYXR0ZWQgdGV4dCBoZXJlKDxcXC9ub3dpa2k+KSsgKi9nLFxuICAgICAgICAvPSsgSGVhZGluZyB0ZXh0ID0rICovZyxcbiAgICAgICAgL1xcKiBCdWxsZXRlZCBsaXN0IGl0ZW0gKi9nLFxuICAgICAgICAvIyBOdW1iZXJlZCBsaXN0IGl0ZW0gKi9nLFxuICAgICAgICAvPGdhbGxlcnk+XFxuRXhhbXBsZS5qcGdcXHxDYXB0aW9uMVxcbkV4YW1wbGUuanBnXFx8Q2FwdGlvbjJcXG48XFwvZ2FsbGVyeT4gKi9nLFxuICAgICAgICAvI1JFRElSRUNUIFxcW1xcW1RhcmdldCBwYWdlIG5hbWVdXSAqL2csXG4gICAgICAgIC88IS0tIEludmlzaWJsZSBjb21tZW50IC0tPiAqL2csXG4gICAgICAgIC88XFxzKihiaWd8c21hbGx8c3VwfHN1YnxzfHV8Y29kZXxub3dpa2l8bm9pbmNsdWRlfG9ubHlpbmNsdWRlfGluY2x1ZGVvbmx5fGNlbnRlcnxibG9ja3F1b3RlfGdhbGxlcnkpXFxzKihcXHMrW148Pl0qKT8+XFxzKjxcXHMqXFwvXFxzKlxcMVxccyo+L2dpLFxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IHJlZ2V4IG9mIHN0cmF5TWFya3VwUmVnZXhlcykgd2hpbGUgKHJlZ2V4LnRlc3QoY29udGVudCkpIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UocmVnZXgsICcnKTtcblxuICAgIHJldHVybiBjb250ZW50O1xufVxuXG4vKipcbiAqIENsZWFucyB1cCBzcGFjaW5nIGluIGFuIGFydGljbGUncyBjb250ZW50LlxuICogQHBhcmFtIGNvbnRlbnQgVGhlIGFydGljbGUgY29udGVudCB0byBjbGVhbiB1cC5cbiAqIEBwYXJhbSBzZWNvbmRSdW4gV2hldGhlciB0aGUgZnVuY3Rpb24gaXMgYmVpbmcgcnVuIGZvciB0aGUgc2Vjb25kIHRpbWUsIGFmdGVyIG90aGVyIHByb2Nlc3NpbmcuXG4gKi9cbmZ1bmN0aW9uIGNsZWFudXBTcGFjaW5nKGNvbnRlbnQ6IHN0cmluZywgc2Vjb25kUnVuID0gZmFsc2UpIHtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKC8oXFxifFxccHtQdW5jdHVhdGlvbn18XFxdXFxdfFxcfVxcfXxcXHc+KSB7Mix9KFxcYnxcXHB7UHVuY3R1YXRpb259fFxcW1xcW3xcXHtcXHt8PFxcdykvZ3UsICckMSAkMicpOyAvLyBSZW1vdmUgZXh0cmEgc3BhY2VzIGJldHdlZW4gd29yZHMgYW5kIHNlbnRlbmNlc1xuICAgIGlmICghc2Vjb25kUnVuKSBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKC9eICt8ICskL2dtLCAnJyk7IC8vIFJlbW92ZSBleHRyYSBzcGFjZXMgYXQgdGhlIHN0YXJ0IG9yIGVuZCBvZiBsaW5lc1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoL1xcbnszLH0vZywgJ1xcblxcbicpOyAvLyBSZW1vdmUgZXh0cmEgbmV3bGluZXNcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHMqKHt7W159XSpzdHVifX0pL2ksICdcXG5cXG4kMScpOyAvLyBFbnN1cmUgdGhlcmUgaXMgb25lIGJsYW5rIGxpbmUgYmVmb3JlIHRoZSBmaXJzdCBzdHViIHRlbXBsYXRlXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXFxzKyQvZywgJycpOyAvLyBSZW1vdmUgdHJhaWxpbmcgc3BhY2VzXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXihbIypdKykgKi9nbSwgJyQxICcpOyAvLyBFbnN1cmUgdGhlcmUgaXMgYSBzcGFjZSBhZnRlciBhIGJ1bGxldCBvciBoYXNoIGluIGEgbGlzdCBpdGVtXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXihbIypdKyAuKilcXG4rKD89WyMqXSsgKS9nbSwgJyQxXFxuJyk7IC8vIFJlbW92ZSBuZXdsaW5lcyBiZXR3ZWVuIGxpc3QgaXRlbXNcbiAgICBpZiAoIXNlY29uZFJ1bikgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvKD88IVxcfClcXHMrKD89PHJlZig/IWVyZW5jZXMpKS9nLCAnJyk7IC8vIFJlbW92ZSBzcGFjZXMgYmVmb3JlIHJlZmVyZW5jZXNcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlQWxsKC88XFwvKFtBLVphLXpdKykgKz4vZywgJzwvJDE+Jyk7IC8vIFJlbW92ZSBleGNlc3Mgc3BhY2UgaW4gY2xvc2luZyB0YWdzXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXig9Ky4qPz0rKSRcXG57Mix9KD89Xj0rLio/PSskKS9nbSwgJyQxXFxuJyk7IC8vIFJlbW92ZSBleHRyYSBuZXdsaW5lcyBiZXR3ZWVuIGVtcHR5IHNlY3Rpb24gYW5kIGZvbGxvd2luZyBzZWN0aW9uXG4gICAgY29udGVudCA9IGNvbnRlbnQudHJpbSgpOyAvLyBSZW1vdmUgd2hpdGVzcGFjZSBhdCB0aGUgc3RhcnQgb3IgZW5kIG9mIHRoZSBjb250ZW50XG5cbiAgICByZXR1cm4gY29udGVudDtcbn1cblxuLyoqXG4gKiBDbGVhbnMgdXAgcmVmZXJlbmNlcyBpbiBhbiBhcnRpY2xlJ3MgY29udGVudC5cbiAqIEBwYXJhbSBjb250ZW50IFRoZSBhcnRpY2xlIGNvbnRlbnQgdG8gY2xlYW4gdXAuXG4gKi9cbmZ1bmN0aW9uIGNsZWFudXBSZWZlcmVuY2VzKGNvbnRlbnQ6IHN0cmluZykge1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwoXG4gICAgICAgIC8oKD86PHJlZig/IWVyZW5jZXMpW14vXSo/Pi4qPzxcXC9yZWY+fDxyZWYoPyFlcmVuY2VzKS4qP1xcLz4pKykoWyEsLjs/XSk/L2csXG4gICAgICAgIChmdWxsTWF0Y2gsIHJlZmVyZW5jZVRhZzogc3RyaW5nLCBwdW5jdHVhdGlvbjogc3RyaW5nIHwgdW5kZWZpbmVkKSA9PiAocHVuY3R1YXRpb24gPz8gJycpICsgcmVmZXJlbmNlVGFnLFxuICAgICk7IC8vIEZpeCBwdW5jdHVhdGlvbiBmb2xsb3dpbmcgcmVmZXJlbmNlc1xuXG4gICAgY29uc3QgcmVmZXJlbmNlczogeyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlcjsgaXNTZWxmQ2xvc2luZz86IHRydWUgfVtdID0gW107XG5cbiAgICBsZXQgaXNJbnNpZGVOb3dpa2kgPSBmYWxzZTtcbiAgICBsZXQgaXNJbnNpZGVDb21tZW50ID0gZmFsc2U7XG5cbiAgICBsZXQgY3VycmVudExvY2F0aW9uID0gMDtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgY29udGVudCBmb2xsb3dpbmcgdGhlIGN1cnJlbnQgbG9jYXRpb24gbWF0Y2hlcyB0aGUgZGVzaXJlZCBzdHJpbmcuXG4gICAgICogQHBhcmFtIGRlc2lyZWRTdHJpbmcgVGhlIHN0cmluZyB0byBzZWFyY2ggZm9yLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzQXRTdHJpbmcoZGVzaXJlZFN0cmluZzogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGlzQXRTdHJpbmcgPSBjb250ZW50LnNsaWNlKGN1cnJlbnRMb2NhdGlvbiwgY3VycmVudExvY2F0aW9uICsgZGVzaXJlZFN0cmluZy5sZW5ndGgpID09PSBkZXNpcmVkU3RyaW5nO1xuXG4gICAgICAgIGlmIChpc0F0U3RyaW5nKSBjdXJyZW50TG9jYXRpb24gKz0gZGVzaXJlZFN0cmluZy5sZW5ndGg7XG5cbiAgICAgICAgcmV0dXJuIGlzQXRTdHJpbmc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2VlZHMgdGhyb3VnaCB0aGUgY29udGVudCB1bnRpbCB0aGUgZGVzaXJlZCBzdHJpbmcgaXMgZm91bmQuXG4gICAgICogQHBhcmFtIGRlc2lyZWRTdHJpbmcgVGhlIHN0cmluZyB0byBzZWFyY2ggZm9yLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHByb2NlZWRVbnRpbFN0cmluZyhkZXNpcmVkU3RyaW5nOiBzdHJpbmcpIHtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnRMb2NhdGlvbiA8IGNvbnRlbnQubGVuZ3RoICYmICFpc0F0U3RyaW5nKGRlc2lyZWRTdHJpbmcpKSBjdXJyZW50TG9jYXRpb24rKztcbiAgICB9XG5cbiAgICB3aGlsZSAoY3VycmVudExvY2F0aW9uIDwgY29udGVudC5sZW5ndGgpXG4gICAgICAgIGlmIChpc0F0U3RyaW5nKCc8bm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJzwvbm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IGZhbHNlO1xuICAgICAgICBlbHNlIGlmIChpc0F0U3RyaW5nKCc8IS0tJykpIGlzSW5zaWRlQ29tbWVudCA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJy0tPicpKSBpc0luc2lkZUNvbW1lbnQgPSBmYWxzZTtcbiAgICAgICAgZWxzZSBpZiAoIWlzSW5zaWRlTm93aWtpICYmICFpc0luc2lkZUNvbW1lbnQpXG4gICAgICAgICAgICBpZiAoIWlzQXRTdHJpbmcoJzxyZWZlcmVuY2VzJykgJiYgaXNBdFN0cmluZygnPHJlZicpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBjdXJyZW50TG9jYXRpb24gLSA0O1xuXG4gICAgICAgICAgICAgICAgcHJvY2VlZFVudGlsU3RyaW5nKCc+Jyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBpc1NlbGZDbG9zaW5nID0gY29udGVudFxuICAgICAgICAgICAgICAgICAgICAuc2xpY2Uoc3RhcnQsIGN1cnJlbnRMb2NhdGlvbiAtIDEpXG4gICAgICAgICAgICAgICAgICAgIC50cmltKClcbiAgICAgICAgICAgICAgICAgICAgLmVuZHNXaXRoKCcvJyk7XG5cbiAgICAgICAgICAgICAgICByZWZlcmVuY2VzLnB1c2goaXNTZWxmQ2xvc2luZyA/IHsgc3RhcnQsIGVuZDogY3VycmVudExvY2F0aW9uLCBpc1NlbGZDbG9zaW5nIH0gOiB7IHN0YXJ0LCBlbmQ6IC0xIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0F0U3RyaW5nKCc8L3JlZj4nKSkgcmVmZXJlbmNlcy5hdCgtMSkhLmVuZCA9IGN1cnJlbnRMb2NhdGlvbjtcbiAgICAgICAgICAgIGVsc2UgY3VycmVudExvY2F0aW9uKys7XG4gICAgICAgIGVsc2UgY3VycmVudExvY2F0aW9uKys7XG5cbiAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG5cbiAgICBjb25zdCByZXBsYWNlbWVudHM6IFtzdHJpbmcsIHN0cmluZ11bXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCByZWZlcmVuY2Ugb2YgcmVmZXJlbmNlcykge1xuICAgICAgICBjb25zdCBvcmlnaW5hbFRleHQgPSBjb250ZW50LnNsaWNlKHJlZmVyZW5jZS5zdGFydCwgcmVmZXJlbmNlLmVuZCk7XG5cbiAgICAgICAgY29uc3Qgc3RhcnRUYWcgPSAvPHJlZig/IWVyZW5jZXMpLio/Pi9pcy5leGVjKG9yaWdpbmFsVGV4dCkhWzBdO1xuXG4gICAgICAgIGNvbnN0IHBhcnNlZFRhZyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoXG4gICAgICAgICAgICByZWZlcmVuY2UuaXNTZWxmQ2xvc2luZyA/IHN0YXJ0VGFnLnJlcGxhY2UoLyAqXFwvICo+LywgJyAvPicpIDogc3RhcnRUYWcgKyAnPC9yZWY+JyxcbiAgICAgICAgICAgICd0ZXh0L2h0bWwnLFxuICAgICAgICApLmJvZHkuZmlyc3RDaGlsZCBhcyBIVE1MVW5rbm93bkVsZW1lbnQ7XG5cbiAgICAgICAgbGV0IG91dHB1dCA9IHBhcnNlZFRhZy5vdXRlckhUTUwucmVwbGFjZUFsbCgnJmFtcDsnLCAnJicpO1xuXG4gICAgICAgIGNvbnN0IHRhZ0NvbnRlbnQgPSBvcmlnaW5hbFRleHRcbiAgICAgICAgICAgIC5zbGljZShzdGFydFRhZy5sZW5ndGgsIC02KVxuICAgICAgICAgICAgLnRyaW0oKVxuICAgICAgICAgICAgLnJlcGxhY2VBbGwoL15cXFsgKihbXiBcXF1dKikgKl0kL2dtLCAnJDEnKVxuICAgICAgICAgICAgLnRyaW0oKTtcblxuICAgICAgICBvdXRwdXQgPVxuICAgICAgICAgICAgcmVmZXJlbmNlLmlzU2VsZkNsb3NpbmcgfHwgdGFnQ29udGVudC5sZW5ndGggPT09IDBcbiAgICAgICAgICAgICAgICA/IG91dHB1dC5yZXBsYWNlKC8+XFxzKjxcXC9yZWY+LywgJyAvPicpXG4gICAgICAgICAgICAgICAgOiBgJHtvdXRwdXQuc2xpY2UoMCwgLTYpfSR7dGFnQ29udGVudH08L3JlZj5gO1xuXG4gICAgICAgIGlmIChvcmlnaW5hbFRleHQgIT09IG91dHB1dCkgcmVwbGFjZW1lbnRzLnB1c2goW29yaWdpbmFsVGV4dCwgb3V0cHV0XSk7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBbb3JpZ2luYWxUZXh0LCBvdXRwdXRdIG9mIHJlcGxhY2VtZW50cykgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShvcmlnaW5hbFRleHQsIG91dHB1dCk7XG5cbiAgICByZXR1cm4gY29udGVudDtcbn1cblxuaW50ZXJmYWNlIFRlbXBsYXRlUmVkaXJlY3Qge1xuICAgIGZyb206IHN0cmluZ1tdO1xuICAgIHRvOiBzdHJpbmc7XG59XG5cbmxldCB0ZW1wbGF0ZUFsaWFzZXM6IFRlbXBsYXRlUmVkaXJlY3RbXSB8IHVuZGVmaW5lZDtcblxuLyoqXG4gKiBGb3JtYXRzIHRlbXBsYXRlIHNwYWNpbmcgaW4gYW4gYXJ0aWNsZSdzIGNvbnRlbnQuXG4gKiBAcGFyYW0gY29udGVudCBUaGUgYXJ0aWNsZSBjb250ZW50IHRvIGZvcm1hdC5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZm9ybWF0VGVtcGxhdGVzKGNvbnRlbnQ6IHN0cmluZykge1xuICAgIGVudW0gRm9ybWF0U3R5bGUge1xuICAgICAgICBFeHBhbmRlZCxcbiAgICAgICAgRXhwYW5kZWRBbGlnbmVkLFxuICAgICAgICBNaW5pbWl6ZWQsXG4gICAgICAgIE1pbmltaXplZFNwYWNlZCxcbiAgICB9XG5cbiAgICBlbnVtIE5hbWVzcGFjZSB7XG4gICAgICAgIFVzZXIgPSAyLFxuICAgICAgICBUZW1wbGF0ZSA9IDEwLFxuICAgICAgICBEcmFmdCA9IDExOCxcbiAgICB9XG5cbiAgICB0ZW1wbGF0ZUFsaWFzZXMgPz89IEpTT04ucGFyc2UoKGF3YWl0IGdldFBhZ2VDb250ZW50KCdVc2VyOkVlaml0NDMvc2NyaXB0cy9hcnRpY2xlLWNsZWFuZXIuanNvbicpKSA/PyAnW10nKSBhcyBUZW1wbGF0ZVJlZGlyZWN0W107XG5cbiAgICBjb25zdCBtYXBwZWRUZW1wbGF0ZUFsaWFzZXMgPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgICAgIHRlbXBsYXRlQWxpYXNlcy5mbGF0TWFwKChhbGlhcykgPT4gYWxpYXMuZnJvbS5tYXAoKGZyb20pID0+IFtmcm9tLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgZnJvbS5zbGljZSgxKSwgYWxpYXMudG9dKSksXG4gICAgKTtcblxuICAgIGNsYXNzIFRlbXBsYXRlIHtcbiAgICAgICAgcHVibGljIGxvY2F0aW9uOiB7IHN0YXJ0OiBudW1iZXI7IGVuZD86IG51bWJlciB9O1xuICAgICAgICBwdWJsaWMgaXNOZXN0ZWQgPSBmYWxzZTtcblxuICAgICAgICBwdWJsaWMgZnVsbFRleHQ/OiBzdHJpbmc7XG4gICAgICAgIHByaXZhdGUgZnVsbFRleHRFc2NhcGVkPzogc3RyaW5nO1xuICAgICAgICBwcml2YXRlIHJhd05hbWU/OiBzdHJpbmc7XG4gICAgICAgIHByaXZhdGUgbmFtZT86IHN0cmluZztcbiAgICAgICAgcHJpdmF0ZSBwYXJhbWV0ZXJzOiB7IGtleTogc3RyaW5nIHwgbnVsbDsgdmFsdWU6IHN0cmluZyB9W10gPSBbXTtcbiAgICAgICAgcHVibGljIHN1YlRlbXBsYXRlczogVGVtcGxhdGVbXSA9IFtdO1xuXG4gICAgICAgIHByaXZhdGUgUExBQ0VIT0xERVJfU1RSSU5HUyA9IFsnXFx1e0YwMDAwfScsICdcXHV7MTBGRkZGfScsICdcXHV7RkZGRkV9J107XG5cbiAgICAgICAgcHJpdmF0ZSBQSVBFX0VTQ0FQRV9SRUdFWEVTID0gWy8oXFxbXFxbW15cXF1dKj8pXFx8KC4qP11dKS9nLCAvKDwhLS0uKj8pXFx8KC4qPy0tPikvZywgLyg8bm93aWtpPi4qPylcXHwoLio/PFxcL25vd2lraT4pL2ddO1xuXG4gICAgICAgIHByaXZhdGUgVEFHX0VRVUFMU19FU0NBUEVfUkVHRVhFUyA9IFsvPChcXHcrKSggW148Pl0rPykoPzwhXFwvKT4uKj88XFwvXFwxPi9nLCAvPChcXHcrKSggW148Pl0rPylcXC8+L2ddO1xuXG4gICAgICAgIHByaXZhdGUgdGVtcGxhdGVBbGlhc2VzID0gbWFwcGVkVGVtcGxhdGVBbGlhc2VzO1xuXG4gICAgICAgIHByaXZhdGUgZGVmYXVsdFRlbXBsYXRlU3R5bGVzID0ge1xuICAgICAgICAgICAgW0Zvcm1hdFN0eWxlLkV4cGFuZGVkQWxpZ25lZF06IFtcbiAgICAgICAgICAgICAgICAnYWxidW0gcmF0aW5nJyxcbiAgICAgICAgICAgICAgICAnYWxidW0gcmV2aWV3cycsXG4gICAgICAgICAgICAgICAgJ2FtZXJpY2FuIGZvb3RiYWxsIHVuaWZvcm0nLFxuICAgICAgICAgICAgICAgICdhdXN0cmFsaWFuIHJ1bGVzIGZvb3RiYWxsIGtpdCcsXG4gICAgICAgICAgICAgICAgJ2F1dG9tYXRpYyB0YXhvYm94JyxcbiAgICAgICAgICAgICAgICAnYmFzZWJhbGwgdW5pZm9ybScsXG4gICAgICAgICAgICAgICAgJ2Jhc2tldGJhbGwga2l0JyxcbiAgICAgICAgICAgICAgICAnYmVhY2hoYW5kYmFsbCBraXQnLFxuICAgICAgICAgICAgICAgICdibG9ja3F1b3RlJyxcbiAgICAgICAgICAgICAgICAnY2hlbWJveCcsXG4gICAgICAgICAgICAgICAgJ2NyaWNrZXQgdW5pZm9ybScsXG4gICAgICAgICAgICAgICAgJ2VsZWN0aW9uIGJveCcsXG4gICAgICAgICAgICAgICAgJ2VwaXNvZGUgbGlzdCcsXG4gICAgICAgICAgICAgICAgJ2V4dGVybmFsIG11c2ljIHZpZGVvJyxcbiAgICAgICAgICAgICAgICAnZXh0cmEgYWxidW0gY292ZXInLFxuICAgICAgICAgICAgICAgICdmaWVsZCBob2NrZXkga2l0JyxcbiAgICAgICAgICAgICAgICAnZm9vdGJhbGwgYm94JyxcbiAgICAgICAgICAgICAgICAnZm9vdGJhbGwga2l0JyxcbiAgICAgICAgICAgICAgICAnZm9vdGJhbGxib3gnLFxuICAgICAgICAgICAgICAgICdoYW5kYmFsbCBraXQnLFxuICAgICAgICAgICAgICAgICdoeWJyaWRib3gnLFxuICAgICAgICAgICAgICAgICdpY2Vob2NrZXkga2l0JyxcbiAgICAgICAgICAgICAgICAnaWNobm9ib3gnLFxuICAgICAgICAgICAgICAgICdpbmZvYm94JyxcbiAgICAgICAgICAgICAgICAnaW5mcmFzcGVjaWVzYm94JyxcbiAgICAgICAgICAgICAgICAnanVkbyBicmFja2V0JyxcbiAgICAgICAgICAgICAgICAnanVkbyByZXBlY2hhZ2UnLFxuICAgICAgICAgICAgICAgICdsaXN0ZW4nLFxuICAgICAgICAgICAgICAgICdsb2NhdGlvbiBtYXAnLFxuICAgICAgICAgICAgICAgICdtZWRpY2FsIHJlc291cmNlcycsXG4gICAgICAgICAgICAgICAgJ21vdG9yc3BvcnQgc2Vhc29uJyxcbiAgICAgICAgICAgICAgICAnbXVsdGlwbGUgaW1hZ2UnLFxuICAgICAgICAgICAgICAgICdtdXNpYyByYXRpbmdzJyxcbiAgICAgICAgICAgICAgICAnbXljb21vcnBoYm94JyxcbiAgICAgICAgICAgICAgICAnbmF2Ym94JyxcbiAgICAgICAgICAgICAgICAnb29ib3gnLFxuICAgICAgICAgICAgICAgICdvcmJpdGJveCcsXG4gICAgICAgICAgICAgICAgJ29zbSBsb2NhdGlvbiBtYXAnLFxuICAgICAgICAgICAgICAgICdxdW90ZSBib3gnLFxuICAgICAgICAgICAgICAgICdyZXBlY2hhZ2UnLFxuICAgICAgICAgICAgICAgICdydWdieWJveCcsXG4gICAgICAgICAgICAgICAgJ3NpZGViYXInLFxuICAgICAgICAgICAgICAgICdzaW5nbGUgcmF0aW5ncycsXG4gICAgICAgICAgICAgICAgJ3NpbmdsZXMnLFxuICAgICAgICAgICAgICAgICdzb25nIHJhdGluZ3MnLFxuICAgICAgICAgICAgICAgICdzcGVjaWVzYm94JyxcbiAgICAgICAgICAgICAgICAnc3RhcmJveCcsXG4gICAgICAgICAgICAgICAgJ3N1Y2Nlc3Npb24gYm94JyxcbiAgICAgICAgICAgICAgICAndGF4b2JveCcsXG4gICAgICAgICAgICAgICAgJ3RlYW0gYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJ3RyYWNrIGxpc3RpbmcnLFxuICAgICAgICAgICAgICAgICd0d2VldCcsXG4gICAgICAgICAgICAgICAgJ3ZpcnVzYm94JyxcbiAgICAgICAgICAgICAgICAndm9sbGV5YmFsbCBraXQnLFxuXG4gICAgICAgICAgICAgICAgLy8gTnVtYmVyZWQgYnJhY2tldHNcbiAgICAgICAgICAgICAgICAnbnRlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnMm50ZWFtLW50ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzJ0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzN0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzN0ZWFtcnInLFxuICAgICAgICAgICAgICAgICc0dGVhbWJyYWNrZXQnLFxuICAgICAgICAgICAgICAgICc0dGVhbXJyJyxcbiAgICAgICAgICAgICAgICAnNXRlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnNXRlYW1ycicsXG4gICAgICAgICAgICAgICAgJzZ0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzZ0ZWFtcnInLFxuICAgICAgICAgICAgICAgICc3dGVhbWJyYWNrZXQnLFxuICAgICAgICAgICAgICAgICc3dGVhbXJyJyxcbiAgICAgICAgICAgICAgICAnOHRlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnOHRlYW1yb3VuZHJvYmluJyxcbiAgICAgICAgICAgICAgICAnOHRlYW1ycicsXG4gICAgICAgICAgICAgICAgJzl0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzEwdGVhbWJyYWNrZXQnLFxuICAgICAgICAgICAgICAgICcxMXRlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnMTJ0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzEzdGVhbWJyYWNrZXQnLFxuICAgICAgICAgICAgICAgICcxNHRlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnMTV0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzE2dGVhbWJyYWNrZXQnLFxuICAgICAgICAgICAgICAgICcxOHRlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnMjB0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzI0dGVhbWJyYWNrZXQnLFxuICAgICAgICAgICAgICAgICcyN3RlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnMzJ0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzQwdGVhbWJyYWNrZXQnLFxuICAgICAgICAgICAgICAgICc0OHRlYW1icmFja2V0JyxcbiAgICAgICAgICAgICAgICAnNjR0ZWFtYnJhY2tldCcsXG4gICAgICAgICAgICAgICAgJzEyOHRlYW1icmFja2V0JyxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBbRm9ybWF0U3R5bGUuTWluaW1pemVkXTogWydiaXJ0aCBkYXRlJywgJ2Nvb3JkJywgJ2RlYXRoIGRhdGUnLCAnZW5kIGRhdGUnLCAnbGFuZycsICdzdGFydCBkYXRlJ10sXG4gICAgICAgICAgICBbRm9ybWF0U3R5bGUuTWluaW1pemVkU3BhY2VkXTogWydpbmZvYm94IG1hcGZyYW1lJ10sXG4gICAgICAgIH07XG5cbiAgICAgICAgcHJpdmF0ZSBuYW1lc3BhY2VTcGVjaWZpY1RlbXBsYXRlcyA9IHtcbiAgICAgICAgICAgIFtOYW1lc3BhY2UuRHJhZnRdOiBbXG4gICAgICAgICAgICAgICAgJ2FmYyBjb21tZW50JyxcbiAgICAgICAgICAgICAgICAnYWZjIHN1Ym1pc3Npb24nLFxuICAgICAgICAgICAgICAgICdhZmMgc3VibWlzc2lvbi9kcmFmdCcsXG4gICAgICAgICAgICAgICAgJ2FmYyB0b3BpYycsXG4gICAgICAgICAgICAgICAgJ2RyYWZ0IGFydGljbGUnLFxuICAgICAgICAgICAgICAgICdkcmFmdCBjYXRlZ29yaWVzJyxcbiAgICAgICAgICAgICAgICAnZHJhZnQgdG9waWNzJyxcbiAgICAgICAgICAgICAgICAnZHJhZnQnLFxuICAgICAgICAgICAgICAgICdkcmFmdHMgbW92ZWQgZnJvbSBtYWluc3BhY2UnLFxuICAgICAgICAgICAgICAgICdwcmVsb2FkZHJhZnQgc3VibWl0JyxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBbTmFtZXNwYWNlLlVzZXJdOiBbJ2Rhc2hib2FyZC53aWtpZWR1Lm9yZyBzYW5kYm94JywgJ3VzZXIgc2FuZGJveCcsICd1c2Vyc3BhY2UgZHJhZnQnXSxcbiAgICAgICAgfTtcblxuICAgICAgICBwcml2YXRlIHRlbXBsYXRlc1RvS2VlcENvbnRlbnQgPSBbJ2RyYWZ0IGNhdGVnb3JpZXMnXTtcblxuICAgICAgICBwcml2YXRlIHRlbXBsYXRlc1RvU3Vic3QgPSBbXG4gICAgICAgICAgICAvLyBNYWdpYyB3b3Jkc1xuICAgICAgICAgICAgJ2FydGljbGVwYWdlbmFtZScsXG4gICAgICAgICAgICAnYXJ0aWNsZXNwYWNlJyxcbiAgICAgICAgICAgICdiYXNlcGFnZW5hbWUnLFxuICAgICAgICAgICAgJ2Z1bGxwYWdlbmFtZScsXG4gICAgICAgICAgICAnbmFtZXNwYWNlJyxcbiAgICAgICAgICAgICduYW1lc3BhY2VudW1iZXInLFxuICAgICAgICAgICAgJ3BhZ2VuYW1lJyxcbiAgICAgICAgICAgICdyb290cGFnZW5hbWUnLFxuICAgICAgICAgICAgJ3N1YmplY3RwYWdlbmFtZScsXG4gICAgICAgICAgICAnc3ViamVjdHNwYWNlJyxcbiAgICAgICAgICAgICdzdWJwYWdlbmFtZScsXG4gICAgICAgICAgICAndGFsa3BhZ2VuYW1lJyxcbiAgICAgICAgICAgICd0YWxrc3BhY2UnLFxuXG4gICAgICAgICAgICAvLyBUZW1wbGF0ZXNcbiAgICAgICAgICAgICdwYWdlbmFtZWJhc2UnLFxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHN0YXJ0TG9jYXRpb246IG51bWJlcikge1xuICAgICAgICAgICAgdGhpcy5sb2NhdGlvbiA9IHsgc3RhcnQ6IHN0YXJ0TG9jYXRpb24gfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHB1YmxpYyBwYXJzZSgpIHtcbiAgICAgICAgICAgIHRoaXMuZnVsbFRleHQgPSBjb250ZW50LnNsaWNlKHRoaXMubG9jYXRpb24uc3RhcnQsIHRoaXMubG9jYXRpb24uZW5kKTtcbiAgICAgICAgICAgIHRoaXMuZnVsbFRleHRFc2NhcGVkID0gdGhpcy5mdWxsVGV4dDtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBzdWJUZW1wbGF0ZSBvZiB0aGlzLnN1YlRlbXBsYXRlcykge1xuICAgICAgICAgICAgICAgIHN1YlRlbXBsYXRlLnBhcnNlKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmZ1bGxUZXh0RXNjYXBlZCA9IHRoaXMuZnVsbFRleHRFc2NhcGVkLnJlcGxhY2Uoc3ViVGVtcGxhdGUuZnVsbFRleHQhLCB0aGlzLlBMQUNFSE9MREVSX1NUUklOR1NbMF0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgdHJpbW1lZElubmVyVGV4dCA9IHRoaXMuZnVsbFRleHRFc2NhcGVkLnNsaWNlKDIsIC0yKS50cmltKCk7XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgcGlwZUVzY2FwZVJlZ2V4IG9mIHRoaXMuUElQRV9FU0NBUEVfUkVHRVhFUylcbiAgICAgICAgICAgICAgICB3aGlsZSAocGlwZUVzY2FwZVJlZ2V4LnRlc3QodHJpbW1lZElubmVyVGV4dCkpXG4gICAgICAgICAgICAgICAgICAgIHRyaW1tZWRJbm5lclRleHQgPSB0cmltbWVkSW5uZXJUZXh0LnJlcGxhY2VBbGwocGlwZUVzY2FwZVJlZ2V4LCBgJDEke3RoaXMuUExBQ0VIT0xERVJfU1RSSU5HU1sxXX0kMmApO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlZ2V4IG9mIHRoaXMuVEFHX0VRVUFMU19FU0NBUEVfUkVHRVhFUylcbiAgICAgICAgICAgICAgICB0cmltbWVkSW5uZXJUZXh0ID0gdHJpbW1lZElubmVyVGV4dC5yZXBsYWNlQWxsKHJlZ2V4LCAoZnVsbFRleHQsIHRhZ05hbWU6IHN0cmluZywgYXR0cmlidXRlczogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdWxsVGV4dC5yZXBsYWNlKGF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMucmVwbGFjZUFsbCgnPScsIHRoaXMuUExBQ0VIT0xERVJfU1RSSU5HU1syXSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBwYXJhbWV0ZXJzID0gdHJpbW1lZElubmVyVGV4dFxuICAgICAgICAgICAgICAgIC5zcGxpdCgnfCcpXG4gICAgICAgICAgICAgICAgLm1hcCgocGFyYW1ldGVyKSA9PiBwYXJhbWV0ZXIucmVwbGFjZUFsbCh0aGlzLlBMQUNFSE9MREVSX1NUUklOR1NbMV0sICd8JykudHJpbSgpKTtcblxuICAgICAgICAgICAgdGhpcy5yYXdOYW1lID0gcGFyYW1ldGVycy5zaGlmdCgpITtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IHRoaXMucmF3TmFtZS5yZXBsYWNlQWxsKCdfJywgJyAnKTtcblxuICAgICAgICAgICAgLy8gU3RyaXAgbmFtZXNwYWNlIHByZWZpeCBmcm9tIG5hbWVcbiAgICAgICAgICAgIGlmICh0aGlzLm5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCd0ZW1wbGF0ZTonKSkgdGhpcy5uYW1lID0gdGhpcy5uYW1lLnNsaWNlKDkpO1xuXG4gICAgICAgICAgICBjb25zdCBuYW1lTG93ZXJjYXNlRmlyc3QgPSB0aGlzLm5hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyB0aGlzLm5hbWUuc2xpY2UoMSk7XG5cbiAgICAgICAgICAgIC8vIFJlc29sdmUgdGVtcGxhdGUgYWxpYXMgaW4gbmFtZVxuICAgICAgICAgICAgaWYgKG5hbWVMb3dlcmNhc2VGaXJzdCBpbiB0aGlzLnRlbXBsYXRlQWxpYXNlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzU3RhcnRMb3dlciA9IHRoaXMubmFtZS5zdGFydHNXaXRoKHRoaXMubmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBmaW5hbE5hbWUgPSB0aGlzLnRlbXBsYXRlQWxpYXNlc1tuYW1lTG93ZXJjYXNlRmlyc3RdO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gaXNTdGFydExvd2VyID8gZmluYWxOYW1lLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgZmluYWxOYW1lLnNsaWNlKDEpIDogZmluYWxOYW1lO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzcGxpdFBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzLm1hcCgocGFyYW1ldGVycykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVxdWFsc0xvY2F0aW9uID0gcGFyYW1ldGVycy5pbmRleE9mKCc9Jyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXF1YWxzTG9jYXRpb24gPT09IC0xKSByZXR1cm4geyBrZXk6IG51bGwsIHZhbHVlOiBwYXJhbWV0ZXJzLnJlcGxhY2VBbGwodGhpcy5QTEFDRUhPTERFUl9TVFJJTkdTWzJdLCAnPScpLnRyaW0oKSB9O1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJhbWV0ZXJzLnNsaWNlKGVxdWFsc0xvY2F0aW9uICsgMSkucmVwbGFjZUFsbCh0aGlzLlBMQUNFSE9MREVSX1NUUklOR1NbMl0sICc9Jyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBrZXk6IHBhcmFtZXRlcnMuc2xpY2UoMCwgZXF1YWxzTG9jYXRpb24pLnRyaW0oKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGAke3ZhbHVlLnN0YXJ0c1dpdGgoJ1xcbicpID8gJ1xcbicgOiAnJ30ke3ZhbHVlLnRyaW0oKX1gLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gc3BsaXRQYXJhbWV0ZXJzO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJpdmF0ZSBzaG91bGRCZVJlbW92ZWQoKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtuYW1lc3BhY2UsIHRlbXBsYXRlc10gb2YgT2JqZWN0LmVudHJpZXModGhpcy5uYW1lc3BhY2VTcGVjaWZpY1RlbXBsYXRlcykpIHtcbiAgICAgICAgICAgICAgICBpZiAobXcuY29uZmlnLmdldCgnd2dOYW1lc3BhY2VOdW1iZXInKSA9PT0gTnVtYmVyLnBhcnNlSW50KG5hbWVzcGFjZSkpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRlbXBsYXRlcy5pbmNsdWRlcyh0aGlzLm5hbWUhLnRvTG93ZXJDYXNlKCkpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJpdmF0ZSBnZXRTdHlsZSgpIHtcbiAgICAgICAgICAgIGxldCBtb3N0U3BlY2lmaWNEZWZhdWx0U3R5bGVQcmVmaXhMZW5ndGggPSAwO1xuICAgICAgICAgICAgbGV0IG1vc3RTcGVjaWZpY0RlZmF1bHRTdHlsZUZvcm1hdFN0eWxlOiBGb3JtYXRTdHlsZSB8IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBbZm9ybWF0U3R5bGUsIHRlbXBsYXRlUHJlZml4ZXNdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuZGVmYXVsdFRlbXBsYXRlU3R5bGVzKSlcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHRlbXBsYXRlUHJlZml4IG9mIHRlbXBsYXRlUHJlZml4ZXMpXG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmFtZSEudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKHRlbXBsYXRlUHJlZml4KSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVQcmVmaXgubGVuZ3RoID49IG1vc3RTcGVjaWZpY0RlZmF1bHRTdHlsZVByZWZpeExlbmd0aFxuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vc3RTcGVjaWZpY0RlZmF1bHRTdHlsZVByZWZpeExlbmd0aCA9IHRlbXBsYXRlUHJlZml4Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vc3RTcGVjaWZpY0RlZmF1bHRTdHlsZUZvcm1hdFN0eWxlID0gTnVtYmVyLnBhcnNlSW50KGZvcm1hdFN0eWxlKSBhcyBGb3JtYXRTdHlsZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbW9zdFNwZWNpZmljRGVmYXVsdFN0eWxlRm9ybWF0U3R5bGU7XG4gICAgICAgIH1cblxuICAgICAgICBwcml2YXRlIGNsZWFudXBQYXJhbWV0ZXJzKCkge1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VQYXJhbWV0ZXJzID0gbmV3IFNldChbJ2NvdmVyJywgJ2ltYWdlX2ZsYWcnLCAnaW1hZ2UnLCAnbG9nbycsICdtYXBfaW1hZ2UnXSk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IG51bWJlciA9IDE7IG51bWJlciA8PSAxMDsgbnVtYmVyKyspIGltYWdlUGFyYW1ldGVycy5hZGQoYGltYWdlJHtudW1iZXJ9YCk7XG5cbiAgICAgICAgICAgIHRoaXMucGFyYW1ldGVycyA9IHRoaXMucGFyYW1ldGVycy5tYXAoKHsga2V5LCB2YWx1ZSB9KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGtleSAmJiBpbWFnZVBhcmFtZXRlcnMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50cmltKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLnN0YXJ0c1dpdGgoJ1tbJykgJiYgdmFsdWUuZW5kc1dpdGgoJ11dJykpIHZhbHVlID0gL1xcW1xcWyguKj8pXV0vZy5leGVjKHZhbHVlKSFbMV0uc3BsaXQoJ3wnKVswXTtcblxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL14oRmlsZXxJbWFnZSk6LywgJycpLnJlcGxhY2VBbGwoJ18nLCAnICcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7IGtleSwgdmFsdWUgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcHVibGljIGZvcm1hdCgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5mdWxsVGV4dCkgdGhpcy5wYXJzZSgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zaG91bGRCZVJlbW92ZWQoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZW1wbGF0ZXNUb0tlZXBDb250ZW50LmluY2x1ZGVzKHRoaXMubmFtZSEudG9Mb3dlckNhc2UoKSkgPyB0aGlzLnBhcmFtZXRlcnNbMF0udmFsdWUgOiAnJztcblxuICAgICAgICAgICAgY29uc3Qgc2hvdWxkU3Vic3QgPVxuICAgICAgICAgICAgICAgIG13LmNvbmZpZy5nZXQoJ3dnTmFtZXNwYWNlTnVtYmVyJykgIT09IChOYW1lc3BhY2UuVGVtcGxhdGUgYXMgbnVtYmVyKSAmJlxuICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVzVG9TdWJzdC5zb21lKChuYW1lKSA9PiBuYW1lID09PSB0aGlzLm5hbWUhLnRvTG93ZXJDYXNlKCkgfHwgdGhpcy5uYW1lIS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoYCR7bmFtZX06YCkpO1xuXG4gICAgICAgICAgICBjb25zdCBzdHlsZSA9IHRoaXMuZ2V0U3R5bGUoKTtcbiAgICAgICAgICAgIGlmIChzdHlsZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5ld05hbWUgPSB0aGlzLm5hbWUhO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUhLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgndGVtcGxhdGU6JykpIG5ld05hbWUgPSB0aGlzLm5hbWUhLnNsaWNlKDkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZFN1YnN0KSBuZXdOYW1lID0gYHN1YnN0OiR7bmV3TmFtZX1gO1xuXG4gICAgICAgICAgICAgICAgaWYgKG5ld05hbWUgIT09IHRoaXMucmF3TmFtZSEpIHRoaXMuZnVsbFRleHRFc2NhcGVkID0gdGhpcy5mdWxsVGV4dEVzY2FwZWQhLnJlcGxhY2UodGhpcy5yYXdOYW1lISwgbmV3TmFtZSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN1YlRlbXBsYXRlIG9mIHRoaXMuc3ViVGVtcGxhdGVzKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bGxUZXh0RXNjYXBlZCA9IHRoaXMuZnVsbFRleHRFc2NhcGVkIS5yZXBsYWNlKHRoaXMuUExBQ0VIT0xERVJfU1RSSU5HU1swXSwgc3ViVGVtcGxhdGUuZm9ybWF0KCkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnVsbFRleHRFc2NhcGVkITtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgb3V0cHV0ID0gW2B7eyR7c2hvdWxkU3Vic3QgPyAnc3Vic3Q6JyA6ICcnfSR7dGhpcy5uYW1lIX1gXTtcblxuICAgICAgICAgICAgdGhpcy5jbGVhbnVwUGFyYW1ldGVycygpO1xuXG4gICAgICAgICAgICBpZiAoc3R5bGUgPT09IEZvcm1hdFN0eWxlLkV4cGFuZGVkIHx8IHN0eWxlID09PSBGb3JtYXRTdHlsZS5FeHBhbmRlZEFsaWduZWQpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVxdWlyZWRLZXlMZW5ndGggPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlID09PSBGb3JtYXRTdHlsZS5FeHBhbmRlZEFsaWduZWQpXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkS2V5TGVuZ3RoID0gTWF0aC5tYXgoLi4udGhpcy5wYXJhbWV0ZXJzLm1hcCgocGFyYW1ldGVyKSA9PiBwYXJhbWV0ZXIua2V5Py5sZW5ndGggPz8gMCkpO1xuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaW5kZXgsIHBhcmFtZXRlcl0gb2YgdGhpcy5wYXJhbWV0ZXJzLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAhcGFyYW1ldGVyLmtleSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIXBhcmFtZXRlci52YWx1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJhbWV0ZXJzLnNsaWNlKGluZGV4ICsgMSkuZXZlcnkoKHBhcmFtZXRlcikgPT4gcGFyYW1ldGVyLmtleSA/PyAhcGFyYW1ldGVyLnZhbHVlKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChgfCAke3BhcmFtZXRlci5rZXkgPyBgJHtwYXJhbWV0ZXIua2V5LnBhZEVuZChyZXF1aXJlZEtleUxlbmd0aCl9ID0gYCA6ICcnfSR7cGFyYW1ldGVyLnZhbHVlfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2luZGV4LCBwYXJhbWV0ZXJdIG9mIHRoaXMucGFyYW1ldGVycy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgIXBhcmFtZXRlci52YWx1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKHBhcmFtZXRlci5rZXkgfHwgdGhpcy5wYXJhbWV0ZXJzLnNsaWNlKGluZGV4ICsgMSkuZXZlcnkoKHBhcmFtZXRlcikgPT4gcGFyYW1ldGVyLmtleSA/PyAhcGFyYW1ldGVyLnZhbHVlKSlcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goYHwke3BhcmFtZXRlci5rZXkgPyBgJHtwYXJhbWV0ZXIua2V5fT1gIDogJyd9JHtwYXJhbWV0ZXIudmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBvdXRwdXQucHVzaCgnfX0nKTtcblxuICAgICAgICAgICAgaWYgKG91dHB1dC5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRbMF0gKz0gJ319JztcblxuICAgICAgICAgICAgICAgIG91dHB1dC5wb3AoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3R5bGUgPT09IEZvcm1hdFN0eWxlLk1pbmltaXplZFNwYWNlZCkge1xuICAgICAgICAgICAgICAgIG91dHB1dFtvdXRwdXQubGVuZ3RoIC0gMl0gKz0gJ319JztcblxuICAgICAgICAgICAgICAgIG91dHB1dC5wb3AoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGpvaW5lZE91dHB1dCA9IG91dHB1dC5qb2luKFxuICAgICAgICAgICAgICAgIHN0eWxlID09PSBGb3JtYXRTdHlsZS5FeHBhbmRlZCB8fCBzdHlsZSA9PT0gRm9ybWF0U3R5bGUuRXhwYW5kZWRBbGlnbmVkXG4gICAgICAgICAgICAgICAgICAgID8gJ1xcbidcbiAgICAgICAgICAgICAgICAgICAgOiBzdHlsZSA9PT0gRm9ybWF0U3R5bGUuTWluaW1pemVkU3BhY2VkXG4gICAgICAgICAgICAgICAgICAgICAgPyAnICdcbiAgICAgICAgICAgICAgICAgICAgICA6ICcnLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBzdWJUZW1wbGF0ZSBvZiB0aGlzLnN1YlRlbXBsYXRlcylcbiAgICAgICAgICAgICAgICBqb2luZWRPdXRwdXQgPSBqb2luZWRPdXRwdXQucmVwbGFjZSh0aGlzLlBMQUNFSE9MREVSX1NUUklOR1NbMF0sIHN1YlRlbXBsYXRlLmZvcm1hdCgpKTtcblxuICAgICAgICAgICAgcmV0dXJuIGpvaW5lZE91dHB1dDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGFsbFRlbXBsYXRlczogVGVtcGxhdGVbXSA9IFtdO1xuXG4gICAgY29uc3QgaW5zaWRlVGVtcGxhdGVzOiBUZW1wbGF0ZVtdID0gW107XG4gICAgbGV0IGlzSW5zaWRlTGluayA9IGZhbHNlO1xuICAgIGxldCBpc0luc2lkZU5vd2lraSA9IGZhbHNlO1xuICAgIGxldCBpc0luc2lkZUNvbW1lbnQgPSBmYWxzZTtcblxuICAgIGxldCBjdXJyZW50TG9jYXRpb24gPSAwO1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIHRoZSBjb250ZW50IGZvbGxvd2luZyB0aGUgY3VycmVudCBsb2NhdGlvbiBtYXRjaGVzIHRoZSBkZXNpcmVkIHN0cmluZy5cbiAgICAgKiBAcGFyYW0gZGVzaXJlZFN0cmluZyBUaGUgc3RyaW5nIHRvIHNlYXJjaCBmb3IuXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNBdFN0cmluZyhkZXNpcmVkU3RyaW5nOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgaXNBdFN0cmluZyA9IGNvbnRlbnQuc2xpY2UoY3VycmVudExvY2F0aW9uLCBjdXJyZW50TG9jYXRpb24gKyBkZXNpcmVkU3RyaW5nLmxlbmd0aCkgPT09IGRlc2lyZWRTdHJpbmc7XG5cbiAgICAgICAgaWYgKGlzQXRTdHJpbmcpIGN1cnJlbnRMb2NhdGlvbiArPSBkZXNpcmVkU3RyaW5nLmxlbmd0aDtcblxuICAgICAgICByZXR1cm4gaXNBdFN0cmluZztcbiAgICB9XG5cbiAgICB3aGlsZSAoY3VycmVudExvY2F0aW9uIDwgY29udGVudC5sZW5ndGgpXG4gICAgICAgIGlmIChpc0F0U3RyaW5nKCc8bm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJzwvbm93aWtpPicpKSBpc0luc2lkZU5vd2lraSA9IGZhbHNlO1xuICAgICAgICBlbHNlIGlmIChpc0F0U3RyaW5nKCc8IS0tJykpIGlzSW5zaWRlQ29tbWVudCA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJy0tPicpKSBpc0luc2lkZUNvbW1lbnQgPSBmYWxzZTtcbiAgICAgICAgZWxzZSBpZiAoIWlzSW5zaWRlTm93aWtpICYmICFpc0luc2lkZUNvbW1lbnQpXG4gICAgICAgICAgICBpZiAoaXNBdFN0cmluZygnW1snKSkgaXNJbnNpZGVMaW5rID0gdHJ1ZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzSW5zaWRlTGluayAmJiBpc0F0U3RyaW5nKCddXScpKSBpc0luc2lkZUxpbmsgPSBmYWxzZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzQXRTdHJpbmcoJ3t7JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IG5ldyBUZW1wbGF0ZShjdXJyZW50TG9jYXRpb24gLSAyKTtcblxuICAgICAgICAgICAgICAgIGlmIChpbnNpZGVUZW1wbGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZS5pc05lc3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluc2lkZVRlbXBsYXRlcy5hdCgtMSk/LnN1YlRlbXBsYXRlcy5wdXNoKHRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpbnNpZGVUZW1wbGF0ZXMucHVzaCh0ZW1wbGF0ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXRTdHJpbmcoJ319JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0VGVtcGxhdGUgPSBpbnNpZGVUZW1wbGF0ZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFsYXN0VGVtcGxhdGUpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgbGFzdFRlbXBsYXRlLmxvY2F0aW9uLmVuZCA9IGN1cnJlbnRMb2NhdGlvbjtcblxuICAgICAgICAgICAgICAgIGFsbFRlbXBsYXRlcy5wdXNoKGxhc3RUZW1wbGF0ZSk7XG4gICAgICAgICAgICB9IGVsc2UgY3VycmVudExvY2F0aW9uKys7XG4gICAgICAgIGVsc2UgY3VycmVudExvY2F0aW9uKys7XG5cbiAgICBsZXQgbmV3Q29udGVudCA9IGNvbnRlbnQ7XG5cbiAgICBmb3IgKGNvbnN0IHRlbXBsYXRlIG9mIGFsbFRlbXBsYXRlcylcbiAgICAgICAgaWYgKCF0ZW1wbGF0ZS5pc05lc3RlZCkge1xuICAgICAgICAgICAgdGVtcGxhdGUucGFyc2UoKTtcblxuICAgICAgICAgICAgbmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZSh0ZW1wbGF0ZS5mdWxsVGV4dCEsIHRlbXBsYXRlLmZvcm1hdCgpKTtcbiAgICAgICAgfVxuXG4gICAgcmV0dXJuIG5ld0NvbnRlbnQ7XG59XG5cbi8qKlxuICogUmVtb3ZlcyB1bm5lY2Vzc2FyeSBjb21tZW50cyBmcm9tIGFuIGFydGljbGUncyBjb250ZW50LlxuICogQHBhcmFtIGNvbnRlbnQgVGhlIGFydGljbGUgY29udGVudCB0byBjbGVhbiB1cC5cbiAqL1xuZnVuY3Rpb24gcmVtb3ZlQ29tbWVudHMoY29udGVudDogc3RyaW5nKSB7XG4gICAgaWYgKG13LmNvbmZpZy5nZXQoJ3dnTmFtZXNwYWNlTnVtYmVyJykgIT09IDApIHJldHVybiBjb250ZW50O1xuXG4gICAgY29uc3QgY29tbWVudHMgPSBbXG4gICAgICAgICdEbyBub3QgcmVtb3ZlIHRoaXMgbGluZScsXG4gICAgICAgICdFRElUIEJFTE9XIFRISVMgTElORScsXG4gICAgICAgICdJbXBvcnRhbnQsIGRvIG5vdCByZW1vdmUgYW55dGhpbmcgYWJvdmUgdGhpcyBsaW5lIGJlZm9yZSBhcnRpY2xlIGhhcyBiZWVuIGNyZWF0ZWQnLFxuICAgICAgICAnSW1wb3J0YW50LCBkbyBub3QgcmVtb3ZlIHRoaXMgbGluZSBiZWZvcmUgYXJ0aWNsZSBoYXMgYmVlbiBjcmVhdGVkJyxcbiAgICAgICAgJ0lubGluZSBjaXRhdGlvbnMgYWRkZWQgdG8geW91ciBhcnRpY2xlIHdpbGwgYXV0b21hdGljYWxseSBkaXNwbGF5IGhlcmUnLFxuICAgICAgICAnTm90ZTogVGhlIGZvbGxvd2luZyBwYWdlcyB3ZXJlIHJlZGlyZWN0cyB0byAnLFxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IGNvbW1lbnQgb2YgY29tbWVudHMpXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2VBbGwobmV3IFJlZ0V4cChgICo8IS0tID8ke2VzY2FwZVJlZ2V4Q2hhcmFjdGVycyhjb21tZW50KX0uKj8tLT4gKlxcbj9gLCAnZ3MnKSwgJycpO1xuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8qKlxuICogQWRkcyByZWxldmFudCB0YWdzIHRvIGFuIGFydGljbGUncyBjb250ZW50LlxuICogQHBhcmFtIGNvbnRlbnQgVGhlIGFydGljbGUgY29udGVudCB0byBhZGQgdGFncyB0by5cbiAqL1xuZnVuY3Rpb24gYXV0b1RhZ1BhZ2UoY29udGVudDogc3RyaW5nKSB7XG4gICAgY29uc3QgbnVtYmVyT2ZDYXRlZ29yaWVzID0gWy4uLmNvbnRlbnQubWF0Y2hBbGwoL1xcW1xcW0NhdGVnb3J5Oi9nKV0ubGVuZ3RoO1xuXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZUFsbCgvXFxuKnt7KHVuY2F0ZWdvcml6ZWR8aW1wcm92ZSBjYXRlZ29yaWVzKShcXHwuKz8pP319XFxuKi9naSwgJycpO1xuXG4gICAgaWYgKG51bWJlck9mQ2F0ZWdvcmllcyA9PT0gMCAmJiAhL3t7dW5jYXRlZ29yaXplZC9pLnRlc3QoY29udGVudCkpXG4gICAgICAgIGNvbnRlbnQgKz0gJ1xcblxcbnt7VW5jYXRlZ29yaXplZHx7e3N1YnN0OkNVUlJFTlRNT05USE5BTUV9fSB7e3N1YnN0OkNVUlJFTlRZRUFSfX19fSc7XG4gICAgZWxzZSBpZiAobnVtYmVyT2ZDYXRlZ29yaWVzID09PSAxICYmICEve3tpbXByb3ZlIGNhdGVnb3JpZXMvaS50ZXN0KGNvbnRlbnQpKVxuICAgICAgICBjb250ZW50ICs9ICdcXG5cXG57e0ltcHJvdmUgY2F0ZWdvcmllc3x7e3N1YnN0OkNVUlJFTlRNT05USE5BTUV9fSB7e3N1YnN0OkNVUlJFTlRZRUFSfX19fSc7XG5cbiAgICByZXR1cm4gY29udGVudDtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7OzttQkFHTyxJQUFNQSxFQUFNLElBQUksR0FBRyxJQU0xQixlQUFzQkMsRUFBZUMsRUFBZSxDQUNoRCxPQUNLLE1BQU1GLEVBQUksSUFBSSxDQUNYLE9BQVEsUUFDUixjQUFlLElBQ2YsS0FBTSxZQUNOLE9BQVEsVUFDUixRQUFTLE9BQ1QsT0FBUUUsQ0FDWixDQUFtQyxHQUNyQyxNQUFNLE1BQU0sQ0FBQyxFQUFFLFlBQVksQ0FBQyxFQUFFLE1BQU0sS0FBSyxRQUFRLEtBQUssQ0FDNUQsRUNnQkMsSUFBTSxDQUVILEdBREksR0FBRyxPQUFPLElBQUksbUJBQW1CLEVBQUksR0FDckMsQ0FBQyxHQUFHLE9BQU8sSUFBSSxzQkFBc0IsRUFBRyxPQUU1QyxJQUFNQyxFQUFlLENBQUMsaUJBQWtCLHNCQUFzQixFQUUxRCxHQUFHLE9BQU8sSUFBSSxNQUFNLElBQU0sV0FBV0EsRUFBYSxLQUFLLHVCQUF1QixFQUVsRixHQUFHLE9BQU8sTUFBTUEsRUFBYyxJQUFNLENBQ2hDLElBQUlDLEVBQXlCLEdBRXZCQyxFQUFpQiw0RkFNdkIsU0FBU0MsRUFBY0MsRUFBa0QsQ0FD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SUFBTThILEVBQXFCLENBQUMsR0FBRzlILEVBQVEsU0FBUyxnQkFBZ0IsQ0FBQyxFQUFFLE9BRW5FLE9BQUFBLEVBQVVBLEVBQVEsV0FBVyx5REFBMEQsRUFBRSxFQUVyRjhILElBQXVCLEdBQUssQ0FBQyxtQkFBbUIsS0FBSzlILENBQU8sRUFDNURBLEdBQVc7QUFBQTtBQUFBLG9FQUNOOEgsSUFBdUIsR0FBSyxDQUFDLHdCQUF3QixLQUFLOUgsQ0FBTyxJQUN0RUEsR0FBVztBQUFBO0FBQUEsMEVBRVJBLENBQ1giLAogICJuYW1lcyI6IFsiYXBpIiwgImdldFBhZ2VDb250ZW50IiwgInRpdGxlIiwgImRlcGVuZGVuY2llcyIsICJzaG91bGRBZGRTY3JpcHRNZXNzYWdlIiwgIlNDUklQVF9NRVNTQUdFIiwgInVwZGF0ZVN1bW1hcnkiLCAidGV4dGFyZWEiLCAiaGFuZGxlQWN0aXZhdGlvbiIsICJldmVudCIsICJlZGl0b3IiLCAib3JpZ2luYWxUZXh0IiwgImZpbmFsVGV4dCIsICJjbGVhbnVwU3RyYXlVbmljb2RlQ2hhcmFjdGVycyIsICJjbGVhbnVwU2VjdGlvbkhlYWRlcnMiLCAiY2xlYW51cE1hZ2ljV29yZHMiLCAiY2xlYW51cERpc3BsYXl0aXRsZXNBbmREZWZhdWx0c29ydHMiLCAiY2xlYW51cENhdGVnb3JpZXMiLCAiY2xlYW51cExpbmtzIiwgImNsZWFudXBJbXByb3BlckNoYXJhY3RlcnMiLCAiY2xlYW51cFllYXJSYW5nZXMiLCAiY2xlYW51cFN0cmF5TWFya3VwIiwgImNsZWFudXBTcGFjaW5nIiwgImNsZWFudXBSZWZlcmVuY2VzIiwgImZvcm1hdFRlbXBsYXRlcyIsICJyZW1vdmVDb21tZW50cyIsICJhdXRvVGFnUGFnZSIsICJzdXJmYWNlTW9kZWwiLCAic3VtbWFyeUlucHV0IiwgImhlYWRlclN3aXRjaGVyIiwgImJ1dHRvbiIsICJjb250ZW50IiwgImVzY2FwZVJlZ2V4Q2hhcmFjdGVycyIsICJzdHJpbmciLCAic3RyYXlVbmljb2RlUmVnZXgiLCAiY29tbW9uUmVwbGFjZW1lbnRzIiwgImNvbW1vbk1pc2NhcGl0YWxpemVkV29yZHMiLCAicmV2ZXJzZUNvbW1vblJlcGxhY2VtZW50cyIsICJrZXkiLCAidmFsdWVzIiwgInZhbHVlIiwgInBhcnNlZEhlYWRlcnMiLCAiaGVhZGVyIiwgIm5hbWUiLCAic3RhcnRNYXJrdXAiLCAiZW5kTWFya3VwIiwgImxpbmtzIiwgImxpbmsiLCAiZGVwdGgiLCAiaGVhZGVyc1NldCIsICJ0aXRsZVNwYWNlciIsICJsb3dlcmNhc2VOYW1lIiwgImNhcGl0YWxpemVkTmFtZSIsICJ3b3JkIiwgIm91dHB1dCIsICJwYXJzZWRUYWdzIiwgInRhZyIsICJmdWxsVGFnIiwgInR5cGUiLCAiY3VycmVudFRpdGxlIiwgIm9yaWdpbmFsVGFnUmVnZXgiLCAidW5wcmVmaXhlZFRpdGxlIiwgInRpdGxlIiwgImRlZmF1bHRLZXkiLCAiY3VzdG9tS2V5IiwgIm5ld1RleHQiLCAiZnVuY3Rpb25zQ2FsbGVkV2hpbGVFc2NhcGVkIiwgImNsb3NlZExpbmtzIiwgImlzSW5zaWRlTm93aWtpIiwgImlzSW5zaWRlQ29tbWVudCIsICJjdXJyZW50TG9jYXRpb24iLCAiaXNBdFN0cmluZyIsICJkZXNpcmVkU3RyaW5nIiwgInNob3VsZEluY3JlbWVudCIsICJsYXN0TGluayIsICJuZXdMaW5rQ29udGVudCIsICJuYW1lc3BhY2VOYW1lcyIsICJsaW5rTG9jYXRpb24iLCAiaW5uZXJMaW5rIiwgInVucGFyc2VkTGluayIsICJwYXJhbWV0ZXJzIiwgImFsdFRleHQiLCAiaXNGaXJzdENoYXJhY3RlckNvbG9uIiwgInNob3VsZEZpcnN0Q2hhcmFjdGVyQmVDb2xvbiIsICJsaW5rVXBwZXJjYXNlU3RhcnQiLCAibGlua0xvd2VyY2FzZVN0YXJ0IiwgIm5hbWVzcGFjZSIsICJhZnRlckxpbmtUZXh0IiwgImFkZGVkUHVuY3R1YXRpb24iLCAibmV3TGluayIsICJmdW5jdGlvblRvQ2FsbCIsICJsb29wQ291bnRlciIsICJsaW5rRGF0YSIsICJsaW5rQ29udGVudCIsICJydW4iLCAiZWxpcHNpc1BsYWNlaG9sZGVyIiwgIm5ic3BQbGFjZWhvbGRlciIsICJvcmlnaW5hbCIsICJzdGFydCIsICJlbmQiLCAic3RyYXlNYXJrdXBSZWdleGVzIiwgInJlZ2V4IiwgInNlY29uZFJ1biIsICJmdWxsTWF0Y2giLCAicmVmZXJlbmNlVGFnIiwgInB1bmN0dWF0aW9uIiwgInJlZmVyZW5jZXMiLCAicHJvY2VlZFVudGlsU3RyaW5nIiwgImlzU2VsZkNsb3NpbmciLCAicGFyc2VyIiwgInJlcGxhY2VtZW50cyIsICJyZWZlcmVuY2UiLCAic3RhcnRUYWciLCAidGFnQ29udGVudCIsICJ0ZW1wbGF0ZUFsaWFzZXMiLCAiRm9ybWF0U3R5bGUiLCAiTmFtZXNwYWNlIiwgImdldFBhZ2VDb250ZW50IiwgIm1hcHBlZFRlbXBsYXRlQWxpYXNlcyIsICJhbGlhcyIsICJmcm9tIiwgIlRlbXBsYXRlIiwgInN0YXJ0TG9jYXRpb24iLCAic3ViVGVtcGxhdGUiLCAidHJpbW1lZElubmVyVGV4dCIsICJwaXBlRXNjYXBlUmVnZXgiLCAiZnVsbFRleHQiLCAidGFnTmFtZSIsICJhdHRyaWJ1dGVzIiwgInBhcmFtZXRlciIsICJuYW1lTG93ZXJjYXNlRmlyc3QiLCAiaXNTdGFydExvd2VyIiwgImZpbmFsTmFtZSIsICJzcGxpdFBhcmFtZXRlcnMiLCAiZXF1YWxzTG9jYXRpb24iLCAidGVtcGxhdGVzIiwgIm1vc3RTcGVjaWZpY0RlZmF1bHRTdHlsZVByZWZpeExlbmd0aCIsICJtb3N0U3BlY2lmaWNEZWZhdWx0U3R5bGVGb3JtYXRTdHlsZSIsICJmb3JtYXRTdHlsZSIsICJ0ZW1wbGF0ZVByZWZpeGVzIiwgInRlbXBsYXRlUHJlZml4IiwgImltYWdlUGFyYW1ldGVycyIsICJudW1iZXIiLCAic2hvdWxkU3Vic3QiLCAic3R5bGUiLCAibmV3TmFtZSIsICJyZXF1aXJlZEtleUxlbmd0aCIsICJpbmRleCIsICJqb2luZWRPdXRwdXQiLCAiYWxsVGVtcGxhdGVzIiwgImluc2lkZVRlbXBsYXRlcyIsICJpc0luc2lkZUxpbmsiLCAidGVtcGxhdGUiLCAibGFzdFRlbXBsYXRlIiwgIm5ld0NvbnRlbnQiLCAiY29tbWVudHMiLCAiY29tbWVudCIsICJudW1iZXJPZkNhdGVnb3JpZXMiXQp9Cg==
