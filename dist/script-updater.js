// <nowiki>
// Note: This script was compiled and minified from TypeScript. For a more readable version, see https://github.com/Eejit43/wikipedia-scripts/blob/main/scripts/script-updater.ts

"use strict";(()=>{mw.loader.using(["mediawiki.util","oojs-ui-core","oojs-ui-widgets","oojs-ui-windows"],()=>{if(mw.config.get("wgUserName")!=="Eejit43"||mw.config.get("wgPageName")!=="User:Eejit43")return;let y=document.querySelector(".mw-editsection").cloneNode(!0),d=document.createElement("a");d.href="#",d.style.fontWeight="bold",d.textContent="Sync from GitHub",d.addEventListener("click",m=>{m.preventDefault();let e=new OO.ui.WindowManager;document.body.append(e.$element[0]);let t=new p;e.addWindows([t]),t.open()}),y.querySelector("a").replaceWith(d),document.querySelector("h2#My_user_scripts + .mw-editsection").after(y);class p extends OO.ui.ProcessDialog{api=new mw.Api;repoOwner="Eejit43";repoName="wikipedia-scripts";scriptMessage=" (via [[User:Eejit43/scripts/script-updater.js|script]])";content;scriptsMultiselect;actionsMultiselect;latestCommitHash;scripts;scriptDataUpdaters={"redirect-helper":w};constructor(){super({size:"medium"}),p.static.name="ScriptUpdaterDialog",p.static.title="script-updater",p.static.actions=[{action:"cancel",label:"Close",flags:["safe","close"]},{action:"save",label:"Run",flags:["primary","progressive"]}]}getSetupProcess=()=>p.super.prototype.getSetupProcess.call(this).next(()=>this.wrapAsyncMethod(this.loadScriptData).then(e=>{if(e){let r=new OO.ui.MessageWidget({type:"error",label:e});this.content=new OO.ui.PanelLayout({padded:!0,expanded:!1}),this.content.$element.append(r.$element),this.$body.append(this.content.$element),this.getActions().setAbilities({save:!1});return}this.content=new OO.ui.PanelLayout({padded:!0,expanded:!1}),this.scriptsMultiselect=new OO.ui.CheckboxMultiselectWidget({items:this.scripts.map(r=>new OO.ui.CheckboxMultioptionWidget({data:r.name,label:r.name}))}),this.scriptsMultiselect.$element[0].style.columnCount="2";let t=new OO.ui.FieldLayout(this.scriptsMultiselect,{label:new OO.ui.HtmlSnippet("<b>Scripts to update:</b>"),align:"top"});this.actionsMultiselect=new OO.ui.CheckboxMultiselectWidget({items:[{id:"documentation",name:"Update script documentation"},{id:"script",name:"Update script code"},{id:"talk",name:"Create talk redirect",selectedDefault:!1}].map(({id:r,name:s,selectedDefault:i})=>new OO.ui.CheckboxMultioptionWidget({data:r,label:s,selected:i??!0}))});let a=new OO.ui.FieldLayout(this.actionsMultiselect,{label:new OO.ui.HtmlSnippet("<b>Actions to take (if applicable):</b>"),align:"top"}),o=new OO.ui.ButtonGroupWidget({items:Object.entries(this.scriptDataUpdaters).map(([r,s])=>{let i=new OO.ui.ButtonWidget({label:`Update ${r} data`,flags:["progressive"]});return i.on("click",async()=>{mw.notify(`Fetching ${r} data...`,{tag:"update-script-data-notification"});let c=await s();mw.notify(`Successfully fetched ${r} data, opening diff...`,{type:"success",tag:"update-script-data-notification"}),await new Promise(g=>setTimeout(g,500)),this.openDiff("User:Eejit43/scripts/redirect-helper.json",c)}),i})}),l=new OO.ui.FieldLayout(o,{label:new OO.ui.HtmlSnippet("<b>Script data updaters:</b>"),align:"top"});this.content.$element.append(t.$element),this.content.$element.append(a.$element),this.content.$element.append(l.$element),this.$body.append(this.content.$element)}));getActionProcess=e=>e==="cancel"?new OO.ui.Process(()=>{this.close()}):e==="save"?new OO.ui.Process(()=>{let t=this.scriptsMultiselect.findSelectedItemsData().map(a=>this.scripts.find(o=>o.name===a));this.close(),(async()=>(mw.notify("Syncing scripts...",{tag:"sync-scripts-notification"}),await Promise.all(t.map(a=>this.handleScript(a))),await this.editOrCreate("User:Eejit43/scripts-info",[this.mapScripts(this.scripts.filter(a=>!a.personal&&!a.fork)),"","=== Forks ===",this.mapScripts(this.scripts.filter(a=>a.fork)),"","=== Personal scripts ===",this.mapScripts(this.scripts.filter(a=>a.personal))].join(`
`),"Syncing script list from GitHub"),mw.notify(`Synced ${t.length} script${t.length===1?"":"s"} from GitHub!`,{type:"success",tag:"sync-scripts-notification"})))()}):p.super.prototype.getActionProcess.call(this,e);getTeardownProcess=()=>p.super.prototype.getTeardownProcess.call(this).next(()=>{this.$body.empty()});wrapAsyncMethod(e){let t=$.Deferred();return e().then(a=>t.resolve(a)),t.promise()}loadScriptData=async()=>{let e=await fetch(`https://api.github.com/repos/${this.repoOwner}/${this.repoName}/commits`);if(!e.ok)return`Failed to fetch latest commit hash from GitHub: ${e.statusText} (${e.status})`;this.latestCommitHash=(await e.json())[0].sha;let t=await fetch(`https://raw.githubusercontent.com/${this.repoOwner}/${this.repoName}/${this.latestCommitHash}/scripts.json`);if(!t.ok)return`Failed to fetch script data from GitHub: ${t.statusText} (${t.status})`;let a=await t.json();this.scripts=Object.entries(a).map(([o,l])=>({name:o,...l}))};async handleScript(e){let t=this.actionsMultiselect.findSelectedItemsData(),a=`User:Eejit43/scripts/${e.name}`,o=`User talk:Eejit43/scripts/${e.name}`,l=`${a}.js`,r=["{{User:Eejit43/script-documentation",e.image===!1?`| image             = ${e.image}`:null,e["in-development"]?`| in-development    = ${e["in-development"]}`:null,e["use-instead"]?`| use-instead       = ${e["use-instead"].includes("User:")?e["use-instead"]:`[[User:Eejit43/scripts/${e["use-instead"]}|${e["use-instead"]}]]`}`:null,e["image-caption"]?`| image-caption     = ${e["image-caption"]}`:null,e["other-authors"]?`| other-authors     = ${e["other-authors"].map(i=>`[[User:${i}|${i}]]`).join(", ")}`:null,`| description-short = ${e["short-description"]}`,`| description       = ${e.description}`,e.usage?`| usage             = ${e.usage}`:null,e.configuration?`| configuration     = ${e.configuration}`:null,e.changelog?`| changelog         = 
${Object.entries(e.changelog).map(([i,c])=>`* '''{{start date and age|${i}}}:'''${Array.isArray(c)?`
${c.map(g=>`** ${g}`).join(`
`)}`:` ${c}`}`).join(`
`)}`:null,`| skin-support      = {{User:Eejit43/script-documentation/skin-support|${Object.entries(e["skin-support"]).map(([i,c])=>`${i}=${c}`).join("|")}}}`,e["source-multiple"]?`| source-multiple   = ${e["source-multiple"]}`:null,`| released          = {{start date and age|${e.released}}}`,`| updated           = {{start date and age|${e.updated}}}`,"}}"].filter(Boolean),s=null;if(t.includes("script")){let i=await fetch(`https://raw.githubusercontent.com/${this.repoOwner}/${this.repoName}/${this.latestCommitHash}/dist/${e.name}.js`);if(i.ok)s=await i.text();else return mw.notify(`Failed to fetch "${e.name}.js" from GitHub: ${i.statusText} (${i.status})`,{type:"error",tag:"sync-scripts-notification"})}e.personal||(t.includes("documentation")&&await this.editOrCreate(a,r.join(`
`),"Syncing script documentation from GitHub"),t.includes("talk")&&await this.editOrCreate(o,"#REDIRECT [[User talk:Eejit43]]","Redirecting script documentation talk page to main user talk page")),s&&await this.editOrCreate(l,s,"Syncing script from GitHub")}mapScripts(e){return e.map(t=>`* [[User:Eejit43/scripts/${t.name}${t.personal?".js":""}|${t.name}]] - ${t["short-description"]||t.description}${t["in-development"]?' (<span style="color: #bd2828">in development</span>)':""}${t["use-instead"]?' (<span style="color: #bd2828">deprecated</span>)':""}`).join(`
`)}async editOrCreate(e,t,a){a+=this.scriptMessage,await this.api.edit(e,()=>({text:t,summary:a,watchlist:"watch"})).catch(async(o,l)=>{if(o==="nocreate-missing")await this.api.create(e,{summary:a,watchlist:"watch"},t).catch((r,s)=>{mw.notify(`Error creating ${e}: ${s?.error?.info??"Unknown error"} (${r})`,{type:"error"})});else{mw.notify(`Error editing or creating ${e}: ${l?.error?.info??"Unknown error"} (${o})`,{type:"error"});return}})}openDiff(e,t){let a={wpTextbox1:t,wpSummary:`Updating data${this.scriptMessage}`,wpDiff:"1",wpUltimateParam:"1"},o=new URL(`${mw.config.get("wgScriptPath")}/index.php`,window.location.origin);o.searchParams.set("title",e),o.searchParams.set("action","submit");let l=document.createElement("form");l.action=o.toString(),l.method="POST",l.target="_blank";for(let[r,s]of Object.entries(a)){let i=document.createElement("input");i.type="hidden",i.name=r,i.value=s,l.append(i)}document.body.append(l),l.submit(),l.remove()}}Object.assign(p.prototype,OO.ui.ProcessDialog.prototype);async function w(){let m=new mw.Api,e=await m.get({action:"query",list:"categorymembers",cmtitle:"Category:Redirect templates",cmlimit:"max",formatversion:"2"}),t=await m.get({action:"query",list:"categorymembers",cmtitle:"Category:Template redirects with possibilities",cmlimit:"max",formatversion:"2"}),a=e.query.categorymembers.filter(s=>s.title.startsWith("Template:R ")&&s.title!=="Template:R template index").map(s=>({name:s.title.split(":")[1],redirect:!1})),o=t.query.categorymembers.filter(s=>s.title.startsWith("Template:R ")&&s.title!=="Template:R with possibilities").map(s=>({name:s.title.split(":")[1],redirect:!0})),l=[],r=await Promise.all([...a,...o].sort((s,i)=>s.name.startsWith("R comics")||s.name.startsWith("R ME")?1:i.name.startsWith("R comics")||i.name.startsWith("R ME")?-1:s.name.localeCompare(i.name)).map(async s=>{let i=await m.get({action:"templatedata",titles:"Template:"+s.name,formatversion:"2"}),c=Object.values(i.pages)[0]?.params||{},g=Object.fromEntries(Object.entries(c).map(([f,n])=>[f,{aliases:n.aliases,label:n.label?.en??null,description:n.description?.en??null,type:n.type,required:n.required,suggested:n.suggested,default:n.default?.en??null,example:n.example?.en??null}])),h;s.redirect?(h=(await m.get({action:"query",titles:"Template:"+s.name,prop:"linkshere",lhnamespace:10,lhlimit:"max",formatversion:"2"})).query.pages[0].linkshere?.filter(n=>n.redirect).map(n=>n.title.split(":")[1]).filter(n=>![...a,...o].some(u=>u.name===n)&&!n.endsWith("/doc")&&!n.endsWith("/sandbox")).sort((n,u)=>n.localeCompare(u))??[],l.push(...h)):h=(await m.get({action:"query",titles:"Template:"+s.name,prop:"redirects",rdlimit:"max",formatversion:"2"})).query.pages[0].redirects?.filter(n=>n.ns===10).map(n=>n.title.split(":")[1]).filter(n=>!o.some(u=>u.name===n)).sort((n,u)=>n.localeCompare(u))??[];let b={...s.redirect?{redirect:!0}:{},parameters:g,aliases:h};return[s.name,b]}));for(let s of l)for(let[,i]of r)!i.redirect&&i.aliases.includes(s)&&(i.aliases=i.aliases.filter(c=>c!==s));return JSON.stringify(Object.fromEntries(r))}});})();

// </nowiki>
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc2NyaXB0cy9zY3JpcHQtdXBkYXRlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHR5cGUge1xuICAgIEFwaVF1ZXJ5QmFja2xpbmtzcHJvcFBhcmFtcyxcbiAgICBBcGlRdWVyeUNhdGVnb3J5TWVtYmVyc1BhcmFtcyxcbiAgICBUZW1wbGF0ZURhdGFBcGlUZW1wbGF0ZURhdGFQYXJhbXMsXG59IGZyb20gJ3R5cGVzLW1lZGlhd2lraS9hcGlfcGFyYW1zJztcbmltcG9ydCB0eXBlIHsgQ2F0ZWdvcnlNZW1iZXJzUmVzdWx0LCBMaW5rc0hlcmVSZXN1bHQsIE1lZGlhV2lraURhdGFFcnJvciwgUmVkaXJlY3RzUmVzdWx0LCBUZW1wbGF0ZURhdGFSZXN1bHQgfSBmcm9tICcuLi9nbG9iYWwtdHlwZXMnO1xuXG5pbnRlcmZhY2UgU2NyaXB0IHtcbiAgICAnbmFtZSc6IHN0cmluZztcbiAgICAnaW4tZGV2ZWxvcG1lbnQnPzogYm9vbGVhbjtcbiAgICAndXNlLWluc3RlYWQnPzogc3RyaW5nO1xuICAgICdpbWFnZSc/OiBmYWxzZTtcbiAgICAnaW1hZ2UtY2FwdGlvbic/OiBzdHJpbmc7XG4gICAgJ3Nob3J0LWRlc2NyaXB0aW9uJzogc3RyaW5nO1xuICAgICdkZXNjcmlwdGlvbic6IHN0cmluZztcbiAgICAndXNhZ2UnPzogc3RyaW5nO1xuICAgICdjb25maWd1cmF0aW9uJz86IHN0cmluZztcbiAgICAnY2hhbmdlbG9nJz86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHN0cmluZ1tdPjtcbiAgICAnb3RoZXItYXV0aG9ycyc/OiBzdHJpbmdbXTtcbiAgICAnZm9yayc/OiB0cnVlO1xuICAgICdwZXJzb25hbCc/OiB0cnVlO1xuICAgICdza2luLXN1cHBvcnQnOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPjtcbiAgICAnc291cmNlLW11bHRpcGxlJz86IHRydWU7XG4gICAgJ3JlbGVhc2VkJzogc3RyaW5nO1xuICAgICd1cGRhdGVkJzogc3RyaW5nO1xufVxuXG5tdy5sb2FkZXIudXNpbmcoWydtZWRpYXdpa2kudXRpbCcsICdvb2pzLXVpLWNvcmUnLCAnb29qcy11aS13aWRnZXRzJywgJ29vanMtdWktd2luZG93cyddLCAoKSA9PiB7XG4gICAgaWYgKG13LmNvbmZpZy5nZXQoJ3dnVXNlck5hbWUnKSAhPT0gJ0Vlaml0NDMnIHx8IG13LmNvbmZpZy5nZXQoJ3dnUGFnZU5hbWUnKSAhPT0gJ1VzZXI6RWVqaXQ0MycpIHJldHVybjtcblxuICAgIGNvbnN0IGZ1bGxMaW5rRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tdy1lZGl0c2VjdGlvbicpIS5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTFNwYW5FbGVtZW50O1xuXG4gICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICBsaW5rLmhyZWYgPSAnIyc7XG4gICAgbGluay5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuICAgIGxpbmsudGV4dENvbnRlbnQgPSAnU3luYyBmcm9tIEdpdEh1Yic7XG4gICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IHdpbmRvd01hbmFnZXIgPSBuZXcgT08udWkuV2luZG93TWFuYWdlcigpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZCh3aW5kb3dNYW5hZ2VyLiRlbGVtZW50WzBdKTtcblxuICAgICAgICBjb25zdCBzY3JpcHRVcGRhdGVyRGlhbG9nID0gbmV3IFNjcmlwdFVwZGF0ZXJEaWFsb2coKTtcbiAgICAgICAgd2luZG93TWFuYWdlci5hZGRXaW5kb3dzKFtzY3JpcHRVcGRhdGVyRGlhbG9nXSk7XG5cbiAgICAgICAgc2NyaXB0VXBkYXRlckRpYWxvZy5vcGVuKCk7XG4gICAgfSk7XG5cbiAgICBmdWxsTGlua0VsZW1lbnQucXVlcnlTZWxlY3RvcignYScpIS5yZXBsYWNlV2l0aChsaW5rKTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyI015X3VzZXJfc2NyaXB0cyArIC5tdy1lZGl0c2VjdGlvbicpIS5hZnRlcihmdWxsTGlua0VsZW1lbnQpO1xuXG4gICAgLyoqXG4gICAgICogQW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcyBpcyBhIGRpYWxvZyB0aGF0IG1hbmFnZXMgdXBkYXRpbmcgc2NyaXB0cy5cbiAgICAgKi9cbiAgICBjbGFzcyBTY3JpcHRVcGRhdGVyRGlhbG9nIGV4dGVuZHMgT08udWkuUHJvY2Vzc0RpYWxvZyB7XG4gICAgICAgIHByaXZhdGUgYXBpID0gbmV3IG13LkFwaSgpO1xuXG4gICAgICAgIHByaXZhdGUgcmVwb093bmVyID0gJ0Vlaml0NDMnO1xuICAgICAgICBwcml2YXRlIHJlcG9OYW1lID0gJ3dpa2lwZWRpYS1zY3JpcHRzJztcblxuICAgICAgICBwcml2YXRlIHNjcmlwdE1lc3NhZ2UgPSAnICh2aWEgW1tVc2VyOkVlaml0NDMvc2NyaXB0cy9zY3JpcHQtdXBkYXRlci5qc3xzY3JpcHRdXSknO1xuXG4gICAgICAgIHByaXZhdGUgY29udGVudCE6IE9PLnVpLlBhbmVsTGF5b3V0O1xuICAgICAgICBwcml2YXRlIHNjcmlwdHNNdWx0aXNlbGVjdCE6IE9PLnVpLkNoZWNrYm94TXVsdGlzZWxlY3RXaWRnZXQ7XG4gICAgICAgIHByaXZhdGUgYWN0aW9uc011bHRpc2VsZWN0ITogT08udWkuQ2hlY2tib3hNdWx0aXNlbGVjdFdpZGdldDtcblxuICAgICAgICBwcml2YXRlIGxhdGVzdENvbW1pdEhhc2ghOiBzdHJpbmc7XG4gICAgICAgIHByaXZhdGUgc2NyaXB0cyE6IFNjcmlwdFtdO1xuXG4gICAgICAgIHByaXZhdGUgc2NyaXB0RGF0YVVwZGF0ZXJzID0ge1xuICAgICAgICAgICAgJ3JlZGlyZWN0LWhlbHBlcic6IGdldFJlZGlyZWN0SGVscGVyRGF0YSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1cGVyKHsgc2l6ZTogJ21lZGl1bScgfSk7XG5cbiAgICAgICAgICAgIFNjcmlwdFVwZGF0ZXJEaWFsb2cuc3RhdGljLm5hbWUgPSAnU2NyaXB0VXBkYXRlckRpYWxvZyc7XG4gICAgICAgICAgICBTY3JpcHRVcGRhdGVyRGlhbG9nLnN0YXRpYy50aXRsZSA9ICdzY3JpcHQtdXBkYXRlcic7XG4gICAgICAgICAgICBTY3JpcHRVcGRhdGVyRGlhbG9nLnN0YXRpYy5hY3Rpb25zID0gW1xuICAgICAgICAgICAgICAgIHsgYWN0aW9uOiAnY2FuY2VsJywgbGFiZWw6ICdDbG9zZScsIGZsYWdzOiBbJ3NhZmUnLCAnY2xvc2UnXSB9LFxuICAgICAgICAgICAgICAgIHsgYWN0aW9uOiAnc2F2ZScsIGxhYmVsOiAnUnVuJywgZmxhZ3M6IFsncHJpbWFyeScsICdwcm9ncmVzc2l2ZSddIH0sXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2V0U2V0dXBQcm9jZXNzID0gKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIFNjcmlwdFVwZGF0ZXJEaWFsb2cuc3VwZXIucHJvdG90eXBlLmdldFNldHVwUHJvY2Vzcy5jYWxsKHRoaXMpLm5leHQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLndyYXBBc3luY01ldGhvZCh0aGlzLmxvYWRTY3JpcHREYXRhKS50aGVuKChlcnJvcj86IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VFbGVtZW50ID0gbmV3IE9PLnVpLk1lc3NhZ2VXaWRnZXQoeyB0eXBlOiAnZXJyb3InLCBsYWJlbDogZXJyb3IgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGVudCA9IG5ldyBPTy51aS5QYW5lbExheW91dCh7IHBhZGRlZDogdHJ1ZSwgZXhwYW5kZWQ6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZW50LiRlbGVtZW50LmFwcGVuZChtZXNzYWdlRWxlbWVudC4kZWxlbWVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzIGFzIHVua25vd24gYXMgeyAkYm9keTogSlF1ZXJ5IH0pLiRib2R5LmFwcGVuZCh0aGlzLmNvbnRlbnQuJGVsZW1lbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEFjdGlvbnMoKS5zZXRBYmlsaXRpZXMoeyBzYXZlOiBmYWxzZSB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZW50ID0gbmV3IE9PLnVpLlBhbmVsTGF5b3V0KHsgcGFkZGVkOiB0cnVlLCBleHBhbmRlZDogZmFsc2UgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JpcHRzTXVsdGlzZWxlY3QgPSBuZXcgT08udWkuQ2hlY2tib3hNdWx0aXNlbGVjdFdpZGdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogdGhpcy5zY3JpcHRzLm1hcCgoc2NyaXB0KSA9PiBuZXcgT08udWkuQ2hlY2tib3hNdWx0aW9wdGlvbldpZGdldCh7IGRhdGE6IHNjcmlwdC5uYW1lLCBsYWJlbDogc2NyaXB0Lm5hbWUgfSkpLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JpcHRzTXVsdGlzZWxlY3QuJGVsZW1lbnRbMF0uc3R5bGUuY29sdW1uQ291bnQgPSAnMic7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2NyaXB0c011bHRpc2VsZWN0TGF5b3V0ID0gbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHRoaXMuc2NyaXB0c011bHRpc2VsZWN0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogbmV3IE9PLnVpLkh0bWxTbmlwcGV0KCc8Yj5TY3JpcHRzIHRvIHVwZGF0ZTo8L2I+JyksXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogJ3RvcCcsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uc011bHRpc2VsZWN0ID0gbmV3IE9PLnVpLkNoZWNrYm94TXVsdGlzZWxlY3RXaWRnZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGlkOiAnZG9jdW1lbnRhdGlvbicsIG5hbWU6ICdVcGRhdGUgc2NyaXB0IGRvY3VtZW50YXRpb24nIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBpZDogJ3NjcmlwdCcsIG5hbWU6ICdVcGRhdGUgc2NyaXB0IGNvZGUnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBpZDogJ3RhbGsnLCBuYW1lOiAnQ3JlYXRlIHRhbGsgcmVkaXJlY3QnLCBzZWxlY3RlZERlZmF1bHQ6IGZhbHNlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBdLm1hcChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoeyBpZCwgbmFtZSwgc2VsZWN0ZWREZWZhdWx0IH0pID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBPTy51aS5DaGVja2JveE11bHRpb3B0aW9uV2lkZ2V0KHsgZGF0YTogaWQsIGxhYmVsOiBuYW1lLCBzZWxlY3RlZDogc2VsZWN0ZWREZWZhdWx0ID8/IHRydWUgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpb25zTXVsdGlzZWxlY3RMYXlvdXQgPSBuZXcgT08udWkuRmllbGRMYXlvdXQodGhpcy5hY3Rpb25zTXVsdGlzZWxlY3QsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBuZXcgT08udWkuSHRtbFNuaXBwZXQoJzxiPkFjdGlvbnMgdG8gdGFrZSAoaWYgYXBwbGljYWJsZSk6PC9iPicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ246ICd0b3AnLFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b25Hcm91cCA9IG5ldyBPTy51aS5CdXR0b25Hcm91cFdpZGdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogT2JqZWN0LmVudHJpZXModGhpcy5zY3JpcHREYXRhVXBkYXRlcnMpLm1hcCgoW25hbWUsIHVwZGF0ZXJdKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IE9PLnVpLkJ1dHRvbldpZGdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBgVXBkYXRlICR7bmFtZX0gZGF0YWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWdzOiBbJ3Byb2dyZXNzaXZlJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBGZXRjaGluZyAke25hbWV9IGRhdGEuLi5gLCB7IHRhZzogJ3VwZGF0ZS1zY3JpcHQtZGF0YS1ub3RpZmljYXRpb24nIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB1cGRhdGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBTdWNjZXNzZnVsbHkgZmV0Y2hlZCAke25hbWV9IGRhdGEsIG9wZW5pbmcgZGlmZi4uLmAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZzogJ3VwZGF0ZS1zY3JpcHQtZGF0YS1ub3RpZmljYXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTsgLy8gQWxsb3cgdGhlIG5vdGlmaWNhdGlvbiB0byBiZSBzaG93blxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3BlbkRpZmYoJ1VzZXI6RWVqaXQ0My9zY3JpcHRzL3JlZGlyZWN0LWhlbHBlci5qc29uJywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYnV0dG9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjcmlwdERhdGFVcGRhdGVyc011bHRpc2VsZWN0TGF5b3V0ID0gbmV3IE9PLnVpLkZpZWxkTGF5b3V0KGJ1dHRvbkdyb3VwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogbmV3IE9PLnVpLkh0bWxTbmlwcGV0KCc8Yj5TY3JpcHQgZGF0YSB1cGRhdGVyczo8L2I+JyksXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogJ3RvcCcsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGVudC4kZWxlbWVudC5hcHBlbmQoc2NyaXB0c011bHRpc2VsZWN0TGF5b3V0LiRlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZW50LiRlbGVtZW50LmFwcGVuZChhY3Rpb25zTXVsdGlzZWxlY3RMYXlvdXQuJGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQuJGVsZW1lbnQuYXBwZW5kKHNjcmlwdERhdGFVcGRhdGVyc011bHRpc2VsZWN0TGF5b3V0LiRlbGVtZW50KTtcblxuICAgICAgICAgICAgICAgICAgICAodGhpcyBhcyB1bmtub3duIGFzIHsgJGJvZHk6IEpRdWVyeSB9KS4kYm9keS5hcHBlbmQodGhpcy5jb250ZW50LiRlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGdldEFjdGlvblByb2Nlc3MgPSAoYWN0aW9uOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdjYW5jZWwnKVxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT08udWkuUHJvY2VzcygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGFjdGlvbiA9PT0gJ3NhdmUnKVxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT08udWkuUHJvY2VzcygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkU2NyaXB0cyA9ICh0aGlzLnNjcmlwdHNNdWx0aXNlbGVjdC5maW5kU2VsZWN0ZWRJdGVtc0RhdGEoKSBhcyBzdHJpbmdbXSkubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgKHNjcmlwdE5hbWUpID0+IHRoaXMuc2NyaXB0cy5maW5kKChzY3JpcHQpID0+IHNjcmlwdC5uYW1lID09PSBzY3JpcHROYW1lKSEsXG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeSgnU3luY2luZyBzY3JpcHRzLi4uJywgeyB0YWc6ICdzeW5jLXNjcmlwdHMtbm90aWZpY2F0aW9uJyB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoc2VsZWN0ZWRTY3JpcHRzLm1hcCgoc2NyaXB0KSA9PiB0aGlzLmhhbmRsZVNjcmlwdChzY3JpcHQpKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZWRpdE9yQ3JlYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdVc2VyOkVlaml0NDMvc2NyaXB0cy1pbmZvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFwU2NyaXB0cyh0aGlzLnNjcmlwdHMuZmlsdGVyKChzY3JpcHQpID0+ICFzY3JpcHQucGVyc29uYWwgJiYgIXNjcmlwdC5mb3JrKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPT09IEZvcmtzID09PScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFwU2NyaXB0cyh0aGlzLnNjcmlwdHMuZmlsdGVyKChzY3JpcHQpID0+IHNjcmlwdC5mb3JrKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPT09IFBlcnNvbmFsIHNjcmlwdHMgPT09JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXBTY3JpcHRzKHRoaXMuc2NyaXB0cy5maWx0ZXIoKHNjcmlwdCkgPT4gc2NyaXB0LnBlcnNvbmFsKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5qb2luKCdcXG4nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnU3luY2luZyBzY3JpcHQgbGlzdCBmcm9tIEdpdEh1YicsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoYFN5bmNlZCAke3NlbGVjdGVkU2NyaXB0cy5sZW5ndGh9IHNjcmlwdCR7c2VsZWN0ZWRTY3JpcHRzLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnfSBmcm9tIEdpdEh1YiFgLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZzogJ3N5bmMtc2NyaXB0cy1ub3RpZmljYXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlbHNlIHJldHVybiBTY3JpcHRVcGRhdGVyRGlhbG9nLnN1cGVyLnByb3RvdHlwZS5nZXRBY3Rpb25Qcm9jZXNzLmNhbGwodGhpcywgYWN0aW9uKTtcbiAgICAgICAgfTtcblxuICAgICAgICBnZXRUZWFyZG93blByb2Nlc3MgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gU2NyaXB0VXBkYXRlckRpYWxvZy5zdXBlci5wcm90b3R5cGUuZ2V0VGVhcmRvd25Qcm9jZXNzLmNhbGwodGhpcykubmV4dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgKHRoaXMgYXMgdW5rbm93biBhcyB7ICRib2R5OiBKUXVlcnkgfSkuJGJvZHkuZW1wdHkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXcmFwcyBhbiBhc3luYyBtZXRob2QgaW50byBhIGpRdWVyeSBEZWZlcnJlZCBvYmplY3QuXG4gICAgICAgICAqIEBwYXJhbSBtZXRob2QgVGhlIG1ldGhvZCB0byB3cmFwLlxuICAgICAgICAgKi9cbiAgICAgICAgcHJpdmF0ZSB3cmFwQXN5bmNNZXRob2QobWV0aG9kOiAoKSA9PiBQcm9taXNlPHVua25vd24+KSB7XG4gICAgICAgICAgICBjb25zdCBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcblxuICAgICAgICAgICAgdm9pZCBtZXRob2QoKS50aGVuKChyZXN1bHQpID0+IGRlZmVycmVkLnJlc29sdmUocmVzdWx0KSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTG9hZHMgZGF0YSBmb3IgYWxsIHNjcmlwdHMuXG4gICAgICAgICAqL1xuICAgICAgICBwcml2YXRlIGxvYWRTY3JpcHREYXRhID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGF0ZXN0Q29tbWl0SGFzaFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvJHt0aGlzLnJlcG9Pd25lcn0vJHt0aGlzLnJlcG9OYW1lfS9jb21taXRzYCk7XG4gICAgICAgICAgICBpZiAoIWxhdGVzdENvbW1pdEhhc2hSZXNwb25zZS5vaylcbiAgICAgICAgICAgICAgICByZXR1cm4gYEZhaWxlZCB0byBmZXRjaCBsYXRlc3QgY29tbWl0IGhhc2ggZnJvbSBHaXRIdWI6ICR7bGF0ZXN0Q29tbWl0SGFzaFJlc3BvbnNlLnN0YXR1c1RleHR9ICgke2xhdGVzdENvbW1pdEhhc2hSZXNwb25zZS5zdGF0dXN9KWA7XG5cbiAgICAgICAgICAgIHRoaXMubGF0ZXN0Q29tbWl0SGFzaCA9ICgoYXdhaXQgbGF0ZXN0Q29tbWl0SGFzaFJlc3BvbnNlLmpzb24oKSkgYXMgeyBzaGE6IHN0cmluZyB9W10pWzBdLnNoYTtcblxuICAgICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICAgICAgICAgYGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS8ke3RoaXMucmVwb093bmVyfS8ke3RoaXMucmVwb05hbWV9LyR7dGhpcy5sYXRlc3RDb21taXRIYXNofS9zY3JpcHRzLmpzb25gLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghc2NyaXB0RGF0YVJlc3BvbnNlLm9rKVxuICAgICAgICAgICAgICAgIHJldHVybiBgRmFpbGVkIHRvIGZldGNoIHNjcmlwdCBkYXRhIGZyb20gR2l0SHViOiAke3NjcmlwdERhdGFSZXNwb25zZS5zdGF0dXNUZXh0fSAoJHtzY3JpcHREYXRhUmVzcG9uc2Uuc3RhdHVzfSlgO1xuXG4gICAgICAgICAgICBjb25zdCBzY3JpcHREYXRhID0gKGF3YWl0IHNjcmlwdERhdGFSZXNwb25zZS5qc29uKCkpIGFzIFJlY29yZDxzdHJpbmcsIE9taXQ8U2NyaXB0LCAnbmFtZSc+PjtcblxuICAgICAgICAgICAgdGhpcy5zY3JpcHRzID0gT2JqZWN0LmVudHJpZXMoc2NyaXB0RGF0YSkubWFwKChbc2NyaXB0TmFtZSwgc2NyaXB0XSkgPT4gKHsgbmFtZTogc2NyaXB0TmFtZSwgLi4uc2NyaXB0IH0pKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlcyBhbmQgZWRpdHMvY3JlYXRlcyBwYWdlcyBmb3IgYSBnaXZlbiBzY3JpcHQuXG4gICAgICAgICAqIEBwYXJhbSBzY3JpcHQgVGhlIHNjcmlwdCB0byBoYW5kbGUuXG4gICAgICAgICAqL1xuICAgICAgICBwcml2YXRlIGFzeW5jIGhhbmRsZVNjcmlwdChzY3JpcHQ6IFNjcmlwdCkge1xuICAgICAgICAgICAgY29uc3QgYWN0aW9uc1RvVGFrZSA9IHRoaXMuYWN0aW9uc011bHRpc2VsZWN0LmZpbmRTZWxlY3RlZEl0ZW1zRGF0YSgpIGFzICgnZG9jdW1lbnRhdGlvbicgfCAnc2NyaXB0JyB8ICd0YWxrJylbXTtcblxuICAgICAgICAgICAgY29uc3Qgc3VicGFnZU5hbWUgPSBgVXNlcjpFZWppdDQzL3NjcmlwdHMvJHtzY3JpcHQubmFtZX1gO1xuICAgICAgICAgICAgY29uc3Qgc3VicGFnZVRhbGtOYW1lID0gYFVzZXIgdGFsazpFZWppdDQzL3NjcmlwdHMvJHtzY3JpcHQubmFtZX1gO1xuICAgICAgICAgICAgY29uc3Qgc2NyaXB0TmFtZSA9IGAke3N1YnBhZ2VOYW1lfS5qc2A7XG5cbiAgICAgICAgICAgIGNvbnN0IGZ1bGxTdWJwYWdlSW5mbyA9IFtcbiAgICAgICAgICAgICAgICAne3tVc2VyOkVlaml0NDMvc2NyaXB0LWRvY3VtZW50YXRpb24nLFxuICAgICAgICAgICAgICAgIHNjcmlwdC5pbWFnZSA9PT0gZmFsc2UgPyBgfCBpbWFnZSAgICAgICAgICAgICA9ICR7c2NyaXB0LmltYWdlfWAgOiBudWxsLFxuICAgICAgICAgICAgICAgIHNjcmlwdFsnaW4tZGV2ZWxvcG1lbnQnXSA/IGB8IGluLWRldmVsb3BtZW50ICAgID0gJHtzY3JpcHRbJ2luLWRldmVsb3BtZW50J119YCA6IG51bGwsXG4gICAgICAgICAgICAgICAgc2NyaXB0Wyd1c2UtaW5zdGVhZCddXG4gICAgICAgICAgICAgICAgICAgID8gYHwgdXNlLWluc3RlYWQgICAgICAgPSAke3NjcmlwdFsndXNlLWluc3RlYWQnXS5pbmNsdWRlcygnVXNlcjonKSA/IHNjcmlwdFsndXNlLWluc3RlYWQnXSA6IGBbW1VzZXI6RWVqaXQ0My9zY3JpcHRzLyR7c2NyaXB0Wyd1c2UtaW5zdGVhZCddfXwke3NjcmlwdFsndXNlLWluc3RlYWQnXX1dXWB9YFxuICAgICAgICAgICAgICAgICAgICA6IG51bGwsXG4gICAgICAgICAgICAgICAgc2NyaXB0WydpbWFnZS1jYXB0aW9uJ10gPyBgfCBpbWFnZS1jYXB0aW9uICAgICA9ICR7c2NyaXB0WydpbWFnZS1jYXB0aW9uJ119YCA6IG51bGwsXG4gICAgICAgICAgICAgICAgc2NyaXB0WydvdGhlci1hdXRob3JzJ11cbiAgICAgICAgICAgICAgICAgICAgPyBgfCBvdGhlci1hdXRob3JzICAgICA9ICR7c2NyaXB0WydvdGhlci1hdXRob3JzJ10ubWFwKChhdXRob3IpID0+IGBbW1VzZXI6JHthdXRob3J9fCR7YXV0aG9yfV1dYCkuam9pbignLCAnKX1gXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgICAgICAgICBgfCBkZXNjcmlwdGlvbi1zaG9ydCA9ICR7c2NyaXB0WydzaG9ydC1kZXNjcmlwdGlvbiddfWAsXG4gICAgICAgICAgICAgICAgYHwgZGVzY3JpcHRpb24gICAgICAgPSAke3NjcmlwdC5kZXNjcmlwdGlvbn1gLFxuICAgICAgICAgICAgICAgIHNjcmlwdC51c2FnZSA/IGB8IHVzYWdlICAgICAgICAgICAgID0gJHtzY3JpcHQudXNhZ2V9YCA6IG51bGwsXG4gICAgICAgICAgICAgICAgc2NyaXB0LmNvbmZpZ3VyYXRpb24gPyBgfCBjb25maWd1cmF0aW9uICAgICA9ICR7c2NyaXB0LmNvbmZpZ3VyYXRpb259YCA6IG51bGwsXG4gICAgICAgICAgICAgICAgc2NyaXB0LmNoYW5nZWxvZ1xuICAgICAgICAgICAgICAgICAgICA/IGB8IGNoYW5nZWxvZyAgICAgICAgID0gXFxuJHtPYmplY3QuZW50cmllcyhzY3JpcHQuY2hhbmdlbG9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKFtkYXRlLCBkZXNjcmlwdGlvbl0pID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCogJycne3tzdGFydCBkYXRlIGFuZCBhZ2V8JHtkYXRlfX19OicnJyR7QXJyYXkuaXNBcnJheShkZXNjcmlwdGlvbikgPyBgXFxuJHtkZXNjcmlwdGlvbi5tYXAoKGxpbmUpID0+IGAqKiAke2xpbmV9YCkuam9pbignXFxuJyl9YCA6IGAgJHtkZXNjcmlwdGlvbn1gfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oJ1xcbicpfWBcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAgICAgICAgIGB8IHNraW4tc3VwcG9ydCAgICAgID0ge3tVc2VyOkVlaml0NDMvc2NyaXB0LWRvY3VtZW50YXRpb24vc2tpbi1zdXBwb3J0fCR7T2JqZWN0LmVudHJpZXMoc2NyaXB0Wydza2luLXN1cHBvcnQnXSlcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgoW3NraW4sIHN0YXR1c10pID0+IGAke3NraW59PSR7c3RhdHVzfWApXG4gICAgICAgICAgICAgICAgICAgIC5qb2luKCd8Jyl9fX1gLFxuICAgICAgICAgICAgICAgIHNjcmlwdFsnc291cmNlLW11bHRpcGxlJ10gPyBgfCBzb3VyY2UtbXVsdGlwbGUgICA9ICR7c2NyaXB0Wydzb3VyY2UtbXVsdGlwbGUnXX1gIDogbnVsbCxcbiAgICAgICAgICAgICAgICBgfCByZWxlYXNlZCAgICAgICAgICA9IHt7c3RhcnQgZGF0ZSBhbmQgYWdlfCR7c2NyaXB0LnJlbGVhc2VkfX19YCxcbiAgICAgICAgICAgICAgICBgfCB1cGRhdGVkICAgICAgICAgICA9IHt7c3RhcnQgZGF0ZSBhbmQgYWdlfCR7c2NyaXB0LnVwZGF0ZWR9fX1gLFxuICAgICAgICAgICAgICAgICd9fScsXG4gICAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKTtcblxuICAgICAgICAgICAgbGV0IHNjcmlwdENvbnRlbnQgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAoYWN0aW9uc1RvVGFrZS5pbmNsdWRlcygnc2NyaXB0JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzY3JpcHRDb250ZW50UmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgICAgICAgICAgICAgYGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS8ke3RoaXMucmVwb093bmVyfS8ke3RoaXMucmVwb05hbWV9LyR7dGhpcy5sYXRlc3RDb21taXRIYXNofS9kaXN0LyR7c2NyaXB0Lm5hbWV9LmpzYCxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmIChzY3JpcHRDb250ZW50UmVzcG9uc2Uub2spIHNjcmlwdENvbnRlbnQgPSBhd2FpdCBzY3JpcHRDb250ZW50UmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG13Lm5vdGlmeShcbiAgICAgICAgICAgICAgICAgICAgICAgIGBGYWlsZWQgdG8gZmV0Y2ggXCIke3NjcmlwdC5uYW1lfS5qc1wiIGZyb20gR2l0SHViOiAke3NjcmlwdENvbnRlbnRSZXNwb25zZS5zdGF0dXNUZXh0fSAoJHtzY3JpcHRDb250ZW50UmVzcG9uc2Uuc3RhdHVzfSlgLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyB0eXBlOiAnZXJyb3InLCB0YWc6ICdzeW5jLXNjcmlwdHMtbm90aWZpY2F0aW9uJyB9LFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXNjcmlwdC5wZXJzb25hbCkge1xuICAgICAgICAgICAgICAgIGlmIChhY3Rpb25zVG9UYWtlLmluY2x1ZGVzKCdkb2N1bWVudGF0aW9uJykpXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZWRpdE9yQ3JlYXRlKHN1YnBhZ2VOYW1lLCBmdWxsU3VicGFnZUluZm8uam9pbignXFxuJyksICdTeW5jaW5nIHNjcmlwdCBkb2N1bWVudGF0aW9uIGZyb20gR2l0SHViJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uc1RvVGFrZS5pbmNsdWRlcygndGFsaycpKVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmVkaXRPckNyZWF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhZ2VUYWxrTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICcjUkVESVJFQ1QgW1tVc2VyIHRhbGs6RWVqaXQ0M11dJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdSZWRpcmVjdGluZyBzY3JpcHQgZG9jdW1lbnRhdGlvbiB0YWxrIHBhZ2UgdG8gbWFpbiB1c2VyIHRhbGsgcGFnZScsXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzY3JpcHRDb250ZW50KSBhd2FpdCB0aGlzLmVkaXRPckNyZWF0ZShzY3JpcHROYW1lLCBzY3JpcHRDb250ZW50LCAnU3luY2luZyBzY3JpcHQgZnJvbSBHaXRIdWInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXBzIHNjcmlwdHMgdG8gYSBidWxsZXRlZCBsaXN0LlxuICAgICAgICAgKiBAcGFyYW0gc2NyaXB0cyBUaGUgc2NyaXB0cyB0byBtYXAuXG4gICAgICAgICAqIEByZXR1cm5zIFRoZSBtYXBwZWQgc2NyaXB0cy5cbiAgICAgICAgICovXG4gICAgICAgIHByaXZhdGUgbWFwU2NyaXB0cyhzY3JpcHRzOiBTY3JpcHRbXSkge1xuICAgICAgICAgICAgcmV0dXJuIHNjcmlwdHNcbiAgICAgICAgICAgICAgICAubWFwKFxuICAgICAgICAgICAgICAgICAgICAoc2NyaXB0KSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgYCogW1tVc2VyOkVlaml0NDMvc2NyaXB0cy8ke3NjcmlwdC5uYW1lfSR7c2NyaXB0LnBlcnNvbmFsID8gJy5qcycgOiAnJ318JHtzY3JpcHQubmFtZX1dXSAtICR7c2NyaXB0WydzaG9ydC1kZXNjcmlwdGlvbiddIHx8IHNjcmlwdC5kZXNjcmlwdGlvbn0ke1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdFsnaW4tZGV2ZWxvcG1lbnQnXSA/ICcgKDxzcGFuIHN0eWxlPVwiY29sb3I6ICNiZDI4MjhcIj5pbiBkZXZlbG9wbWVudDwvc3Bhbj4pJyA6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9JHtzY3JpcHRbJ3VzZS1pbnN0ZWFkJ10gPyAnICg8c3BhbiBzdHlsZT1cImNvbG9yOiAjYmQyODI4XCI+ZGVwcmVjYXRlZDwvc3Bhbj4pJyA6ICcnfWAsXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIC5qb2luKCdcXG4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFZGl0cyBhIHBhZ2UsIG9yIGNyZWF0ZXMgaXQgaWYgaXQgZG9lc24ndCBleGlzdC5cbiAgICAgICAgICogQHBhcmFtIHRpdGxlIFRoZSB0aXRsZSBvZiB0aGUgcGFnZSB0byBlZGl0LlxuICAgICAgICAgKiBAcGFyYW0gdGV4dCBUaGUgcGFnZSBjb250ZW50IHRvIHNldC5cbiAgICAgICAgICogQHBhcmFtIHN1bW1hcnkgVGhlIGVkaXQgc3VtbWFyeSAod2lsbCBhcHBlbmQgc2NyaXB0IG5vdGljZSkuXG4gICAgICAgICAqL1xuICAgICAgICBwcml2YXRlIGFzeW5jIGVkaXRPckNyZWF0ZSh0aXRsZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcsIHN1bW1hcnk6IHN0cmluZykge1xuICAgICAgICAgICAgc3VtbWFyeSArPSB0aGlzLnNjcmlwdE1lc3NhZ2U7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBpXG4gICAgICAgICAgICAgICAgLmVkaXQodGl0bGUsICgpID0+ICh7IHRleHQsIHN1bW1hcnksIHdhdGNobGlzdDogJ3dhdGNoJyB9KSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goYXN5bmMgKGVycm9yQ29kZSwgZXJyb3JJbmZvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvckNvZGUgPT09ICdub2NyZWF0ZS1taXNzaW5nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBpLmNyZWF0ZSh0aXRsZSwgeyBzdW1tYXJ5LCB3YXRjaGxpc3Q6ICd3YXRjaCcgfSwgdGV4dCkuY2F0Y2goKGVycm9yQ29kZSwgZXJyb3JJbmZvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgRXJyb3IgY3JlYXRpbmcgJHt0aXRsZX06ICR7KGVycm9ySW5mbyBhcyBNZWRpYVdpa2lEYXRhRXJyb3IpPy5lcnJvcj8uaW5mbyA/PyAnVW5rbm93biBlcnJvcid9ICgke2Vycm9yQ29kZX0pYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0eXBlOiAnZXJyb3InIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yIGVkaXRpbmcgb3IgY3JlYXRpbmcgJHt0aXRsZX06ICR7KGVycm9ySW5mbyBhcyBNZWRpYVdpa2lEYXRhRXJyb3IpPy5lcnJvcj8uaW5mbyA/PyAnVW5rbm93biBlcnJvcid9ICgke2Vycm9yQ29kZX0pYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHR5cGU6ICdlcnJvcicgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPcGVucyBhIGRpZmYgZm9yIHRoZSBnaXZlbiBwYWdlIHRpdGxlIGFuZCBjb250ZW50LlxuICAgICAgICAgKiBAcGFyYW0gcGFnZVRpdGxlIFRoZSB0aXRsZSBvZiB0aGUgcGFnZSB0byBvcGVuIGEgZGlmZiBmb3IuXG4gICAgICAgICAqIEBwYXJhbSBjb250ZW50IFRoZSBjb250ZW50IHRvIHNldCBmb3IgdGhlIHBhZ2UuXG4gICAgICAgICAqL1xuICAgICAgICBwcml2YXRlIG9wZW5EaWZmKHBhZ2VUaXRsZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0ge1xuICAgICAgICAgICAgICAgIHdwVGV4dGJveDE6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgd3BTdW1tYXJ5OiBgVXBkYXRpbmcgZGF0YSR7dGhpcy5zY3JpcHRNZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgd3BEaWZmOiAnMScsIC8vIEFueSB0cnV0aHkgdmFsdWUgbWFrZXMgdGhpcyB3b3JrXG4gICAgICAgICAgICAgICAgd3BVbHRpbWF0ZVBhcmFtOiAnMScsIC8vIE1hcmtzIHRoZSBlbmQgb2YgZm9ybSBkYXRhXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBmb3JtVXJsID0gbmV3IFVSTChgJHttdy5jb25maWcuZ2V0KCd3Z1NjcmlwdFBhdGgnKX0vaW5kZXgucGhwYCwgd2luZG93LmxvY2F0aW9uLm9yaWdpbik7XG4gICAgICAgICAgICBmb3JtVXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3RpdGxlJywgcGFnZVRpdGxlKTtcbiAgICAgICAgICAgIGZvcm1Vcmwuc2VhcmNoUGFyYW1zLnNldCgnYWN0aW9uJywgJ3N1Ym1pdCcpO1xuXG4gICAgICAgICAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpO1xuICAgICAgICAgICAgZm9ybS5hY3Rpb24gPSBmb3JtVXJsLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBmb3JtLm1ldGhvZCA9ICdQT1NUJztcbiAgICAgICAgICAgIGZvcm0udGFyZ2V0ID0gJ19ibGFuayc7XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGZvcm1EYXRhKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhpZGRlbkZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgICAgICAgICBoaWRkZW5GaWVsZC50eXBlID0gJ2hpZGRlbic7XG4gICAgICAgICAgICAgICAgaGlkZGVuRmllbGQubmFtZSA9IGtleTtcbiAgICAgICAgICAgICAgICBoaWRkZW5GaWVsZC52YWx1ZSA9IHZhbHVlO1xuXG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmQoaGlkZGVuRmllbGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZChmb3JtKTtcbiAgICAgICAgICAgIGZvcm0uc3VibWl0KCk7XG4gICAgICAgICAgICBmb3JtLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgT2JqZWN0LmFzc2lnbihTY3JpcHRVcGRhdGVyRGlhbG9nLnByb3RvdHlwZSwgT08udWkuUHJvY2Vzc0RpYWxvZy5wcm90b3R5cGUpO1xuXG4gICAgLyoqXG4gICAgICogT3BlbnMgYSBkaWZmIGNvbnRhaW5pbmcgdGhlIHVwZGF0ZXMgdG8gcmVkaXJlY3QtaGVscGVyLmpzb24uXG4gICAgICovXG4gICAgYXN5bmMgZnVuY3Rpb24gZ2V0UmVkaXJlY3RIZWxwZXJEYXRhKCkge1xuICAgICAgICBjb25zdCBhcGkgPSBuZXcgbXcuQXBpKCk7XG5cbiAgICAgICAgY29uc3QgYWxsUmVkaXJlY3RUZW1wbGF0ZXMgPSAoYXdhaXQgYXBpLmdldCh7XG4gICAgICAgICAgICBhY3Rpb246ICdxdWVyeScsXG4gICAgICAgICAgICBsaXN0OiAnY2F0ZWdvcnltZW1iZXJzJyxcbiAgICAgICAgICAgIGNtdGl0bGU6ICdDYXRlZ29yeTpSZWRpcmVjdCB0ZW1wbGF0ZXMnLFxuICAgICAgICAgICAgY21saW1pdDogJ21heCcsXG4gICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAnMicsXG4gICAgICAgIH0gc2F0aXNmaWVzIEFwaVF1ZXJ5Q2F0ZWdvcnlNZW1iZXJzUGFyYW1zKSkgYXMgQ2F0ZWdvcnlNZW1iZXJzUmVzdWx0O1xuICAgICAgICBjb25zdCBhbGxQb3NzaWJsZVRlbXBsYXRlcyA9IChhd2FpdCBhcGkuZ2V0KHtcbiAgICAgICAgICAgIGFjdGlvbjogJ3F1ZXJ5JyxcbiAgICAgICAgICAgIGxpc3Q6ICdjYXRlZ29yeW1lbWJlcnMnLFxuICAgICAgICAgICAgY210aXRsZTogJ0NhdGVnb3J5OlRlbXBsYXRlIHJlZGlyZWN0cyB3aXRoIHBvc3NpYmlsaXRpZXMnLFxuICAgICAgICAgICAgY21saW1pdDogJ21heCcsXG4gICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAnMicsXG4gICAgICAgIH0gc2F0aXNmaWVzIEFwaVF1ZXJ5Q2F0ZWdvcnlNZW1iZXJzUGFyYW1zKSkgYXMgQ2F0ZWdvcnlNZW1iZXJzUmVzdWx0O1xuXG4gICAgICAgIGNvbnN0IHJlZGlyZWN0VGVtcGxhdGVzID0gYWxsUmVkaXJlY3RUZW1wbGF0ZXMucXVlcnkuY2F0ZWdvcnltZW1iZXJzXG4gICAgICAgICAgICAuZmlsdGVyKChwYWdlKSA9PiBwYWdlLnRpdGxlLnN0YXJ0c1dpdGgoJ1RlbXBsYXRlOlIgJykgJiYgcGFnZS50aXRsZSAhPT0gJ1RlbXBsYXRlOlIgdGVtcGxhdGUgaW5kZXgnKVxuICAgICAgICAgICAgLm1hcCgocGFnZSkgPT4gKHsgbmFtZTogcGFnZS50aXRsZS5zcGxpdCgnOicpWzFdLCByZWRpcmVjdDogZmFsc2UgfSkpO1xuICAgICAgICBjb25zdCBwb3NzaWJsZVJlZGlyZWN0VGVtcGxhdGVzID0gYWxsUG9zc2libGVUZW1wbGF0ZXMucXVlcnkuY2F0ZWdvcnltZW1iZXJzXG4gICAgICAgICAgICAuZmlsdGVyKChwYWdlKSA9PiBwYWdlLnRpdGxlLnN0YXJ0c1dpdGgoJ1RlbXBsYXRlOlIgJykgJiYgcGFnZS50aXRsZSAhPT0gJ1RlbXBsYXRlOlIgd2l0aCBwb3NzaWJpbGl0aWVzJylcbiAgICAgICAgICAgIC5tYXAoKHBhZ2UpID0+ICh7IG5hbWU6IHBhZ2UudGl0bGUuc3BsaXQoJzonKVsxXSwgcmVkaXJlY3Q6IHRydWUgfSkpO1xuXG4gICAgICAgIGNvbnN0IGFsbEFsaWFzZXNPZlJlZGlyZWN0czogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBjb25zdCBtYXBwZWREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBbLi4ucmVkaXJlY3RUZW1wbGF0ZXMsIC4uLnBvc3NpYmxlUmVkaXJlY3RUZW1wbGF0ZXNdXG4gICAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yY2UgY29taWNzIGFuZCBNaWRkbGUgRWFydGggdGVtcGxhdGVzIHRvIHRoZSBlbmQgb2YgdGhlIGxpc3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEubmFtZS5zdGFydHNXaXRoKCdSIGNvbWljcycpIHx8IGEubmFtZS5zdGFydHNXaXRoKCdSIE1FJykpIHJldHVybiAxO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChiLm5hbWUuc3RhcnRzV2l0aCgnUiBjb21pY3MnKSB8fCBiLm5hbWUuc3RhcnRzV2l0aCgnUiBNRScpKSByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKGFzeW5jIChwYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlRGF0YVF1ZXJ5ID0gKGF3YWl0IGFwaS5nZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAndGVtcGxhdGVkYXRhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlczogJ1RlbXBsYXRlOicgKyBwYWdlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAnMicsXG4gICAgICAgICAgICAgICAgICAgIH0gc2F0aXNmaWVzIFRlbXBsYXRlRGF0YUFwaVRlbXBsYXRlRGF0YVBhcmFtcykpIGFzIFRlbXBsYXRlRGF0YVJlc3VsdDtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbWV0ZXJzID0gT2JqZWN0LnZhbHVlcyh0ZW1wbGF0ZURhdGFRdWVyeS5wYWdlcylbMF0/LnBhcmFtcyB8fCB7fTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5uZWNlc3NhcnktY29uZGl0aW9uXG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkUGFyYW1ldGVycyA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHBhcmFtZXRlcnMpLm1hcCgoW25hbWUsIGRhdGFdKSA9PiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWFzZXM6IGRhdGEuYWxpYXNlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGRhdGEubGFiZWw/LmVuID8/IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uPy5lbiA/PyBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBkYXRhLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBkYXRhLnJlcXVpcmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWdnZXN0ZWQ6IGRhdGEuc3VnZ2VzdGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBkYXRhLmRlZmF1bHQ/LmVuID8/IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4YW1wbGU6IGRhdGEuZXhhbXBsZT8uZW4gPz8gbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXSksXG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hcHBlZFJlZGlyZWN0cztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2UucmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmtzUXVlcnkgPSAoYXdhaXQgYXBpLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlczogJ1RlbXBsYXRlOicgKyBwYWdlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogJ2xpbmtzaGVyZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGhuYW1lc3BhY2U6IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxobGltaXQ6ICdtYXgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHZlcnNpb246ICcyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gc2F0aXNmaWVzIEFwaVF1ZXJ5QmFja2xpbmtzcHJvcFBhcmFtcykpIGFzIExpbmtzSGVyZVJlc3VsdDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkUmVkaXJlY3RzID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rc1F1ZXJ5LnF1ZXJ5LnBhZ2VzWzBdLmxpbmtzaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/LmZpbHRlcigocGFnZSkgPT4gcGFnZS5yZWRpcmVjdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgocGFnZSkgPT4gcGFnZS50aXRsZS5zcGxpdCgnOicpWzFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBhZ2UpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIVsuLi5yZWRpcmVjdFRlbXBsYXRlcywgLi4ucG9zc2libGVSZWRpcmVjdFRlbXBsYXRlc10uc29tZSgodGVtcGxhdGUpID0+IHRlbXBsYXRlLm5hbWUgPT09IHBhZ2UpICYmIC8vIFRPRE86IHdvbid0IGNhdGNoIGlmIHRlbXBsYXRlIGlzIGFkZGVkIGFmdGVyLCB0aGlzIGNoZWNrIHNob3VsZCBiZSBkb25lIGxhc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhcGFnZS5lbmRzV2l0aCgnL2RvYycpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXBhZ2UuZW5kc1dpdGgoJy9zYW5kYm94JyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEubG9jYWxlQ29tcGFyZShiKSkgPz8gW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbEFsaWFzZXNPZlJlZGlyZWN0cy5wdXNoKC4uLm1hcHBlZFJlZGlyZWN0cyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWRpcmVjdHNRdWVyeSA9IChhd2FpdCBhcGkuZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdxdWVyeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVzOiAnVGVtcGxhdGU6JyArIHBhZ2UubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wOiAncmVkaXJlY3RzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZGxpbWl0OiAnbWF4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAnMicsXG4gICAgICAgICAgICAgICAgICAgICAgICB9IHNhdGlzZmllcyBBcGlRdWVyeUJhY2tsaW5rc3Byb3BQYXJhbXMpKSBhcyBSZWRpcmVjdHNSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFJlZGlyZWN0cyA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3RzUXVlcnkucXVlcnkucGFnZXNbMF0ucmVkaXJlY3RzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8uZmlsdGVyKChyZWRpcmVjdCkgPT4gcmVkaXJlY3QubnMgPT09IDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKChyZWRpcmVjdCkgPT4gcmVkaXJlY3QudGl0bGUuc3BsaXQoJzonKVsxXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigocmVkaXJlY3QpID0+ICFwb3NzaWJsZVJlZGlyZWN0VGVtcGxhdGVzLnNvbWUoKHRlbXBsYXRlKSA9PiB0ZW1wbGF0ZS5uYW1lID09PSByZWRpcmVjdCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLmxvY2FsZUNvbXBhcmUoYikpID8/IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcGxhdGVEYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uKHBhZ2UucmVkaXJlY3QgPyB7IHJlZGlyZWN0OiB0cnVlIH0gOiB7fSksXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzOiBmb3JtYXR0ZWRQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxpYXNlczogbWFwcGVkUmVkaXJlY3RzLFxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbcGFnZS5uYW1lLCB0ZW1wbGF0ZURhdGFdIGFzIGNvbnN0O1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIGZvciAoY29uc3QgYWxpYXMgb2YgYWxsQWxpYXNlc09mUmVkaXJlY3RzKVxuICAgICAgICAgICAgZm9yIChjb25zdCBbLCBkYXRhXSBvZiBtYXBwZWREYXRhKVxuICAgICAgICAgICAgICAgIGlmICghZGF0YS5yZWRpcmVjdCAmJiBkYXRhLmFsaWFzZXMuaW5jbHVkZXMoYWxpYXMpKSBkYXRhLmFsaWFzZXMgPSBkYXRhLmFsaWFzZXMuZmlsdGVyKChhKSA9PiBhICE9PSBhbGlhcyk7XG5cbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KE9iamVjdC5mcm9tRW50cmllcyhtYXBwZWREYXRhKSk7XG4gICAgfVxufSk7XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7bUJBMkJBLEdBQUcsT0FBTyxNQUFNLENBQUMsaUJBQWtCLGVBQWdCLGtCQUFtQixpQkFBaUIsRUFBRyxJQUFNLENBQzVGLEdBQUksR0FBRyxPQUFPLElBQUksWUFBWSxJQUFNLFdBQWEsR0FBRyxPQUFPLElBQUksWUFBWSxJQUFNLGVBQWdCLE9BRWpHLElBQU1BLEVBQWtCLFNBQVMsY0FBYyxpQkFBaUIsRUFBRyxVQUFVLEVBQUksRUFFM0VDLEVBQU8sU0FBUyxjQUFjLEdBQUcsRUFDdkNBLEVBQUssS0FBTyxJQUNaQSxFQUFLLE1BQU0sV0FBYSxPQUN4QkEsRUFBSyxZQUFjLG1CQUNuQkEsRUFBSyxpQkFBaUIsUUFBVUMsR0FBVSxDQUN0Q0EsRUFBTSxlQUFlLEVBRXJCLElBQU1DLEVBQWdCLElBQUksR0FBRyxHQUFHLGNBQ2hDLFNBQVMsS0FBSyxPQUFPQSxFQUFjLFNBQVMsQ0FBQyxDQUFDLEVBRTlDLElBQU1DLEVBQXNCLElBQUlDLEVBQ2hDRixFQUFjLFdBQVcsQ0FBQ0MsQ0FBbUIsQ0FBQyxFQUU5Q0EsRUFBb0IsS0FBSyxDQUM3QixDQUFDLEVBRURKLEVBQWdCLGNBQWMsR0FBRyxFQUFHLFlBQVlDLENBQUksRUFFcEQsU0FBUyxjQUFjLHNDQUFzQyxFQUFHLE1BQU1ELENBQWUsRUFLckYsTUFBTUssVUFBNEIsR0FBRyxHQUFHLGFBQWMs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QUMxQyxXQUFZUSxFQUNaLFFBQVNDLENBQ2IsRUFFQSxNQUFPLENBQUNULEVBQUssS0FBTVksQ0FBWSxDQUNuQyxDQUFDLENBQ1QsRUFFQSxRQUFXQyxLQUFTWCxFQUNoQixPQUFXLENBQUMsQ0FBRTVDLENBQUksSUFBSzZDLEVBQ2YsQ0FBQzdDLEVBQUssVUFBWUEsRUFBSyxRQUFRLFNBQVN1RCxDQUFLLElBQUd2RCxFQUFLLFFBQVVBLEVBQUssUUFBUSxPQUFROEMsR0FBTUEsSUFBTVMsQ0FBSyxHQUVqSCxPQUFPLEtBQUssVUFBVSxPQUFPLFlBQVlWLENBQVUsQ0FBQyxDQUN4RCxDQUNKLENBQUMiLAogICJuYW1lcyI6IFsiZnVsbExpbmtFbGVtZW50IiwgImxpbmsiLCAiZXZlbnQiLCAid2luZG93TWFuYWdlciIsICJzY3JpcHRVcGRhdGVyRGlhbG9nIiwgIlNjcmlwdFVwZGF0ZXJEaWFsb2ciLCAiZ2V0UmVkaXJlY3RIZWxwZXJEYXRhIiwgImVycm9yIiwgIm1lc3NhZ2VFbGVtZW50IiwgInNjcmlwdCIsICJzY3JpcHRzTXVsdGlzZWxlY3RMYXlvdXQiLCAiaWQiLCAibmFtZSIsICJzZWxlY3RlZERlZmF1bHQiLCAiYWN0aW9uc011bHRpc2VsZWN0TGF5b3V0IiwgImJ1dHRvbkdyb3VwIiwgInVwZGF0ZXIiLCAiYnV0dG9uIiwgImRhdGEiLCAicmVzb2x2ZSIsICJzY3JpcHREYXRhVXBkYXRlcnNNdWx0aXNlbGVjdExheW91dCIsICJhY3Rpb24iLCAic2VsZWN0ZWRTY3JpcHRzIiwgInNjcmlwdE5hbWUiLCAibWV0aG9kIiwgImRlZmVycmVkIiwgInJlc3VsdCIsICJsYXRlc3RDb21taXRIYXNoUmVzcG9uc2UiLCAic2NyaXB0RGF0YVJlc3BvbnNlIiwgInNjcmlwdERhdGEiLCAiYWN0aW9uc1RvVGFrZSIsICJzdWJwYWdlTmFtZSIsICJzdWJwYWdlVGFsa05hbWUiLCAiZnVsbFN1YnBhZ2VJbmZvIiwgImF1dGhvciIsICJkYXRlIiwgImRlc2NyaXB0aW9uIiwgImxpbmUiLCAic2tpbiIsICJzdGF0dXMiLCAic2NyaXB0Q29udGVudCIsICJzY3JpcHRDb250ZW50UmVzcG9uc2UiLCAic2NyaXB0cyIsICJ0aXRsZSIsICJ0ZXh0IiwgInN1bW1hcnkiLCAiZXJyb3JDb2RlIiwgImVycm9ySW5mbyIsICJwYWdlVGl0bGUiLCAiY29udGVudCIsICJmb3JtRGF0YSIsICJmb3JtVXJsIiwgImZvcm0iLCAia2V5IiwgInZhbHVlIiwgImhpZGRlbkZpZWxkIiwgImFwaSIsICJhbGxSZWRpcmVjdFRlbXBsYXRlcyIsICJhbGxQb3NzaWJsZVRlbXBsYXRlcyIsICJyZWRpcmVjdFRlbXBsYXRlcyIsICJwYWdlIiwgInBvc3NpYmxlUmVkaXJlY3RUZW1wbGF0ZXMiLCAiYWxsQWxpYXNlc09mUmVkaXJlY3RzIiwgIm1hcHBlZERhdGEiLCAiYSIsICJiIiwgInRlbXBsYXRlRGF0YVF1ZXJ5IiwgInBhcmFtZXRlcnMiLCAiZm9ybWF0dGVkUGFyYW1ldGVycyIsICJtYXBwZWRSZWRpcmVjdHMiLCAidGVtcGxhdGUiLCAicmVkaXJlY3QiLCAidGVtcGxhdGVEYXRhIiwgImFsaWFzIl0KfQo=
