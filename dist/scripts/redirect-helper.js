"use strict";mw.loader.using(["mediawiki.util","oojs-ui-core","oojs-ui-widgets","oojs-ui-windows","oojs-ui.styles.icons-content","oojs-ui.styles.icons-editing-core"],()=>{class p extends OO.ui.TextInputWidget{constructor(e,t){super(e),OO.ui.mixin.LookupElement.call(this,e),this.pageTitleParsed=t}getLookupRequest(){const e=this.getValue(),t=$.Deferred();if(!e)t.resolve([]);else if(e.includes("#")){const i=e.split("#")[0];new mw.Api().get({action:"parse",page:i,prop:"sections",redirects:"1"}).catch(()=>null).then(a=>{if(a){const s=a.parse.sections.filter(r=>r.line.toLowerCase().startsWith(e.split("#")[1].toLowerCase()));t.resolve(s.map(r=>({data:`${a.parse.title}#${r.line}`,label:`${a.parse.title}#${r.line}`})))}else t.resolve([])})}else{const i=mw.Title.newFromText(e);new mw.Api().get({action:"query",formatversion:2,gaplimit:20,gapnamespace:i?.getNamespaceId()??0,gapprefix:i?.getMainText()??e,generator:"allpages",prop:"info|pageprops"}).catch(()=>null).then(a=>{a?t.resolve(a.query?.pages?a.query.pages.filter(s=>s.title!==this.pageTitleParsed.toString()).map(s=>({data:s.title,label:new OO.ui.HtmlSnippet(`${s.title}${s.pageprops&&"disambiguation"in s.pageprops?" <i>(disambiguation)</i>":""}${"redirect"in s?" <i>(redirect)</i>":""}`)})):[]):t.resolve([])})}return t.promise({abort(){}})}getLookupCacheDataFromResponse(e){return e??[]}getLookupMenuOptionsFromData(e){e.map(({data:t,label:i})=>new OO.ui.MenuOptionWidget({data:t,label:i}))}}Object.assign(p.prototype,OO.ui.mixin.LookupElement.prototype);class l extends OO.ui.ProcessDialog{constructor(e,t){super(e),this.pageTitleParsed=t,l.static.name="TemplatePreviewDialog",l.static.title="Redirect categorization templates preview",l.static.actions=[{action:"cancel",label:"Close",flags:["safe","close"]}]}getSetupProcess(){return l.super.prototype.getSetupProcess.call(this).next(()=>{const e={action:"parse",formatversion:"2",contentmodel:"wikitext",title:this.pageTitleParsed.getPrefixedDb(),text:`{{Redirect category shell|${this.getData().map(t=>`{{${t}}}`).join("")}}}`};return new mw.Api().post(e).then(t=>{const i=t.parse.text,a=new OO.ui.PanelLayout({padded:!0,expanded:!1});a.$element.append(i),this.$body.append(a.$element)})})}getActionProcess(e){return e?new OO.ui.Process(()=>{this.getManager().closeWindow(this)}):l.super.prototype.getActionProcess.call(this,e)}}Object.assign(l.prototype,OO.ui.ProcessDialog.prototype),l.prototype.getTeardownProcess=function(){return l.super.prototype.getTeardownProcess.call(this).next(()=>{this.$body.empty()})};class d{async run(){if(this.passesPreChecks()){if(this.redirectTemplates=await this.fetchRedirectTemplates(),this.contentText=document.querySelector("#mw-content-text"),!this.contentText)return mw.notify("redirect-helper: Failed to find content text element!",{type:"error"});if(this.pageTitle=mw.config.get("wgPageName"),this.pageTitleParsed=mw.Title.newFromText(this.pageTitle),!this.pageTitleParsed)return mw.notify("redirect-helper: Failed to parse page title!",{type:"error"});await this.checkPageAndLoad()}}passesPreChecks(){return[mw.config.get("wgNamespaceNumber")>=0,mw.config.get("wgIsProbablyEditable"),mw.config.get("wgIsArticle"),mw.config.get("wgAction")==="view",mw.config.get("wgRevisionId")===mw.config.get("wgCurRevisionId"),!mw.config.get("wgDiffOldId")].every(Boolean)}async fetchRedirectTemplates(){return JSON.parse((await new mw.Api().get({action:"query",formatversion:2,prop:"revisions",rvprop:"content",rvslots:"*",titles:"User:Eejit43/scripts/redirect-helper.json"})).query.pages?.[0]?.revisions?.[0]?.slots?.main?.content||"{}")}async checkPageAndLoad(){const e=await new mw.Api().get({action:"query",formatversion:2,prop:"info",titles:this.pageTitle}),t={redirectTemplates:this.redirectTemplates,contentText:this.contentText,pageTitle:this.pageTitle,pageTitleParsed:this.pageTitleParsed};if(e.query.pages[0].missing){const i=new OO.ui.ButtonWidget({label:"Create redirect",icon:"articleRedirect",flags:["progressive"]});i.$element[0].style.marginBottom="20px",i.on("click",()=>{i.$element[0].remove(),new u(t,!1).load()}),this.contentText.prepend(i.$element[0])}else if(e.query.pages[0].redirect)new u(t,!0).load();else{const i=mw.util.addPortletLink(mw.config.get("skin")==="minerva"?"p-tb":"p-cactions","#","Redirect page","redirect-helper");i.addEventListener("click",a=>{a.preventDefault(),new u(t,!1).load(),window.scrollTo({top:0,behavior:"smooth"}),i.remove()})}}}class u{constructor({redirectTemplates:e,contentText:t,pageTitle:i,pageTitleParsed:a},s){this.needsCheck=!0;this.redirectTemplates=e,this.contentText=t,this.pageTitle=i,this.pageTitleParsed=a,this.exists=s}async load(){this.editorBox=new OO.ui.PanelLayout({padded:!0,expanded:!1,framed:!0}),this.editorBox.$element[0].style.backgroundColor="#95d4bc",this.editorBox.$element[0].style.width="700px",this.editorBox.$element[0].style.maxWidth="calc(100% - 50px)",this.editorBox.$element[0].style.marginLeft="auto",this.editorBox.$element[0].style.marginRight="auto",this.editorBox.$element[0].style.marginBottom="20px",this.pageTitleParsed.isTalkPage()&&(await new mw.Api().get({action:"query",formatversion:2,prop:"info",titles:this.pageTitleParsed.getSubjectPage().getPrefixedText()})).query.pages[0].redirect&&this.loadSyncWithMainButton(),this.loadInputElements(),await this.loadSubmitElements(),this.editorBox.$element[0].append(...[this.syncWithMainButton?.$element?.[0],this.redirectInputLayout.$element[0],this.tagSelectLayout.$element[0],this.summaryInputLayout.$element[0],this.submitLayout.$element[0]].filter(Boolean)),this.contentText.prepend(this.editorBox.$element[0]),this.exists&&this.loadExistingData()}async loadSyncWithMainButton(){const e=(await new mw.Api().get({action:"query",formatversion:2,prop:"revisions",rvprop:"content",rvslots:"*",titles:this.pageTitleParsed.getSubjectPage().getPrefixedText()})).query.pages[0].revisions[0].slots.main.content.trim();this.syncWithMainButton=new OO.ui.ButtonWidget({label:"Sync with main page",icon:"link",flags:["progressive"]}),this.syncWithMainButton.on("click",()=>{const t=/^#redirect:?\s*\[\[\s*([^[\]{|}]+?)\s*(?:\|[^[\]{|}]+?)?]]\s*/i.exec(e)?.[1];if(!t)return mw.notify("Failed to parse main page content!",{type:"error"});this.redirectInput.setValue(mw.Title.newFromText(t)?.getTalkPage()?.toString()??""),["R from move",...this.redirectTemplates["R from move"]].some(a=>new RegExp(`{{\\s*[${a[0].toLowerCase()}${a[0]}]${a.slice(1)}\\s*(\\||}})`).test(e))&&this.tagSelect.setValue(["R from move"])})}loadInputElements(){this.redirectInput=new p({placeholder:"Target page name",required:!0},this.pageTitleParsed),this.redirectInput.on("change",()=>{let e=this.redirectInput.getValue();e=e.replace(new RegExp(`^(https?:)?/{2}?${mw.config.get("wgServer").replace(/^\/{2}/,"")}/wiki/`),""),e=e.replace(/^:/,""),e.length>0?(this.redirectInput.setValue(e[0].toUpperCase()+e.slice(1).replaceAll("_"," ")),this.submitButton.setDisabled(!1)):this.submitButton.setDisabled(!0),this.updateSummary(),this.submitButton.setLabel("Submit"),this.needsCheck=!0}),this.redirectInputLayout=new OO.ui.FieldLayout(this.redirectInput,{label:new OO.ui.HtmlSnippet("<b>Redirect target:</b>"),align:"top"}),this.tagSelect=new OO.ui.MenuTagMultiselectWidget({allowArbitrary:!1,allowReordering:!1,options:Object.keys(this.redirectTemplates).map(e=>({data:e,label:e}))}),this.tagSelect.getMenu().filterMode="substring",this.tagSelect.on("change",()=>{const e=this.tagSelect.getValue().sort((t,i)=>t.toLowerCase().localeCompare(i.toLowerCase()));this.tagSelect.getValue().join(";")!==e.join(";")&&this.tagSelect.setValue(e),this.updateSummary(),this.submitButton.setLabel("Submit"),this.needsCheck=!0,this.tagSelect.getValue().length>0?this.previewButton.setDisabled(!1):this.previewButton.setDisabled(!0)}),this.tagSelectLayout=new OO.ui.FieldLayout(this.tagSelect,{label:new OO.ui.HtmlSnippet("<b>Redirect categorization template(s):</b>"),align:"top"}),this.summaryInput=new OO.ui.ComboBoxInputWidget({options:[{data:"Resolve double redirect"},{data:"Resolve self redirect"},{data:"Remove incorrect rcats"}]}),this.summaryInputLayout=new OO.ui.FieldLayout(this.summaryInput,{label:new OO.ui.HtmlSnippet("<b>Summary:</b>"),align:"top"})}async loadSubmitElements(){this.submitButton=new OO.ui.ButtonWidget({label:"Submit",disabled:!0,flags:["progressive"]}),this.submitButton.$element[0].style.marginBottom="0",this.submitButton.on("click",()=>this.handleSubmitButtonClick());const e=new OO.ui.WindowManager;document.body.append(e.$element[0]);const t=new l({size:"large"},this.pageTitleParsed);e.addWindows([t]),this.previewButton=new OO.ui.ButtonWidget({label:"Preview templates",disabled:!0}),this.previewButton.$element[0].style.marginBottom="0",this.previewButton.on("click",()=>{t.setData(this.tagSelect.getValue()),t.open()}),this.pageTitleParsed.isTalkPage()||(this.talkData=await new mw.Api().get({action:"query",formatversion:2,prop:"info",titles:this.pageTitleParsed.getTalkPage().getPrefixedText()}),this.syncTalkCheckbox=new OO.ui.CheckboxInputWidget({selected:!!this.talkData.query.pages[0].redirect}),this.syncTalkCheckboxLayout=new OO.ui.Widget({content:[new OO.ui.FieldLayout(this.syncTalkCheckbox,{label:"Sync talk page",align:"inline"})]}),this.syncTalkCheckboxLayout.$element[0].style.marginBottom="0"),await this.checkShouldPromptPatrol()&&(this.patrolCheckbox=new OO.ui.CheckboxInputWidget({selected:!0}),this.patrolCheckboxLayout=new OO.ui.Widget({content:[new OO.ui.FieldLayout(this.patrolCheckbox,{label:"Mark as patrolled",align:"inline"})]}),this.patrolCheckboxLayout.$element[0].style.marginBottom="0"),this.submitLayout=new OO.ui.HorizontalLayout({items:[this.submitButton,this.previewButton,this.syncTalkCheckboxLayout,this.patrolCheckboxLayout].filter(Boolean)}),this.submitLayout.$element[0].style.marginTop="10px"}async checkShouldPromptPatrol(){const e=document.querySelector("#mwe-pt-mark .mwe-pt-tool-icon");if(e?.click(),e?.click(),mw.config.get("wgNamespaceNumber")!==0)return!1;if(document.querySelector(".patrollink"))return!0;if(document.querySelector("#mwe-pt-mark-as-reviewed-button"))return!0;if(document.querySelector("#mwe-pt-mark-as-unreviewed-button"))return!1;{if(!mw.config.get("wgArticleId")||!(await new mw.Api().get({action:"query",meta:"userinfo",uiprop:"rights"})).query.userinfo.rights.includes("patrol"))return!1;const i=await new mw.Api().get({action:"pagetriagelist",page_id:mw.config.get("wgArticleId")});return i.pagetriagelist.pages[0]?.user_name===mw.config.get("wgUserName")||i.pagetriagelist.result!=="success"||i.pagetriagelist.pages.length===0?!1:!Number.parseInt(i.pagetriagelist.pages[0]?.patrol_status)}}updateSummary(){const e=this.redirectInput.getValue().trim();if(!e)this.summaryInput.$tabIndexed[0].placeholder="";else if(this.exists){const t=e!==this.oldRedirectTarget?.replaceAll("_"," "),i=this.tagSelect.getValue().join(";")!==this.oldRedirectTags?.join(";");t&&i?this.summaryInput.$tabIndexed[0].placeholder=`Retarget redirect to [[${e}]] and change categorization templates`:t?this.summaryInput.$tabIndexed[0].placeholder=`Retarget redirect to [[${e}]]`:i?this.summaryInput.$tabIndexed[0].placeholder="Change categorization templates":this.summaryInput.$tabIndexed[0].placeholder="Perform redirect cleanup"}else this.summaryInput.$tabIndexed[0].placeholder=`Create redirect to [[${e}]]`}async loadExistingData(){const e=(await new mw.Api().get({action:"query",formatversion:2,prop:"revisions",rvprop:"content",rvslots:"*",titles:this.pageTitle})).query.pages[0].revisions[0].slots.main.content.trim();this.oldRedirectTarget=/^#redirect:?\s*\[\[\s*([^[\]{|}]+?)\s*(?:\|[^[\]{|}]+?)?]]\s*/i.exec(e)?.[1],this.oldRedirectTags=Object.entries(this.redirectTemplates).map(([i,a])=>[i,...a].some(s=>new RegExp(`{{\\s*[${s[0].toLowerCase()}${s[0]}]${s.slice(1)}\\s*(\\||}})`).test(e))?i:null).filter(Boolean).sort((i,a)=>i.toLowerCase().localeCompare(a.toLowerCase()));const t=Object.entries(this.redirectTemplates).flatMap(([i,a])=>[i,...a]).map(i=>new RegExp(`{{\\s*[${i[0].toLowerCase()}${i[0]}]${i.slice(1)}\\s*(\\||}})`).test(e)?i:null).filter(Boolean);this.oldRedirectTagData=Object.fromEntries(t.map(i=>{const a=new RegExp(`{{\\s*[${i[0].toLowerCase()}${i[0]}]${i.slice(1)}\\|?(.*?)\\s*}}`).exec(e),s=Object.entries(this.redirectTemplates).find(([r,o])=>[r,...o].includes(i))?.[0];return a?[s,a[1]]:null}).filter(Boolean)),this.oldStrayText=[e.match(/{{short description\|.*?}}/i)?.[0],e.match(/{{DISPLAYTITLE:.*?}}/)?.[0],e.match(/{{italic title\|?.*?}}/i)?.[0],e.match(/{{DEFAULTSORT:.*?}}/)?.[0],e.match(/{{title language\|.*?}}/)?.[0],...e.match(/\[\[[Cc]ategory:.+?]]/g)??[]].filter(Boolean).join(`
`),this.oldRedirectTarget?this.redirectInput.setValue(this.oldRedirectTarget.replaceAll("_"," ")):mw.notify("Could not find redirect target!",{type:"error"}),this.tagSelect.setValue(this.oldRedirectTags),this.updateSummary()}async validateSubmission(){const e=[],t=this.redirectInput.getValue().trim();/^\s*[^[\]{|}]+\s*$/.test(t)||e.push({title:t,message:"is not a valid page title!"});try{this.parsedDestination=mw.Title.newFromText(t)}catch{e.length===0&&e.push({title:t,message:"is not a valid page title!"})}!this.parsedDestination&&e.length===0&&e.push({title:t,message:"is not a valid page title!"}),this.parsedDestination?.toString()===this.pageTitleParsed.toString()&&e.push({message:"cannot redirect to itself!"});const i=await new mw.Api().get({action:"query",formatversion:2,prop:"pageprops",titles:t}).catch(s=>(s==="missingtitle"?e.push({title:t,message:"does not exist!"}):e.push({title:t,message:`was not able to be fetched from the API (${s})!`}),null)),a=await new mw.Api().get({action:"parse",page:t,prop:"sections",redirects:"1"});if(a.parse.redirects?.[0]){const s=a.parse.redirects[0].to+(a.parse.redirects[0].tofragment?`#${a.parse.redirects[0].tofragment}`:"");e.push({title:t,message:`is a redirect to <a href="${mw.util.getUrl(s)}" target="_blank">${s}</a>. Retarget to that page instead, as double redirects aren't allowed.`})}if(t.split("#").length>1)if(a.parse.sections.find(r=>r.line===t.split("#")[1]))this.tagSelect.getValue().includes("R to anchor")&&e.push({message:"is tagged as a redirect to an anchor, but it is actually a redirect to a section!"}),this.tagSelect.getValue().includes("R to section")||e.push({message:"is a redirect to a section, but it is not tagged with <code>{{R to section}}</code>!"});else{const r=(await new mw.Api().get({action:"query",formatversion:2,prop:"revisions",rvprop:"content",rvslots:"*",titles:this.parsedDestination.toString()})).query.pages[0].revisions[0].slots.main.content;[...r.match(/(?<={{\s*?[Aa](?:nchors?|nchor for redirect|nker|NCHOR|nc)\s*?\|).+?(?=}})/g)?.map(n=>n.split("|").map(c=>c.trim()))?.flat()??[],...r.match(/(?<={{\s*?(?:[Vv](?:isible anchors?|isanc|Anch|anchor|isibleanchor|a)|[Aa](?:nchord|chored|nchor\+)|[Tt]ext anchor)\s*?\|).+?(?=(?<!!|=)}})/g)?.map(n=>n.split("|").map(c=>c.trim()).filter(c=>!/^text\s*?=/.test(c)))?.flat()??[],...r.match(/(?<=id=)"?.+?(?="|>|\|)/g)?.map(n=>n.trim())??[]].includes(t.split("#")[1])?(this.tagSelect.getValue().includes("R to section")&&e.push({message:"is tagged as a redirect to a section, but it is actually a redirect to an anchor!"}),this.tagSelect.getValue().includes("R to anchor")||e.push({message:"is a redirect to an anchor, but it is not tagged with <code>{{R from anchor}}</code>!"})):e.push({message:`is a redirect to <a href="${mw.util.getUrl(t)}" target="_blank">${t}</a>, but that section or anchor does not exist!`})}t.split("#").length===1&&(this.tagSelect.getValue().includes("R to section")||this.tagSelect.getValue().includes("R to anchor"))&&e.push({message:"is not a redirect to a section/anchor, but it is tagged with <code>{{R from section}}</code> or <code>{{R from anchor}}</code>!"}),i.query.pages[0].pageprops&&"disambiguation"in i.query.pages[0].pageprops&&!["R from ambiguous sort name","R from ambiguous term","R to disambiguation page","R from incomplete disambiguation","R from incorrect disambiguation","R from other disambiguation"].some(s=>this.tagSelect.getValue().includes(s))&&e.push({message:"is a redirect to a disambiguation page, but it is not tagged with a disambiguation categorization template!"}),i.query.pages[0].pageprops&&!("disambiguation"in i.query.pages[0].pageprops)&&["R from ambiguous sort name","R from ambiguous term","R to disambiguation page","R from incomplete disambiguation"].some(s=>this.tagSelect.getValue().includes(s))&&e.push({message:"is not a redirect to a disambiguation page, but it is tagged with a disambiguation categorization template!"}),this.tagSelect.getValue().includes("R to disambiguation page")&&!this.pageTitleParsed.getMainText().endsWith(" (disambiguation)")&&e.push({message:'is tagged with <code>{{R to disambiguation page}}</code>, but this title does not end with " (disambiguation)". Use <code>{{R from ambiguous term}}</code> or a similar categorization template instead!'});for(const s of["R semi-protected","R extended-protected","R template-protected","R fully protected"])this.tagSelect.getValue().includes(s)&&e.push({message:`is tagged with unnecessarily tagged with <code>{{${s}}}</code> which will be duplicated by the redirect category shell!`});return this.syncTalkCheckbox?.isSelected()&&!this.talkData.query.pages[0].missing&&!this.talkData.query.pages[0].redirect&&e.push({title:this.pageTitleParsed.getTalkPage().getPrefixedText(),message:"exists, but is not a redirect!"}),e}async handleSubmitButtonClick(){for(const s of[this.redirectInput,this.tagSelect,this.summaryInput,this.submitButton,this.previewButton,this.syncTalkCheckbox,this.patrolCheckbox].filter(Boolean))s.setDisabled(!0);this.submitButton.setLabel("Checking target validity...");let e=[];if(this.needsCheck?e=await this.validateSubmission():this.parsedDestination=mw.Title.newFromText(this.redirectInput.getValue()),e.length>0){for(const s of document.querySelectorAll(".redirect-helper-warning"))s.remove();for(const{title:s,message:r}of e){const o=new OO.ui.HtmlSnippet(`${s?`<a href="${mw.util.getUrl(s)}" target="_blank">${s}</a>`:"This page"} ${r} Click again without making changes to submit anyway.`),n=new OO.ui.MessageWidget({type:"error",classes:["redirect-helper-warning"],inline:!0,label:o});n.$element[0].style.marginTop="8px",this.editorBox.$element[0].append(n.$element[0])}for(const s of[this.redirectInput,this.tagSelect,this.summaryInput,this.submitButton,this.syncTalkCheckbox,this.patrolCheckbox].filter(Boolean))s.setDisabled(!1);this.tagSelect.getValue().length>0&&this.previewButton.setDisabled(!1),this.submitButton.setLabel("Submit anyway"),this.needsCheck=!1;return}this.submitButton.setLabel(`${this.exists?"Editing":"Creating"} redirect...`);const t=[`#REDIRECT [[${this.redirectInput.getValue().trim()}]]`,this.tagSelect.getValue().length>0?`{{Redirect category shell|
${this.tagSelect.getValue().map(s=>`{{${s}${this.oldRedirectTagData?.[s]?`|${this.oldRedirectTagData[s]}`:""}}}`).join(`
`)}
}}`:null,this.oldStrayText].filter(Boolean).join(`

`),i=(this.summaryInput.getValue()||this.summaryInput.$tabIndexed[0].placeholder)+" (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])";if(await new mw.Api().edit(this.pageTitle,()=>({text:t,summary:i})).catch((s,r)=>s==="nocreate-missing"?new mw.Api().create(this.pageTitle,{summary:i},t).catch((o,n)=>{mw.notify(`Error creating ${this.pageTitle}: ${n?.error.info??"Unknown error"} (${o})`,{type:"error"})}):(mw.notify(`Error editing or creating ${this.pageTitle}: ${r?.error.info??"Unknown error"} (${s})`,{type:"error"}),null))){if(mw.notify(`Redirect ${this.exists?"edited":"created"} successfully!`,{type:"success"}),this.syncTalkCheckbox?.isSelected()){this.submitButton.setLabel("Editing talk page...");const s=this.tagSelect.getValue().includes("R from move"),r=[`#REDIRECT [[${this.parsedDestination.getTalkPage().getPrefixedText()}]]`,s?`{{Redirect category shell|
{{R from move}}
}}`:null].filter(Boolean).join(`

`),o=this.pageTitleParsed.getTalkPage().getPrefixedText();if(!await new mw.Api().edit(o,()=>({text:r,summary:"Syncing redirect from main page (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])"})).catch((c,m)=>c==="nocreate-missing"?new mw.Api().create(o,{summary:"Syncing redirect from main page (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])"},r).catch((h,f)=>{mw.notify(`Error creating ${o}: ${f?.error.info??"Unknown error"} (${h})`,{type:"error"})}):(mw.notify(`Error editing or creating ${o}: ${m?.error.info??"Unknown error"} (${c})`,{type:"error"}),null)))return;mw.notify("Talk page synced successfully!",{type:"success"})}if(this.patrolCheckbox?.isSelected()){this.submitButton.setLabel("Patrolling redirect...");const s=document.querySelector(".patrollink a"),r=document.querySelector("#mwe-pt-mark-as-reviewed-button");s?await new mw.Api().postWithToken("patrol",{action:"patrol",rcid:new URL(s.href).searchParams.get("rcid")}).catch((n,c)=>(mw.notify(`Error patrolling ${this.pageTitle} via API: ${c?.error.info??"Unknown error"} (${n})`,{type:"error"}),null))&&mw.notify("Redirect patrolled successfully!",{type:"success"}):r?(r.click(),mw.notify("Redirect patrolled successfully!",{type:"success"})):mw.notify("Page curation toolbar not found, redirect cannot be patrolled!",{type:"error"})}this.submitButton.setLabel("Complete, reloading..."),window.location.href=mw.util.getUrl(this.pageTitle,{redirect:"no"})}}}new d().run()});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc2NyaXB0cy9yZWRpcmVjdC1oZWxwZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwaVBhcnNlUGFyYW1zIH0gZnJvbSAndHlwZXMtbWVkaWF3aWtpL2FwaV9wYXJhbXMnO1xuaW1wb3J0IHsgQWxsUGFnZXNHZW5lcmF0b3JSZXN1bHQsIE1lZGlhV2lraURhdGFFcnJvciwgUGFnZUluZm9SZXN1bHQsIFBhZ2VQYXJzZVJlc3VsdCwgUGFnZVJldmlzaW9uc1Jlc3VsdCwgUGFnZVRyaWFnZUxpc3RSZXNwb25zZSwgUGFnZXByb3BzUmVzdWx0LCBVc2VyUGVybWlzc2lvbnNSZXNwb25zZSB9IGZyb20gJy4uL2dsb2JhbC10eXBlcyc7XG5cbm13LmxvYWRlci51c2luZyhbJ21lZGlhd2lraS51dGlsJywgJ29vanMtdWktY29yZScsICdvb2pzLXVpLXdpZGdldHMnLCAnb29qcy11aS13aW5kb3dzJywgJ29vanMtdWkuc3R5bGVzLmljb25zLWNvbnRlbnQnLCAnb29qcy11aS5zdHlsZXMuaWNvbnMtZWRpdGluZy1jb3JlJ10sICgpID0+IHtcbiAgICAvLyBTZXR1cCBSZWRpcmVjdElucHV0V2lkZ2V0XG4gICAgaW50ZXJmYWNlIFJlZGlyZWN0SW5wdXRXaWRnZXRDb25maWcgZXh0ZW5kcyBPTy51aS5UZXh0SW5wdXRXaWRnZXQuQ29uZmlnT3B0aW9ucywgT08udWkubWl4aW4uTG9va3VwRWxlbWVudC5Db25maWdPcHRpb25zIHt9XG5cbiAgICAvKipcbiAgICAgKiBBbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzIGlzIGEgdGl0bGUgbG9va3VwIGVsZW1lbnQuXG4gICAgICovXG4gICAgY2xhc3MgUmVkaXJlY3RJbnB1dFdpZGdldCBleHRlbmRzIE9PLnVpLlRleHRJbnB1dFdpZGdldCB7XG4gICAgICAgIHByaXZhdGUgcGFnZVRpdGxlUGFyc2VkOiBtdy5UaXRsZTtcblxuICAgICAgICBjb25zdHJ1Y3Rvcihjb25maWc6IFJlZGlyZWN0SW5wdXRXaWRnZXRDb25maWcsIHBhZ2VUaXRsZVBhcnNlZDogbXcuVGl0bGUpIHtcbiAgICAgICAgICAgIHN1cGVyKGNvbmZpZyk7XG4gICAgICAgICAgICBPTy51aS5taXhpbi5Mb29rdXBFbGVtZW50LmNhbGwodGhpcyBhcyB1bmtub3duIGFzIE9PLnVpLm1peGluLkxvb2t1cEVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIHRoaXMucGFnZVRpdGxlUGFyc2VkID0gcGFnZVRpdGxlUGFyc2VkO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2V0TG9va3VwUmVxdWVzdCgpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgY29uc3QgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG5cbiAgICAgICAgICAgIGlmICghdmFsdWUpIGRlZmVycmVkLnJlc29sdmUoW10pO1xuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUuaW5jbHVkZXMoJyMnKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gdmFsdWUuc3BsaXQoJyMnKVswXTtcblxuICAgICAgICAgICAgICAgIG5ldyBtdy5BcGkoKVxuICAgICAgICAgICAgICAgICAgICAuZ2V0KHsgYWN0aW9uOiAncGFyc2UnLCBwYWdlOiB0aXRsZSwgcHJvcDogJ3NlY3Rpb25zJywgcmVkaXJlY3RzOiAnMScgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKCgpID0+IG51bGwpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXN1bHQ6IFBhZ2VQYXJzZVJlc3VsdCB8IG51bGwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVkU2VjdGlvbnMgPSByZXN1bHQucGFyc2Uuc2VjdGlvbnMuZmlsdGVyKChzZWN0aW9uKSA9PiBzZWN0aW9uLmxpbmUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKHZhbHVlLnNwbGl0KCcjJylbMV0udG9Mb3dlckNhc2UoKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUobWF0Y2hlZFNlY3Rpb25zLm1hcCgoc2VjdGlvbikgPT4gKHsgZGF0YTogYCR7cmVzdWx0LnBhcnNlLnRpdGxlfSMke3NlY3Rpb24ubGluZX1gLCBsYWJlbDogYCR7cmVzdWx0LnBhcnNlLnRpdGxlfSMke3NlY3Rpb24ubGluZX1gIH0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgZGVmZXJyZWQucmVzb2x2ZShbXSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRUaXRsZSA9IG13LlRpdGxlLm5ld0Zyb21UZXh0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdxdWVyeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2FwbGltaXQ6IDIwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2FwbmFtZXNwYWNlOiBwYXJzZWRUaXRsZT8uZ2V0TmFtZXNwYWNlSWQoKSA/PyAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2FwcHJlZml4OiBwYXJzZWRUaXRsZT8uZ2V0TWFpblRleHQoKSA/PyB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYXRvcjogJ2FsbHBhZ2VzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3A6ICdpbmZvfHBhZ2Vwcm9wcycsXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiBudWxsKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzdWx0OiBBbGxQYWdlc0dlbmVyYXRvclJlc3VsdCB8IG51bGwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnF1ZXJ5Py5wYWdlcyAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyByZXN1bHQucXVlcnkucGFnZXMgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKHBhZ2UpID0+IHBhZ2UudGl0bGUgIT09IHRoaXMucGFnZVRpdGxlUGFyc2VkLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKChwYWdlKSA9PiAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHBhZ2UudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG5ldyBPTy51aS5IdG1sU25pcHBldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCR7cGFnZS50aXRsZX0ke3BhZ2UucGFnZXByb3BzICYmICdkaXNhbWJpZ3VhdGlvbicgaW4gcGFnZS5wYWdlcHJvcHMgPyAnIDxpPihkaXNhbWJpZ3VhdGlvbik8L2k+JyA6ICcnfSR7J3JlZGlyZWN0JyBpbiBwYWdlID8gJyA8aT4ocmVkaXJlY3QpPC9pPicgOiAnJ31gLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgZGVmZXJyZWQucmVzb2x2ZShbXSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSh7IGFib3J0KCkge30gfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgIH1cblxuICAgICAgICBnZXRMb29rdXBDYWNoZURhdGFGcm9tUmVzcG9uc2U8VD4ocmVzcG9uc2U6IFRbXSB8IG51bGwgfCB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSA/PyBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldExvb2t1cE1lbnVPcHRpb25zRnJvbURhdGEoZGF0YTogeyBkYXRhOiBzdHJpbmc7IGxhYmVsOiBzdHJpbmcgfVtdKSB7XG4gICAgICAgICAgICBkYXRhLm1hcCgoeyBkYXRhLCBsYWJlbCB9KSA9PiBuZXcgT08udWkuTWVudU9wdGlvbldpZGdldCh7IGRhdGEsIGxhYmVsIH0pKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24oUmVkaXJlY3RJbnB1dFdpZGdldC5wcm90b3R5cGUsIE9PLnVpLm1peGluLkxvb2t1cEVsZW1lbnQucHJvdG90eXBlKTtcblxuICAgIC8vIFNldHVwIFRlbXBsYXRlUHJldmlld0RpYWxvZ1xuXG4gICAgLyoqXG4gICAgICogQW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcyBpcyBhIGRpYWxvZyB1c2VkIGZvciBwcmV2aWV3aW5nIHRlbXBsYXRlcy5cbiAgICAgKi9cbiAgICBjbGFzcyBUZW1wbGF0ZVByZXZpZXdEaWFsb2cgZXh0ZW5kcyBPTy51aS5Qcm9jZXNzRGlhbG9nIHtcbiAgICAgICAgcHJpdmF0ZSBwYWdlVGl0bGVQYXJzZWQ6IG13LlRpdGxlO1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKGNvbmZpZzogT08udWkuUHJvY2Vzc0RpYWxvZy5Db25maWdPcHRpb25zLCBwYWdlVGl0bGVQYXJzZWQ6IG13LlRpdGxlKSB7XG4gICAgICAgICAgICBzdXBlcihjb25maWcpO1xuXG4gICAgICAgICAgICB0aGlzLnBhZ2VUaXRsZVBhcnNlZCA9IHBhZ2VUaXRsZVBhcnNlZDtcblxuICAgICAgICAgICAgVGVtcGxhdGVQcmV2aWV3RGlhbG9nLnN0YXRpYy5uYW1lID0gJ1RlbXBsYXRlUHJldmlld0RpYWxvZyc7XG4gICAgICAgICAgICBUZW1wbGF0ZVByZXZpZXdEaWFsb2cuc3RhdGljLnRpdGxlID0gJ1JlZGlyZWN0IGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlcyBwcmV2aWV3JztcbiAgICAgICAgICAgIFRlbXBsYXRlUHJldmlld0RpYWxvZy5zdGF0aWMuYWN0aW9ucyA9IFt7IGFjdGlvbjogJ2NhbmNlbCcsIGxhYmVsOiAnQ2xvc2UnLCBmbGFnczogWydzYWZlJywgJ2Nsb3NlJ10gfV07XG4gICAgICAgIH1cblxuICAgICAgICBnZXRTZXR1cFByb2Nlc3MoKSB7XG4gICAgICAgICAgICByZXR1cm4gVGVtcGxhdGVQcmV2aWV3RGlhbG9nLnN1cGVyLnByb3RvdHlwZS5nZXRTZXR1cFByb2Nlc3MuY2FsbCh0aGlzKS5uZXh0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwb3N0Q29uZmlnOiBBcGlQYXJzZVBhcmFtcyAmIFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BhcnNlJyxcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dmVyc2lvbjogJzInLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50bW9kZWw6ICd3aWtpdGV4dCcsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRQcmVmaXhlZERiKCksXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGB7e1JlZGlyZWN0IGNhdGVnb3J5IHNoZWxsfCR7KHRoaXMuZ2V0RGF0YSgpIGFzIHN0cmluZ1tdKS5tYXAoKHRhZykgPT4gYHt7JHt0YWd9fX1gKS5qb2luKCcnKX19fWAsXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbXcuQXBpKCkucG9zdChwb3N0Q29uZmlnKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IChyZXN1bHQgYXMgeyBwYXJzZTogeyB0ZXh0OiBzdHJpbmcgfSB9KS5wYXJzZS50ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhbmVsTGF5b3V0ID0gbmV3IE9PLnVpLlBhbmVsTGF5b3V0KHsgcGFkZGVkOiB0cnVlLCBleHBhbmRlZDogZmFsc2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsTGF5b3V0LiRlbGVtZW50LmFwcGVuZChjb250ZW50KTtcblxuICAgICAgICAgICAgICAgICAgICAodGhpcyBhcyB1bmtub3duIGFzIHsgJGJvZHk6IEpRdWVyeSB9KS4kYm9keS5hcHBlbmQocGFuZWxMYXlvdXQuJGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBnZXRBY3Rpb25Qcm9jZXNzKGFjdGlvbjogc3RyaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0aW9uXG4gICAgICAgICAgICAgICAgPyBuZXcgT08udWkuUHJvY2VzcygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRNYW5hZ2VyKCkuY2xvc2VXaW5kb3codGhpcyk7XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIDogVGVtcGxhdGVQcmV2aWV3RGlhbG9nLnN1cGVyLnByb3RvdHlwZS5nZXRBY3Rpb25Qcm9jZXNzLmNhbGwodGhpcywgYWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24oVGVtcGxhdGVQcmV2aWV3RGlhbG9nLnByb3RvdHlwZSwgT08udWkuUHJvY2Vzc0RpYWxvZy5wcm90b3R5cGUpO1xuXG4gICAgLy8gT3ZlcndyaXRlIFRlbXBsYXRlUHJldmlld0RpYWxvZy5wcm90b3R5cGUuZ2V0VGVhcmRvd25Qcm9jZXNzIGFzIGl0IGFsd2F5cyBnZXRzIG92ZXJ3cml0dGVuIGJ5IHRoZSBhYm92ZSBPYmplY3QuYXNzaWduIGNhbGxcbiAgICBUZW1wbGF0ZVByZXZpZXdEaWFsb2cucHJvdG90eXBlLmdldFRlYXJkb3duUHJvY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFRlbXBsYXRlUHJldmlld0RpYWxvZy5zdXBlci5wcm90b3R5cGUuZ2V0VGVhcmRvd25Qcm9jZXNzLmNhbGwodGhpcykubmV4dCgoKSA9PiB7XG4gICAgICAgICAgICAodGhpcyBhcyB1bmtub3duIGFzIHsgJGJvZHk6IEpRdWVyeSB9KS4kYm9keS5lbXB0eSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcyBoYW5kbGVzIHRoZSBlbnRpcmUgZnVuY3Rpb25hbGl0eSBvZiB0aGUgcmVkaXJlY3QtaGVscGVyIHNjcmlwdC5cbiAgICAgKi9cbiAgICBjbGFzcyBSZWRpcmVjdEhlbHBlciB7XG4gICAgICAgIHByaXZhdGUgcmVkaXJlY3RUZW1wbGF0ZXMhOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47XG4gICAgICAgIHByaXZhdGUgY29udGVudFRleHQhOiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgcHJpdmF0ZSBwYWdlVGl0bGUhOiBzdHJpbmc7XG4gICAgICAgIHByaXZhdGUgcGFnZVRpdGxlUGFyc2VkITogbXcuVGl0bGU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1bnMgdGhlIHJlZGlyZWN0IGhlbHBlci5cbiAgICAgICAgICovXG4gICAgICAgIGFzeW5jIHJ1bigpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXNzZXNQcmVDaGVja3MoKSkgcmV0dXJuO1xuXG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0VGVtcGxhdGVzID0gYXdhaXQgdGhpcy5mZXRjaFJlZGlyZWN0VGVtcGxhdGVzKCk7XG5cbiAgICAgICAgICAgIHRoaXMuY29udGVudFRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbXctY29udGVudC10ZXh0JykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY29udGVudFRleHQpIHJldHVybiBtdy5ub3RpZnkoJ3JlZGlyZWN0LWhlbHBlcjogRmFpbGVkIHRvIGZpbmQgY29udGVudCB0ZXh0IGVsZW1lbnQhJywgeyB0eXBlOiAnZXJyb3InIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnBhZ2VUaXRsZSA9IG13LmNvbmZpZy5nZXQoJ3dnUGFnZU5hbWUnKTtcblxuICAgICAgICAgICAgdGhpcy5wYWdlVGl0bGVQYXJzZWQgPSBtdy5UaXRsZS5uZXdGcm9tVGV4dCh0aGlzLnBhZ2VUaXRsZSkhO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnBhZ2VUaXRsZVBhcnNlZCkgcmV0dXJuIG13Lm5vdGlmeSgncmVkaXJlY3QtaGVscGVyOiBGYWlsZWQgdG8gcGFyc2UgcGFnZSB0aXRsZSEnLCB7IHR5cGU6ICdlcnJvcicgfSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2hlY2tQYWdlQW5kTG9hZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoZWNrcyBpZiB0aGUgcGFnZSBwYXNzZXMgcHJlIGNoZWNrcy5cbiAgICAgICAgICovXG4gICAgICAgIHByaXZhdGUgcGFzc2VzUHJlQ2hlY2tzKCkge1xuICAgICAgICAgICAgY29uc3QgY29uZGl0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICBtdy5jb25maWcuZ2V0KCd3Z05hbWVzcGFjZU51bWJlcicpID49IDAsIC8vIElzIG5vdCB2aXJ0dWFsIG5hbWVzcGFjZVxuICAgICAgICAgICAgICAgIG13LmNvbmZpZy5nZXQoJ3dnSXNQcm9iYWJseUVkaXRhYmxlJyksIC8vIFBhZ2UgaXMgZWRpdGFibGVcbiAgICAgICAgICAgICAgICBtdy5jb25maWcuZ2V0KCd3Z0lzQXJ0aWNsZScpLCAvLyBWaWV3aW5nIHRoZSBjb250ZW50IG9mIGEgcGFnZVxuICAgICAgICAgICAgICAgIG13LmNvbmZpZy5nZXQoJ3dnQWN0aW9uJykgPT09ICd2aWV3JywgLy8gVmlld2luZyB0aGUgcGFnZSAobm90IGVkaXRpbmcpXG4gICAgICAgICAgICAgICAgbXcuY29uZmlnLmdldCgnd2dSZXZpc2lvbklkJykgPT09IG13LmNvbmZpZy5nZXQoJ3dnQ3VyUmV2aXNpb25JZCcpLCAvLyBWaWV3aW5nIHRoZSBjdXJyZW50IHJldmlzaW9uXG4gICAgICAgICAgICAgICAgIW13LmNvbmZpZy5nZXQoJ3dnRGlmZk9sZElkJyksIC8vIE5vdCB2aWV3aW5nIGEgZGlmZlxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgcmV0dXJuIGNvbmRpdGlvbnMuZXZlcnkoQm9vbGVhbik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmV0Y2hlcyB0aGUgcmVkaXJlY3QgdGVtcGxhdGVzLlxuICAgICAgICAgKi9cbiAgICAgICAgcHJpdmF0ZSBhc3luYyBmZXRjaFJlZGlyZWN0VGVtcGxhdGVzKCkge1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoXG4gICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdxdWVyeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogJ3JldmlzaW9ucycsXG4gICAgICAgICAgICAgICAgICAgICAgICBydnByb3A6ICdjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ2c2xvdHM6ICcqJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlczogJ1VzZXI6RWVqaXQ0My9zY3JpcHRzL3JlZGlyZWN0LWhlbHBlci5qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgfSkpIGFzIFBhZ2VSZXZpc2lvbnNSZXN1bHRcbiAgICAgICAgICAgICAgICApLnF1ZXJ5LnBhZ2VzPy5bMF0/LnJldmlzaW9ucz8uWzBdPy5zbG90cz8ubWFpbj8uY29udGVudCB8fCAne30nLFxuICAgICAgICAgICAgKSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hlY2tzIGEgcGFnZSdzIHN0YXR1cyBhbmQgbG9hZHMgdGhlIGhlbHBlciBhcHByb3ByaWF0ZWx5LlxuICAgICAgICAgKi9cbiAgICAgICAgcHJpdmF0ZSBhc3luYyBjaGVja1BhZ2VBbmRMb2FkKCkge1xuICAgICAgICAgICAgY29uc3QgcGFnZUluZm8gPSAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3F1ZXJ5JywgZm9ybWF0dmVyc2lvbjogMiwgcHJvcDogJ2luZm8nLCB0aXRsZXM6IHRoaXMucGFnZVRpdGxlIH0pKSBhcyBQYWdlSW5mb1Jlc3VsdDtcblxuICAgICAgICAgICAgY29uc3QgZGlhbG9nSW5mbyA9IHsgcmVkaXJlY3RUZW1wbGF0ZXM6IHRoaXMucmVkaXJlY3RUZW1wbGF0ZXMsIGNvbnRlbnRUZXh0OiB0aGlzLmNvbnRlbnRUZXh0LCBwYWdlVGl0bGU6IHRoaXMucGFnZVRpdGxlLCBwYWdlVGl0bGVQYXJzZWQ6IHRoaXMucGFnZVRpdGxlUGFyc2VkIH07XG5cbiAgICAgICAgICAgIGlmIChwYWdlSW5mby5xdWVyeS5wYWdlc1swXS5taXNzaW5nKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IE9PLnVpLkJ1dHRvbldpZGdldCh7IGxhYmVsOiAnQ3JlYXRlIHJlZGlyZWN0JywgaWNvbjogJ2FydGljbGVSZWRpcmVjdCcsIGZsYWdzOiBbJ3Byb2dyZXNzaXZlJ10gfSk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLiRlbGVtZW50WzBdLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcyMHB4JztcbiAgICAgICAgICAgICAgICBidXR0b24ub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBidXR0b24uJGVsZW1lbnRbMF0ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBSZWRpcmVjdEhlbHBlckRpYWxvZyhkaWFsb2dJbmZvLCBmYWxzZSkubG9hZCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50VGV4dC5wcmVwZW5kKGJ1dHRvbi4kZWxlbWVudFswXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2VJbmZvLnF1ZXJ5LnBhZ2VzWzBdLnJlZGlyZWN0KSBuZXcgUmVkaXJlY3RIZWxwZXJEaWFsb2coZGlhbG9nSW5mbywgdHJ1ZSkubG9hZCgpO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcG9ydGxldExpbmsgPSBtdy51dGlsLmFkZFBvcnRsZXRMaW5rKG13LmNvbmZpZy5nZXQoJ3NraW4nKSA9PT0gJ21pbmVydmEnID8gJ3AtdGInIDogJ3AtY2FjdGlvbnMnLCAnIycsICdSZWRpcmVjdCBwYWdlJywgJ3JlZGlyZWN0LWhlbHBlcicpITtcbiAgICAgICAgICAgICAgICBwb3J0bGV0TGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIG5ldyBSZWRpcmVjdEhlbHBlckRpYWxvZyhkaWFsb2dJbmZvLCBmYWxzZSkubG9hZCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHBvcnRsZXRMaW5rLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcyBoYW5kbGVzIHRoZSBkaWFsb2cgcG9ydGlvbiBvZiByZWRpcmVjdC1oZWxwZXIgc2NyaXB0LlxuICAgICAqL1xuICAgIGNsYXNzIFJlZGlyZWN0SGVscGVyRGlhbG9nIHtcbiAgICAgICAgLy8gQ3JlYXRlZCBpbiBjb25zdHJ1Y3RvclxuICAgICAgICBwcml2YXRlIHJlZGlyZWN0VGVtcGxhdGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47XG4gICAgICAgIHByaXZhdGUgY29udGVudFRleHQ6IEhUTUxEaXZFbGVtZW50O1xuICAgICAgICBwcml2YXRlIHBhZ2VUaXRsZTogc3RyaW5nO1xuICAgICAgICBwcml2YXRlIHBhZ2VUaXRsZVBhcnNlZDogbXcuVGl0bGU7XG5cbiAgICAgICAgcHJpdmF0ZSBleGlzdHM6IGJvb2xlYW47XG5cbiAgICAgICAgLy8gVXNlZCBkdXJpbmcgcnVuKClcbiAgICAgICAgcHJpdmF0ZSBuZWVkc0NoZWNrID0gdHJ1ZTtcblxuICAgICAgICBwcml2YXRlIGVkaXRvckJveCE6IE9PLnVpLlBhbmVsTGF5b3V0O1xuICAgICAgICBwcml2YXRlIHN5bmNXaXRoTWFpbkJ1dHRvbj86IE9PLnVpLkJ1dHRvbldpZGdldDtcbiAgICAgICAgcHJpdmF0ZSByZWRpcmVjdElucHV0ITogUmVkaXJlY3RJbnB1dFdpZGdldDtcbiAgICAgICAgcHJpdmF0ZSByZWRpcmVjdElucHV0TGF5b3V0ITogT08udWkuRmllbGRMYXlvdXQ7XG4gICAgICAgIHByaXZhdGUgdGFnU2VsZWN0ITogT08udWkuTWVudVRhZ011bHRpc2VsZWN0V2lkZ2V0O1xuICAgICAgICBwcml2YXRlIHRhZ1NlbGVjdExheW91dCE6IE9PLnVpLkZpZWxkTGF5b3V0O1xuICAgICAgICBwcml2YXRlIHN1bW1hcnlJbnB1dCE6IE9PLnVpLkNvbWJvQm94SW5wdXRXaWRnZXQ7XG4gICAgICAgIHByaXZhdGUgc3VtbWFyeUlucHV0TGF5b3V0ITogT08udWkuRmllbGRMYXlvdXQ7XG4gICAgICAgIHByaXZhdGUgc3VibWl0QnV0dG9uITogT08udWkuQnV0dG9uV2lkZ2V0O1xuICAgICAgICBwcml2YXRlIHByZXZpZXdCdXR0b24hOiBPTy51aS5CdXR0b25XaWRnZXQ7XG4gICAgICAgIHByaXZhdGUgc3luY1RhbGtDaGVja2JveD86IE9PLnVpLkNoZWNrYm94SW5wdXRXaWRnZXQ7XG4gICAgICAgIHByaXZhdGUgc3luY1RhbGtDaGVja2JveExheW91dD86IE9PLnVpLldpZGdldDtcbiAgICAgICAgcHJpdmF0ZSBwYXRyb2xDaGVja2JveD86IE9PLnVpLkNoZWNrYm94SW5wdXRXaWRnZXQ7XG4gICAgICAgIHByaXZhdGUgcGF0cm9sQ2hlY2tib3hMYXlvdXQ/OiBPTy51aS5XaWRnZXQ7XG4gICAgICAgIHByaXZhdGUgc3VibWl0TGF5b3V0ITogT08udWkuSG9yaXpvbnRhbExheW91dDtcblxuICAgICAgICBwcml2YXRlIHRhbGtEYXRhPzogUGFnZUluZm9SZXN1bHQ7XG5cbiAgICAgICAgcHJpdmF0ZSBvbGRSZWRpcmVjdFRhcmdldD86IHN0cmluZztcbiAgICAgICAgcHJpdmF0ZSBvbGRSZWRpcmVjdFRhZ3M/OiBzdHJpbmdbXTtcbiAgICAgICAgcHJpdmF0ZSBvbGRSZWRpcmVjdFRhZ0RhdGE/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgICAgICBwcml2YXRlIG9sZFN0cmF5VGV4dD86IHN0cmluZztcblxuICAgICAgICBwcml2YXRlIHBhcnNlZERlc3RpbmF0aW9uITogbXcuVGl0bGUgfCBudWxsO1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICAgICAgeyByZWRpcmVjdFRlbXBsYXRlcywgY29udGVudFRleHQsIHBhZ2VUaXRsZSwgcGFnZVRpdGxlUGFyc2VkIH06IHsgcmVkaXJlY3RUZW1wbGF0ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjsgY29udGVudFRleHQ6IEhUTUxEaXZFbGVtZW50OyBwYWdlVGl0bGU6IHN0cmluZzsgcGFnZVRpdGxlUGFyc2VkOiBtdy5UaXRsZSB9LFxuICAgICAgICAgICAgZXhpc3RzOiBib29sZWFuLFxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMucmVkaXJlY3RUZW1wbGF0ZXMgPSByZWRpcmVjdFRlbXBsYXRlcztcbiAgICAgICAgICAgIHRoaXMuY29udGVudFRleHQgPSBjb250ZW50VGV4dDtcbiAgICAgICAgICAgIHRoaXMucGFnZVRpdGxlID0gcGFnZVRpdGxlO1xuICAgICAgICAgICAgdGhpcy5wYWdlVGl0bGVQYXJzZWQgPSBwYWdlVGl0bGVQYXJzZWQ7XG5cbiAgICAgICAgICAgIHRoaXMuZXhpc3RzID0gZXhpc3RzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvYWRzIHRoZSByZWRpcmVjdC1oZWxwZXIgZGlhbG9nIGludG8gdGhlIHBhZ2UuXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyBsb2FkKCkge1xuICAgICAgICAgICAgLyogTG9hZCBlbGVtZW50cyAqL1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JCb3ggPSBuZXcgT08udWkuUGFuZWxMYXlvdXQoeyBwYWRkZWQ6IHRydWUsIGV4cGFuZGVkOiBmYWxzZSwgZnJhbWVkOiB0cnVlIH0pO1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyM5NWQ0YmMnO1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUud2lkdGggPSAnNzAwcHgnO1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUubWF4V2lkdGggPSAnY2FsYygxMDAlIC0gNTBweCknO1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luTGVmdCA9ICdhdXRvJztcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yQm94LiRlbGVtZW50WzBdLnN0eWxlLm1hcmdpblJpZ2h0ID0gJ2F1dG8nO1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luQm90dG9tID0gJzIwcHgnO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5wYWdlVGl0bGVQYXJzZWQuaXNUYWxrUGFnZSgpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFpblBhZ2VEYXRhID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdxdWVyeScsIGZvcm1hdHZlcnNpb246IDIsIHByb3A6ICdpbmZvJywgdGl0bGVzOiB0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRTdWJqZWN0UGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKSB9KSkgYXMgUGFnZUluZm9SZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAobWFpblBhZ2VEYXRhLnF1ZXJ5LnBhZ2VzWzBdLnJlZGlyZWN0KSB0aGlzLmxvYWRTeW5jV2l0aE1haW5CdXR0b24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5sb2FkSW5wdXRFbGVtZW50cygpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkU3VibWl0RWxlbWVudHMoKTtcblxuICAgICAgICAgICAgLyogQWRkIGVsZW1lbnRzIHRvIHNjcmVlbiBhbmQgbG9hZCBkYXRhIChpZiBhcHBsaWNhYmxlKSAqL1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JCb3guJGVsZW1lbnRbMF0uYXBwZW5kKFxuICAgICAgICAgICAgICAgIC4uLihbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3luY1dpdGhNYWluQnV0dG9uPy4kZWxlbWVudD8uWzBdLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZGlyZWN0SW5wdXRMYXlvdXQuJGVsZW1lbnRbMF0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFnU2VsZWN0TGF5b3V0LiRlbGVtZW50WzBdLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1bW1hcnlJbnB1dExheW91dC4kZWxlbWVudFswXSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJtaXRMYXlvdXQuJGVsZW1lbnRbMF0sXG4gICAgICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbikgYXMgSFRNTEVsZW1lbnRbXSksXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUZXh0LnByZXBlbmQodGhpcy5lZGl0b3JCb3guJGVsZW1lbnRbMF0pO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5leGlzdHMpIHRoaXMubG9hZEV4aXN0aW5nRGF0YSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJpdmF0ZSBhc3luYyBsb2FkU3luY1dpdGhNYWluQnV0dG9uKCkge1xuICAgICAgICAgICAgY29uc3QgbWFpblBhZ2VDb250ZW50ID0gKFxuICAgICAgICAgICAgICAgIChhd2FpdCBuZXcgbXcuQXBpKCkuZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAyLFxuICAgICAgICAgICAgICAgICAgICBwcm9wOiAncmV2aXNpb25zJyxcbiAgICAgICAgICAgICAgICAgICAgcnZwcm9wOiAnY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIHJ2c2xvdHM6ICcqJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVzOiB0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRTdWJqZWN0UGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKSxcbiAgICAgICAgICAgICAgICB9KSkgYXMgUGFnZVJldmlzaW9uc1Jlc3VsdFxuICAgICAgICAgICAgKS5xdWVyeS5wYWdlc1swXS5yZXZpc2lvbnNbMF0uc2xvdHMubWFpbi5jb250ZW50LnRyaW0oKTtcbiAgICAgICAgICAgIHRoaXMuc3luY1dpdGhNYWluQnV0dG9uID0gbmV3IE9PLnVpLkJ1dHRvbldpZGdldCh7IGxhYmVsOiAnU3luYyB3aXRoIG1haW4gcGFnZScsIGljb246ICdsaW5rJywgZmxhZ3M6IFsncHJvZ3Jlc3NpdmUnXSB9KTtcbiAgICAgICAgICAgIHRoaXMuc3luY1dpdGhNYWluQnV0dG9uLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSAvXiNyZWRpcmVjdDo/XFxzKlxcW1xcW1xccyooW15bXFxde3x9XSs/KVxccyooPzpcXHxbXltcXF17fH1dKz8pP11dXFxzKi9pLmV4ZWMobWFpblBhZ2VDb250ZW50KT8uWzFdO1xuICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KSByZXR1cm4gbXcubm90aWZ5KCdGYWlsZWQgdG8gcGFyc2UgbWFpbiBwYWdlIGNvbnRlbnQhJywgeyB0eXBlOiAnZXJyb3InIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5yZWRpcmVjdElucHV0LnNldFZhbHVlKG13LlRpdGxlLm5ld0Zyb21UZXh0KHRhcmdldCk/LmdldFRhbGtQYWdlKCk/LnRvU3RyaW5nKCkgPz8gJycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZyb21Nb3ZlID0gWydSIGZyb20gbW92ZScsIC4uLnRoaXMucmVkaXJlY3RUZW1wbGF0ZXNbJ1IgZnJvbSBtb3ZlJ11dLnNvbWUoKHRhZ09yUmVkaXJlY3QpID0+XG4gICAgICAgICAgICAgICAgICAgIG5ldyBSZWdFeHAoYHt7XFxcXHMqWyR7dGFnT3JSZWRpcmVjdFswXS50b0xvd2VyQ2FzZSgpfSR7dGFnT3JSZWRpcmVjdFswXX1dJHt0YWdPclJlZGlyZWN0LnNsaWNlKDEpfVxcXFxzKihcXFxcfHx9fSlgKS50ZXN0KG1haW5QYWdlQ29udGVudCksXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAoZnJvbU1vdmUpIHRoaXMudGFnU2VsZWN0LnNldFZhbHVlKFsnUiBmcm9tIG1vdmUnXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2FkcyB0aGUgaW5wdXQgZWxlbWVudHMuXG4gICAgICAgICAqL1xuICAgICAgICBwcml2YXRlIGxvYWRJbnB1dEVsZW1lbnRzKCkge1xuICAgICAgICAgICAgLyogUmVkaXJlY3QgdGFyZ2V0IGlucHV0ICovXG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0SW5wdXQgPSBuZXcgUmVkaXJlY3RJbnB1dFdpZGdldCh7IHBsYWNlaG9sZGVyOiAnVGFyZ2V0IHBhZ2UgbmFtZScsIHJlcXVpcmVkOiB0cnVlIH0sIHRoaXMucGFnZVRpdGxlUGFyc2VkKTtcbiAgICAgICAgICAgIHRoaXMucmVkaXJlY3RJbnB1dC5vbignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IHRoaXMucmVkaXJlY3RJbnB1dC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKGBeKGh0dHBzPzopPy97Mn0/JHttdy5jb25maWcuZ2V0KCd3Z1NlcnZlcicpLnJlcGxhY2UoL15cXC97Mn0vLCAnJyl9L3dpa2kvYCksICcnKTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL146LywgJycpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWRpcmVjdElucHV0LnNldFZhbHVlKHZhbHVlWzBdLnRvVXBwZXJDYXNlKCkgKyB2YWx1ZS5zbGljZSgxKS5yZXBsYWNlQWxsKCdfJywgJyAnKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5zdWJtaXRCdXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN1bW1hcnkoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5zZXRMYWJlbCgnU3VibWl0Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5uZWVkc0NoZWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0SW5wdXRMYXlvdXQgPSBuZXcgT08udWkuRmllbGRMYXlvdXQodGhpcy5yZWRpcmVjdElucHV0LCB7IGxhYmVsOiBuZXcgT08udWkuSHRtbFNuaXBwZXQoJzxiPlJlZGlyZWN0IHRhcmdldDo8L2I+JyksIGFsaWduOiAndG9wJyB9KTtcblxuICAgICAgICAgICAgLyogUmVkaXJlY3QgY2F0ZWdvcml6YXRpb24gdGVtcGxhdGUgc2VsZWN0aW9uICovXG4gICAgICAgICAgICB0aGlzLnRhZ1NlbGVjdCA9IG5ldyBPTy51aS5NZW51VGFnTXVsdGlzZWxlY3RXaWRnZXQoe1xuICAgICAgICAgICAgICAgIGFsbG93QXJiaXRyYXJ5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBhbGxvd1Jlb3JkZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IE9iamVjdC5rZXlzKHRoaXMucmVkaXJlY3RUZW1wbGF0ZXMpLm1hcCgodGFnKSA9PiAoeyBkYXRhOiB0YWcsIGxhYmVsOiB0YWcgfSkpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAodGhpcy50YWdTZWxlY3QuZ2V0TWVudSgpIGFzIE9PLnVpLk1lbnVTZWxlY3RXaWRnZXQuQ29uZmlnT3B0aW9ucykuZmlsdGVyTW9kZSA9ICdzdWJzdHJpbmcnO1xuICAgICAgICAgICAgdGhpcy50YWdTZWxlY3Qub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzb3J0ZWRUYWdzID0gKHRoaXMudGFnU2VsZWN0LmdldFZhbHVlKCkgYXMgc3RyaW5nW10pLnNvcnQoKGEsIGIpID0+IGEudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGIudG9Mb3dlckNhc2UoKSkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCh0aGlzLnRhZ1NlbGVjdC5nZXRWYWx1ZSgpIGFzIHN0cmluZ1tdKS5qb2luKCc7JykgIT09IHNvcnRlZFRhZ3Muam9pbignOycpKSB0aGlzLnRhZ1NlbGVjdC5zZXRWYWx1ZShzb3J0ZWRUYWdzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3VtbWFyeSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnNldExhYmVsKCdTdWJtaXQnKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5lZWRzQ2hlY2sgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGFnU2VsZWN0LmdldFZhbHVlKCkubGVuZ3RoID4gMCkgdGhpcy5wcmV2aWV3QnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBlbHNlIHRoaXMucHJldmlld0J1dHRvbi5zZXREaXNhYmxlZCh0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnRhZ1NlbGVjdExheW91dCA9IG5ldyBPTy51aS5GaWVsZExheW91dCh0aGlzLnRhZ1NlbGVjdCwgeyBsYWJlbDogbmV3IE9PLnVpLkh0bWxTbmlwcGV0KCc8Yj5SZWRpcmVjdCBjYXRlZ29yaXphdGlvbiB0ZW1wbGF0ZShzKTo8L2I+JyksIGFsaWduOiAndG9wJyB9KTtcblxuICAgICAgICAgICAgLyogU3VtbWFyeSBpbnB1dCAqL1xuICAgICAgICAgICAgdGhpcy5zdW1tYXJ5SW5wdXQgPSBuZXcgT08udWkuQ29tYm9Cb3hJbnB1dFdpZGdldCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uczogW1xuICAgICAgICAgICAgICAgICAgICB7IGRhdGE6ICdSZXNvbHZlIGRvdWJsZSByZWRpcmVjdCcgfSwgLy9cbiAgICAgICAgICAgICAgICAgICAgeyBkYXRhOiAnUmVzb2x2ZSBzZWxmIHJlZGlyZWN0JyB9LFxuICAgICAgICAgICAgICAgICAgICB7IGRhdGE6ICdSZW1vdmUgaW5jb3JyZWN0IHJjYXRzJyB9LFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5zdW1tYXJ5SW5wdXRMYXlvdXQgPSBuZXcgT08udWkuRmllbGRMYXlvdXQodGhpcy5zdW1tYXJ5SW5wdXQsIHsgbGFiZWw6IG5ldyBPTy51aS5IdG1sU25pcHBldCgnPGI+U3VtbWFyeTo8L2I+JyksIGFsaWduOiAndG9wJyB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2FkcyB0aGUgZWxlbWVudHMgaW4gdGhlIHN1Ym1pdCBidXR0b24gcm93LlxuICAgICAgICAgKi9cbiAgICAgICAgcHJpdmF0ZSBhc3luYyBsb2FkU3VibWl0RWxlbWVudHMoKSB7XG4gICAgICAgICAgICAvKiBTZXR1cCBzdWJtaXQgYnV0dG9uICovXG4gICAgICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbiA9IG5ldyBPTy51aS5CdXR0b25XaWRnZXQoeyBsYWJlbDogJ1N1Ym1pdCcsIGRpc2FibGVkOiB0cnVlLCBmbGFnczogWydwcm9ncmVzc2l2ZSddIH0pO1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24uJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luQm90dG9tID0gJzAnO1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24ub24oJ2NsaWNrJywgKCkgPT4gdGhpcy5oYW5kbGVTdWJtaXRCdXR0b25DbGljaygpKTtcblxuICAgICAgICAgICAgLyogU2V0dXAgcHJldmlldyBidXR0b24gKi9cbiAgICAgICAgICAgIGNvbnN0IHdpbmRvd01hbmFnZXIgPSBuZXcgT08udWkuV2luZG93TWFuYWdlcigpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmQod2luZG93TWFuYWdlci4kZWxlbWVudFswXSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlUHJldmlld0RpYWxvZyA9IG5ldyBUZW1wbGF0ZVByZXZpZXdEaWFsb2coeyBzaXplOiAnbGFyZ2UnIH0sIHRoaXMucGFnZVRpdGxlUGFyc2VkKTtcbiAgICAgICAgICAgIHdpbmRvd01hbmFnZXIuYWRkV2luZG93cyhbdGVtcGxhdGVQcmV2aWV3RGlhbG9nXSk7XG5cbiAgICAgICAgICAgIHRoaXMucHJldmlld0J1dHRvbiA9IG5ldyBPTy51aS5CdXR0b25XaWRnZXQoeyBsYWJlbDogJ1ByZXZpZXcgdGVtcGxhdGVzJywgZGlzYWJsZWQ6IHRydWUgfSk7XG4gICAgICAgICAgICB0aGlzLnByZXZpZXdCdXR0b24uJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luQm90dG9tID0gJzAnO1xuICAgICAgICAgICAgdGhpcy5wcmV2aWV3QnV0dG9uLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVByZXZpZXdEaWFsb2cuc2V0RGF0YSh0aGlzLnRhZ1NlbGVjdC5nZXRWYWx1ZSgpKTtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVByZXZpZXdEaWFsb2cub3BlbigpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8qIFNldHVwIHN5bmMgdGFsayBjaGVja2JveCAqL1xuICAgICAgICAgICAgaWYgKCF0aGlzLnBhZ2VUaXRsZVBhcnNlZC5pc1RhbGtQYWdlKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRhbGtEYXRhID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdxdWVyeScsIGZvcm1hdHZlcnNpb246IDIsIHByb3A6ICdpbmZvJywgdGl0bGVzOiB0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKSB9KSkgYXMgUGFnZUluZm9SZXN1bHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5zeW5jVGFsa0NoZWNrYm94ID0gbmV3IE9PLnVpLkNoZWNrYm94SW5wdXRXaWRnZXQoeyBzZWxlY3RlZDogISF0aGlzLnRhbGtEYXRhLnF1ZXJ5LnBhZ2VzWzBdLnJlZGlyZWN0IH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zeW5jVGFsa0NoZWNrYm94TGF5b3V0ID0gbmV3IE9PLnVpLldpZGdldCh7IGNvbnRlbnQ6IFtuZXcgT08udWkuRmllbGRMYXlvdXQodGhpcy5zeW5jVGFsa0NoZWNrYm94LCB7IGxhYmVsOiAnU3luYyB0YWxrIHBhZ2UnLCBhbGlnbjogJ2lubGluZScgfSldIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc3luY1RhbGtDaGVja2JveExheW91dC4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIFNldHVwIHBhdHJvbCBjaGVja2JveCAqL1xuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMuY2hlY2tTaG91bGRQcm9tcHRQYXRyb2woKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGF0cm9sQ2hlY2tib3ggPSBuZXcgT08udWkuQ2hlY2tib3hJbnB1dFdpZGdldCh7IHNlbGVjdGVkOiB0cnVlIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5wYXRyb2xDaGVja2JveExheW91dCA9IG5ldyBPTy51aS5XaWRnZXQoeyBjb250ZW50OiBbbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHRoaXMucGF0cm9sQ2hlY2tib3gsIHsgbGFiZWw6ICdNYXJrIGFzIHBhdHJvbGxlZCcsIGFsaWduOiAnaW5saW5lJyB9KV0gfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXRyb2xDaGVja2JveExheW91dC4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIFNldHVwIGxheW91dCAqL1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRMYXlvdXQgPSBuZXcgT08udWkuSG9yaXpvbnRhbExheW91dCh7XG4gICAgICAgICAgICAgICAgaXRlbXM6IFt0aGlzLnN1Ym1pdEJ1dHRvbiwgdGhpcy5wcmV2aWV3QnV0dG9uLCB0aGlzLnN5bmNUYWxrQ2hlY2tib3hMYXlvdXQsIHRoaXMucGF0cm9sQ2hlY2tib3hMYXlvdXRdLmZpbHRlcihCb29sZWFuKSBhcyBPTy51aS5XaWRnZXRbXSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRMYXlvdXQuJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERldGVybWluZXMgaWYgdGhlIHVzZXIgc2hvdWxkIGJlIHByb21wdGVkIHRvIHBhdHJvbCB0aGUgcGFnZS5cbiAgICAgICAgICovXG4gICAgICAgIHByaXZhdGUgYXN5bmMgY2hlY2tTaG91bGRQcm9tcHRQYXRyb2woKSB7XG4gICAgICAgICAgICBjb25zdCBwYWdlVHJpYWdlTWFya0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtd2UtcHQtbWFyayAubXdlLXB0LXRvb2wtaWNvbicpIGFzIEhUTUxJbWFnZUVsZW1lbnQgfCBudWxsO1xuICAgICAgICAgICAgcGFnZVRyaWFnZU1hcmtCdXR0b24/LmNsaWNrKCk7XG4gICAgICAgICAgICBwYWdlVHJpYWdlTWFya0J1dHRvbj8uY2xpY2soKTtcblxuICAgICAgICAgICAgaWYgKG13LmNvbmZpZy5nZXQoJ3dnTmFtZXNwYWNlTnVtYmVyJykgIT09IDApIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXRyb2xsaW5rJykpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgZWxzZSBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI213ZS1wdC1tYXJrLWFzLXJldmlld2VkLWJ1dHRvbicpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtd2UtcHQtbWFyay1hcy11bnJldmlld2VkLWJ1dHRvbicpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIW13LmNvbmZpZy5nZXQoJ3dnQXJ0aWNsZUlkJykpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VyUGVybWlzc2lvbnMgPSAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3F1ZXJ5JywgbWV0YTogJ3VzZXJpbmZvJywgdWlwcm9wOiAncmlnaHRzJyB9KSkgYXMgVXNlclBlcm1pc3Npb25zUmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgaWYgKCF1c2VyUGVybWlzc2lvbnMucXVlcnkudXNlcmluZm8ucmlnaHRzLmluY2x1ZGVzKCdwYXRyb2wnKSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcGF0cm9sUmVzcG9uc2UgPSAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3BhZ2V0cmlhZ2VsaXN0JywgcGFnZV9pZDogbXcuY29uZmlnLmdldCgnd2dBcnRpY2xlSWQnKSB9KSkgYXMgUGFnZVRyaWFnZUxpc3RSZXNwb25zZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbmFtaW5nLWNvbnZlbnRpb25cblxuICAgICAgICAgICAgICAgIGlmIChwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5wYWdlc1swXT8udXNlcl9uYW1lID09PSBtdy5jb25maWcuZ2V0KCd3Z1VzZXJOYW1lJykpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5yZXN1bHQgIT09ICdzdWNjZXNzJyB8fCBwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5wYWdlcy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiAhTnVtYmVyLnBhcnNlSW50KHBhdHJvbFJlc3BvbnNlLnBhZ2V0cmlhZ2VsaXN0LnBhZ2VzWzBdPy5wYXRyb2xfc3RhdHVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVcGRhdGVzIHRoZSBzdW1tYXJ5IGlucHV0IHBsYWNlaG9sZGVyLlxuICAgICAgICAgKi9cbiAgICAgICAgcHJpdmF0ZSB1cGRhdGVTdW1tYXJ5KCkge1xuICAgICAgICAgICAgY29uc3QgcmVkaXJlY3RWYWx1ZSA9IHRoaXMucmVkaXJlY3RJbnB1dC5nZXRWYWx1ZSgpLnRyaW0oKTtcblxuICAgICAgICAgICAgaWYgKCFyZWRpcmVjdFZhbHVlKSAodGhpcy5zdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSAnJztcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Q2hhbmdlZCA9IHJlZGlyZWN0VmFsdWUgIT09IHRoaXMub2xkUmVkaXJlY3RUYXJnZXQ/LnJlcGxhY2VBbGwoJ18nLCAnICcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ3NDaGFuZ2VkID0gdGhpcy50YWdTZWxlY3QuZ2V0VmFsdWUoKS5qb2luKCc7JykgIT09IHRoaXMub2xkUmVkaXJlY3RUYWdzPy5qb2luKCc7Jyk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Q2hhbmdlZCAmJiB0YWdzQ2hhbmdlZCkgKHRoaXMuc3VtbWFyeUlucHV0LiR0YWJJbmRleGVkWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnBsYWNlaG9sZGVyID0gYFJldGFyZ2V0IHJlZGlyZWN0IHRvIFtbJHtyZWRpcmVjdFZhbHVlfV1dIGFuZCBjaGFuZ2UgY2F0ZWdvcml6YXRpb24gdGVtcGxhdGVzYDtcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0YXJnZXRDaGFuZ2VkKSAodGhpcy5zdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSBgUmV0YXJnZXQgcmVkaXJlY3QgdG8gW1ske3JlZGlyZWN0VmFsdWV9XV1gO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRhZ3NDaGFuZ2VkKSAodGhpcy5zdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSAnQ2hhbmdlIGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlcyc7XG4gICAgICAgICAgICAgICAgZWxzZSAodGhpcy5zdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSAnUGVyZm9ybSByZWRpcmVjdCBjbGVhbnVwJztcbiAgICAgICAgICAgIH0gZWxzZSAodGhpcy5zdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSBgQ3JlYXRlIHJlZGlyZWN0IHRvIFtbJHtyZWRpcmVjdFZhbHVlfV1dYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2FkcyBleGlzdGluZyBwYWdlIHRhcmdldCwgdGFncywgYW5kIHN0cmF5IHRleHQuXG4gICAgICAgICAqL1xuICAgICAgICBwcml2YXRlIGFzeW5jIGxvYWRFeGlzdGluZ0RhdGEoKSB7XG4gICAgICAgICAgICBjb25zdCBwYWdlQ29udGVudCA9IChcbiAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3F1ZXJ5JywgZm9ybWF0dmVyc2lvbjogMiwgcHJvcDogJ3JldmlzaW9ucycsIHJ2cHJvcDogJ2NvbnRlbnQnLCBydnNsb3RzOiAnKicsIHRpdGxlczogdGhpcy5wYWdlVGl0bGUgfSkpIGFzIFBhZ2VSZXZpc2lvbnNSZXN1bHRcbiAgICAgICAgICAgICkucXVlcnkucGFnZXNbMF0ucmV2aXNpb25zWzBdLnNsb3RzLm1haW4uY29udGVudC50cmltKCk7XG5cbiAgICAgICAgICAgIHRoaXMub2xkUmVkaXJlY3RUYXJnZXQgPSAvXiNyZWRpcmVjdDo/XFxzKlxcW1xcW1xccyooW15bXFxde3x9XSs/KVxccyooPzpcXHxbXltcXF17fH1dKz8pP11dXFxzKi9pLmV4ZWMocGFnZUNvbnRlbnQpPy5bMV07XG4gICAgICAgICAgICB0aGlzLm9sZFJlZGlyZWN0VGFncyA9IChcbiAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyh0aGlzLnJlZGlyZWN0VGVtcGxhdGVzKVxuICAgICAgICAgICAgICAgICAgICAubWFwKChbdGFnLCByZWRpcmVjdHNdKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgW3RhZywgLi4ucmVkaXJlY3RzXS5zb21lKCh0YWdPclJlZGlyZWN0KSA9PiBuZXcgUmVnRXhwKGB7e1xcXFxzKlske3RhZ09yUmVkaXJlY3RbMF0udG9Mb3dlckNhc2UoKX0ke3RhZ09yUmVkaXJlY3RbMF19XSR7dGFnT3JSZWRpcmVjdC5zbGljZSgxKX1cXFxccyooXFxcXHx8fX0pYCkudGVzdChwYWdlQ29udGVudCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0YWdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKSBhcyBzdHJpbmdbXVxuICAgICAgICAgICAgKS5zb3J0KChhLCBiKSA9PiBhLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShiLnRvTG93ZXJDYXNlKCkpKTtcblxuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxSZWRpcmVjdFRhZ3MgPSBPYmplY3QuZW50cmllcyh0aGlzLnJlZGlyZWN0VGVtcGxhdGVzKVxuICAgICAgICAgICAgICAgIC5mbGF0TWFwKChbdGFnLCByZWRpcmVjdHNdKSA9PiBbdGFnLCAuLi5yZWRpcmVjdHNdKVxuICAgICAgICAgICAgICAgIC5tYXAoKHRhZ09yUmVkaXJlY3QpID0+IChuZXcgUmVnRXhwKGB7e1xcXFxzKlske3RhZ09yUmVkaXJlY3RbMF0udG9Mb3dlckNhc2UoKX0ke3RhZ09yUmVkaXJlY3RbMF19XSR7dGFnT3JSZWRpcmVjdC5zbGljZSgxKX1cXFxccyooXFxcXHx8fX0pYCkudGVzdChwYWdlQ29udGVudCkgPyB0YWdPclJlZGlyZWN0IDogbnVsbCkpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKSBhcyBzdHJpbmdbXTtcblxuICAgICAgICAgICAgdGhpcy5vbGRSZWRpcmVjdFRhZ0RhdGEgPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxSZWRpcmVjdFRhZ3NcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgodGFnKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IG5ldyBSZWdFeHAoYHt7XFxcXHMqWyR7dGFnWzBdLnRvTG93ZXJDYXNlKCl9JHt0YWdbMF19XSR7dGFnLnNsaWNlKDEpfVxcXFx8PyguKj8pXFxcXHMqfX1gKS5leGVjKHBhZ2VDb250ZW50KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VGFnID0gT2JqZWN0LmVudHJpZXModGhpcy5yZWRpcmVjdFRlbXBsYXRlcykuZmluZCgoW3RlbXBsYXRlLCByZWRpcmVjdHNdKSA9PiBbdGVtcGxhdGUsIC4uLnJlZGlyZWN0c10uaW5jbHVkZXModGFnKSk/LlswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoID8gW25ld1RhZywgbWF0Y2hbMV1dIDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKSBhcyBbc3RyaW5nLCBzdHJpbmddW10sXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLm9sZFN0cmF5VGV4dCA9IFtcbiAgICAgICAgICAgICAgICBwYWdlQ29udGVudC5tYXRjaCgve3tzaG9ydCBkZXNjcmlwdGlvblxcfC4qP319L2kpPy5bMF0sXG4gICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7RElTUExBWVRJVExFOi4qP319Lyk/LlswXSxcbiAgICAgICAgICAgICAgICBwYWdlQ29udGVudC5tYXRjaCgve3tpdGFsaWMgdGl0bGVcXHw/Lio/fX0vaSk/LlswXSxcbiAgICAgICAgICAgICAgICBwYWdlQ29udGVudC5tYXRjaCgve3tERUZBVUxUU09SVDouKj99fS8pPy5bMF0sXG4gICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7dGl0bGUgbGFuZ3VhZ2VcXHwuKj99fS8pPy5bMF0sXG4gICAgICAgICAgICAgICAgLi4uKHBhZ2VDb250ZW50Lm1hdGNoKC9cXFtcXFtbQ2NdYXRlZ29yeTouKz9dXS9nKSA/PyBbXSksXG4gICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAgICAgICAgIC5qb2luKCdcXG4nKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMub2xkUmVkaXJlY3RUYXJnZXQpIHRoaXMucmVkaXJlY3RJbnB1dC5zZXRWYWx1ZSh0aGlzLm9sZFJlZGlyZWN0VGFyZ2V0LnJlcGxhY2VBbGwoJ18nLCAnICcpKTtcbiAgICAgICAgICAgIGVsc2UgbXcubm90aWZ5KCdDb3VsZCBub3QgZmluZCByZWRpcmVjdCB0YXJnZXQhJywgeyB0eXBlOiAnZXJyb3InIH0pO1xuICAgICAgICAgICAgdGhpcy50YWdTZWxlY3Quc2V0VmFsdWUodGhpcy5vbGRSZWRpcmVjdFRhZ3MpO1xuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN1bW1hcnkoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTdWJtaXNzaW9uKCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JzID0gW107XG5cbiAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uID0gdGhpcy5yZWRpcmVjdElucHV0LmdldFZhbHVlKCkudHJpbSgpO1xuXG4gICAgICAgICAgICAvKiBJbnZhbGlkIGNoYXJhY3RlcnMgKi9cbiAgICAgICAgICAgIGlmICghL15cXHMqW15bXFxde3x9XStcXHMqJC8udGVzdChkZXN0aW5hdGlvbikpIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiAnaXMgbm90IGEgdmFsaWQgcGFnZSB0aXRsZSEnIH0pO1xuXG4gICAgICAgICAgICAvKiBGYWlsZWQgZHVyaW5nIHRpdGxlIHBhcnNpbmcgKi9cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJzZWREZXN0aW5hdGlvbiA9IG13LlRpdGxlLm5ld0Zyb21UZXh0KGRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcnMubGVuZ3RoID09PSAwKSBlcnJvcnMucHVzaCh7IHRpdGxlOiBkZXN0aW5hdGlvbiwgbWVzc2FnZTogJ2lzIG5vdCBhIHZhbGlkIHBhZ2UgdGl0bGUhJyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJzZWREZXN0aW5hdGlvbiAmJiBlcnJvcnMubGVuZ3RoID09PSAwKSBlcnJvcnMucHVzaCh7IHRpdGxlOiBkZXN0aW5hdGlvbiwgbWVzc2FnZTogJ2lzIG5vdCBhIHZhbGlkIHBhZ2UgdGl0bGUhJyB9KTtcblxuICAgICAgICAgICAgLyogU2VsZiByZWRpcmVjdHMgKi9cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcnNlZERlc3RpbmF0aW9uPy50b1N0cmluZygpID09PSB0aGlzLnBhZ2VUaXRsZVBhcnNlZC50b1N0cmluZygpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdjYW5ub3QgcmVkaXJlY3QgdG8gaXRzZWxmIScgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uRGF0YSA9IChhd2FpdCBuZXcgbXcuQXBpKCkuZ2V0KHsgYWN0aW9uOiAncXVlcnknLCBmb3JtYXR2ZXJzaW9uOiAyLCBwcm9wOiAncGFnZXByb3BzJywgdGl0bGVzOiBkZXN0aW5hdGlvbiB9KS5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAvKiBOb25leGlzdGVudCBkZXN0aW5hdGlvbiAqLyBpZiAoZXJyb3JDb2RlID09PSAnbWlzc2luZ3RpdGxlJykgZXJyb3JzLnB1c2goeyB0aXRsZTogZGVzdGluYXRpb24sIG1lc3NhZ2U6ICdkb2VzIG5vdCBleGlzdCEnIH0pO1xuICAgICAgICAgICAgICAgIC8qIE90aGVyIEFQSSBlcnJvciAqLyBlbHNlIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiBgd2FzIG5vdCBhYmxlIHRvIGJlIGZldGNoZWQgZnJvbSB0aGUgQVBJICgke2Vycm9yQ29kZX0pIWAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9KSkgYXMgUGFnZXByb3BzUmVzdWx0IHwgbnVsbDtcbiAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uUGFyc2VSZXN1bHQgPSAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3BhcnNlJywgcGFnZTogZGVzdGluYXRpb24sIHByb3A6ICdzZWN0aW9ucycsIHJlZGlyZWN0czogJzEnIH0pKSBhcyBQYWdlUGFyc2VSZXN1bHQ7XG5cbiAgICAgICAgICAgIC8qIERvdWJsZSByZWRpcmVjdHMgKi9cbiAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvblBhcnNlUmVzdWx0LnBhcnNlLnJlZGlyZWN0cz8uWzBdKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb25SZWRpcmVjdCA9XG4gICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uUGFyc2VSZXN1bHQucGFyc2UucmVkaXJlY3RzWzBdLnRvICsgKGRlc3RpbmF0aW9uUGFyc2VSZXN1bHQucGFyc2UucmVkaXJlY3RzWzBdLnRvZnJhZ21lbnQgPyBgIyR7ZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5yZWRpcmVjdHNbMF0udG9mcmFnbWVudH1gIDogJycpO1xuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGRlc3RpbmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBgaXMgYSByZWRpcmVjdCB0byA8YSBocmVmPVwiJHttdy51dGlsLmdldFVybChcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uUmVkaXJlY3QsXG4gICAgICAgICAgICAgICAgICAgICl9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtkZXN0aW5hdGlvblJlZGlyZWN0fTwvYT4uIFJldGFyZ2V0IHRvIHRoYXQgcGFnZSBpbnN0ZWFkLCBhcyBkb3VibGUgcmVkaXJlY3RzIGFyZW4ndCBhbGxvd2VkLmAsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIE5vbmV4aXN0ZW50IHNlY3Rpb24gKi9cbiAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvbi5zcGxpdCgnIycpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWxpZFNlY3Rpb24gPSBkZXN0aW5hdGlvblBhcnNlUmVzdWx0LnBhcnNlLnNlY3Rpb25zLmZpbmQoKHNlY3Rpb24pID0+IHNlY3Rpb24ubGluZSA9PT0gZGVzdGluYXRpb24uc3BsaXQoJyMnKVsxXSk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkU2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcygnUiB0byBhbmNob3InKSkgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgdGFnZ2VkIGFzIGEgcmVkaXJlY3QgdG8gYW4gYW5jaG9yLCBidXQgaXQgaXMgYWN0dWFsbHkgYSByZWRpcmVjdCB0byBhIHNlY3Rpb24hJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIHNlY3Rpb24nKSkgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgYSByZWRpcmVjdCB0byBhIHNlY3Rpb24sIGJ1dCBpdCBpcyBub3QgdGFnZ2VkIHdpdGggPGNvZGU+e3tSIHRvIHNlY3Rpb259fTwvY29kZT4hJyB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXN0aW5hdGlvbkNvbnRlbnQgPSAoXG4gICAgICAgICAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHZlcnNpb246IDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogJ3JldmlzaW9ucycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnZwcm9wOiAnY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnZzbG90czogJyonLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlczogdGhpcy5wYXJzZWREZXN0aW5hdGlvbiEudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSBhcyBQYWdlUmV2aXNpb25zUmVzdWx0XG4gICAgICAgICAgICAgICAgICAgICkucXVlcnkucGFnZXNbMF0ucmV2aXNpb25zWzBdLnNsb3RzLm1haW4uY29udGVudDtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhbmNob3JzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uKGRlc3RpbmF0aW9uQ29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXRjaCgvKD88PXt7XFxzKj9bQWFdKD86bmNob3JzP3xuY2hvciBmb3IgcmVkaXJlY3R8bmtlcnxOQ0hPUnxuYylcXHMqP1xcfCkuKz8oPz19fSkvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Lm1hcCgoYW5jaG9yOiBzdHJpbmcpID0+IGFuY2hvci5zcGxpdCgnfCcpLm1hcCgocGFydCkgPT4gcGFydC50cmltKCkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8uZmxhdCgpID8/IFtdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLihkZXN0aW5hdGlvbkNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWF0Y2goLyg/PD17e1xccyo/KD86W1Z2XSg/OmlzaWJsZSBhbmNob3JzP3xpc2FuY3xBbmNofGFuY2hvcnxpc2libGVhbmNob3J8YSl8W0FhXSg/Om5jaG9yZHxjaG9yZWR8bmNob3JcXCspfFtUdF1leHQgYW5jaG9yKVxccyo/XFx8KS4rPyg/PSg/PCEhfD0pfX0pL2cpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPy5tYXAoKGFuY2hvcjogc3RyaW5nKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnfCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKChwYXJ0KSA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKHBhcnQpID0+ICEvXnRleHRcXHMqPz0vLnRlc3QocGFydCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/LmZsYXQoKSA/PyBbXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4oZGVzdGluYXRpb25Db250ZW50Lm1hdGNoKC8oPzw9aWQ9KVwiPy4rPyg/PVwifD58XFx8KS9nKT8ubWFwKChhbmNob3I6IHN0cmluZykgPT4gYW5jaG9yLnRyaW0oKSkgPz8gW10pLFxuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYW5jaG9ycy5pbmNsdWRlcyhkZXN0aW5hdGlvbi5zcGxpdCgnIycpWzFdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gc2VjdGlvbicpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdpcyB0YWdnZWQgYXMgYSByZWRpcmVjdCB0byBhIHNlY3Rpb24sIGJ1dCBpdCBpcyBhY3R1YWxseSBhIHJlZGlyZWN0IHRvIGFuIGFuY2hvciEnIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIGFuY2hvcicpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdpcyBhIHJlZGlyZWN0IHRvIGFuIGFuY2hvciwgYnV0IGl0IGlzIG5vdCB0YWdnZWQgd2l0aCA8Y29kZT57e1IgZnJvbSBhbmNob3J9fTwvY29kZT4hJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogYGlzIGEgcmVkaXJlY3QgdG8gPGEgaHJlZj1cIiR7bXcudXRpbC5nZXRVcmwoZGVzdGluYXRpb24pfVwiIHRhcmdldD1cIl9ibGFua1wiPiR7ZGVzdGluYXRpb259PC9hPiwgYnV0IHRoYXQgc2VjdGlvbiBvciBhbmNob3IgZG9lcyBub3QgZXhpc3QhYCB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIEltcHJvcGVybHkgdGFnZ2VkIGFzIHJlZGlyZWN0IHRvIHNlY3Rpb24vYW5jaG9yICovXG4gICAgICAgICAgICBpZiAoZGVzdGluYXRpb24uc3BsaXQoJyMnKS5sZW5ndGggPT09IDEgJiYgKHRoaXMudGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gc2VjdGlvbicpIHx8IHRoaXMudGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gYW5jaG9yJykpKVxuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogJ2lzIG5vdCBhIHJlZGlyZWN0IHRvIGEgc2VjdGlvbi9hbmNob3IsIGJ1dCBpdCBpcyB0YWdnZWQgd2l0aCA8Y29kZT57e1IgZnJvbSBzZWN0aW9ufX08L2NvZGU+IG9yIDxjb2RlPnt7UiBmcm9tIGFuY2hvcn19PC9jb2RlPiEnIH0pO1xuXG4gICAgICAgICAgICAvKiBSZWRpcmVjdCB0byBkaXNhbWJpZ3VhdGlvbiBwYWdlIHdpdGhvdXQgdGVtcGxhdGUgKi9cbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkRhdGEhLnF1ZXJ5LnBhZ2VzWzBdLnBhZ2Vwcm9wcyAmJlxuICAgICAgICAgICAgICAgICdkaXNhbWJpZ3VhdGlvbicgaW4gZGVzdGluYXRpb25EYXRhIS5xdWVyeS5wYWdlc1swXS5wYWdlcHJvcHMgJiZcbiAgICAgICAgICAgICAgICAhW1xuICAgICAgICAgICAgICAgICAgICAnUiBmcm9tIGFtYmlndW91cyBzb3J0IG5hbWUnLFxuICAgICAgICAgICAgICAgICAgICAnUiBmcm9tIGFtYmlndW91cyB0ZXJtJyxcbiAgICAgICAgICAgICAgICAgICAgJ1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZScsXG4gICAgICAgICAgICAgICAgICAgICdSIGZyb20gaW5jb21wbGV0ZSBkaXNhbWJpZ3VhdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICdSIGZyb20gaW5jb3JyZWN0IGRpc2FtYmlndWF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgJ1IgZnJvbSBvdGhlciBkaXNhbWJpZ3VhdGlvbicsXG4gICAgICAgICAgICAgICAgXS5zb21lKCh0ZW1wbGF0ZSkgPT4gdGhpcy50YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcyh0ZW1wbGF0ZSkpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgYSByZWRpcmVjdCB0byBhIGRpc2FtYmlndWF0aW9uIHBhZ2UsIGJ1dCBpdCBpcyBub3QgdGFnZ2VkIHdpdGggYSBkaXNhbWJpZ3VhdGlvbiBjYXRlZ29yaXphdGlvbiB0ZW1wbGF0ZSEnIH0pO1xuXG4gICAgICAgICAgICAvKiBJbXByb3Blcmx5IHRhZ2dlZCBhcyByZWRpcmVjdCB0byBkaXNhbWJpZ3VhdGlvbiBwYWdlICovXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb25EYXRhIS5xdWVyeS5wYWdlc1swXS5wYWdlcHJvcHMgJiZcbiAgICAgICAgICAgICAgICAhKCdkaXNhbWJpZ3VhdGlvbicgaW4gZGVzdGluYXRpb25EYXRhIS5xdWVyeS5wYWdlc1swXS5wYWdlcHJvcHMpICYmXG4gICAgICAgICAgICAgICAgWydSIGZyb20gYW1iaWd1b3VzIHNvcnQgbmFtZScsICdSIGZyb20gYW1iaWd1b3VzIHRlcm0nLCAnUiB0byBkaXNhbWJpZ3VhdGlvbiBwYWdlJywgJ1IgZnJvbSBpbmNvbXBsZXRlIGRpc2FtYmlndWF0aW9uJ10uc29tZSgodGVtcGxhdGUpID0+IHRoaXMudGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXModGVtcGxhdGUpKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogJ2lzIG5vdCBhIHJlZGlyZWN0IHRvIGEgZGlzYW1iaWd1YXRpb24gcGFnZSwgYnV0IGl0IGlzIHRhZ2dlZCB3aXRoIGEgZGlzYW1iaWd1YXRpb24gY2F0ZWdvcml6YXRpb24gdGVtcGxhdGUhJyB9KTtcblxuICAgICAgICAgICAgLyoge3tSIHRvIGRpc2FtYmlndWF0aW9uIHBhZ2V9fSB3aXRob3V0IFwiIChkaXNhbWJpZ3VhdGlvbilcIiBhdCBlbmQgb2YgdGl0bGUgKi9cbiAgICAgICAgICAgIGlmICh0aGlzLnRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIGRpc2FtYmlndWF0aW9uIHBhZ2UnKSAmJiAhdGhpcy5wYWdlVGl0bGVQYXJzZWQuZ2V0TWFpblRleHQoKS5lbmRzV2l0aCgnIChkaXNhbWJpZ3VhdGlvbiknKSlcbiAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6XG4gICAgICAgICAgICAgICAgICAgICAgICAnaXMgdGFnZ2VkIHdpdGggPGNvZGU+e3tSIHRvIGRpc2FtYmlndWF0aW9uIHBhZ2V9fTwvY29kZT4sIGJ1dCB0aGlzIHRpdGxlIGRvZXMgbm90IGVuZCB3aXRoIFwiIChkaXNhbWJpZ3VhdGlvbilcIi4gVXNlIDxjb2RlPnt7UiBmcm9tIGFtYmlndW91cyB0ZXJtfX08L2NvZGU+IG9yIGEgc2ltaWxhciBjYXRlZ29yaXphdGlvbiB0ZW1wbGF0ZSBpbnN0ZWFkIScsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8qIFRhZ2dlZCB3aXRoIGEgcHJvdGVjdGlvbiB0ZW1wbGF0ZSAqL1xuICAgICAgICAgICAgZm9yIChjb25zdCB0ZW1wbGF0ZSBvZiBbJ1Igc2VtaS1wcm90ZWN0ZWQnLCAnUiBleHRlbmRlZC1wcm90ZWN0ZWQnLCAnUiB0ZW1wbGF0ZS1wcm90ZWN0ZWQnLCAnUiBmdWxseSBwcm90ZWN0ZWQnXSlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcyh0ZW1wbGF0ZSkpXG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogYGlzIHRhZ2dlZCB3aXRoIHVubmVjZXNzYXJpbHkgdGFnZ2VkIHdpdGggPGNvZGU+e3ske3RlbXBsYXRlfX19PC9jb2RlPiB3aGljaCB3aWxsIGJlIGR1cGxpY2F0ZWQgYnkgdGhlIHJlZGlyZWN0IGNhdGVnb3J5IHNoZWxsIWAgfSk7XG5cbiAgICAgICAgICAgIC8qIFN5bmNpbmcgdGFsayBwYWdlIGJ1dCB0YWxrIHBhZ2UgZXhpc3RzIGFuZCBpc24ndCBhIHJlZGlyZWN0ICovXG4gICAgICAgICAgICBpZiAodGhpcy5zeW5jVGFsa0NoZWNrYm94Py5pc1NlbGVjdGVkKCkgJiYgIXRoaXMudGFsa0RhdGEhLnF1ZXJ5LnBhZ2VzWzBdLm1pc3NpbmcgJiYgIXRoaXMudGFsa0RhdGEhLnF1ZXJ5LnBhZ2VzWzBdLnJlZGlyZWN0KVxuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgdGl0bGU6IHRoaXMucGFnZVRpdGxlUGFyc2VkLmdldFRhbGtQYWdlKCkhLmdldFByZWZpeGVkVGV4dCgpLCBtZXNzYWdlOiAnZXhpc3RzLCBidXQgaXMgbm90IGEgcmVkaXJlY3QhJyB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGVycm9ycztcbiAgICAgICAgfVxuXG4gICAgICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlU3VibWl0QnV0dG9uQ2xpY2soKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgW3RoaXMucmVkaXJlY3RJbnB1dCwgdGhpcy50YWdTZWxlY3QsIHRoaXMuc3VtbWFyeUlucHV0LCB0aGlzLnN1Ym1pdEJ1dHRvbiwgdGhpcy5wcmV2aWV3QnV0dG9uLCB0aGlzLnN5bmNUYWxrQ2hlY2tib3gsIHRoaXMucGF0cm9sQ2hlY2tib3hdLmZpbHRlcihCb29sZWFuKSlcbiAgICAgICAgICAgICAgICAoZWxlbWVudCBhcyBPTy51aS5XaWRnZXQpLnNldERpc2FibGVkKHRydWUpO1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24uc2V0TGFiZWwoJ0NoZWNraW5nIHRhcmdldCB2YWxpZGl0eS4uLicpO1xuXG4gICAgICAgICAgICBsZXQgZXJyb3JzOiBBd2FpdGVkPFJldHVyblR5cGU8dHlwZW9mIHRoaXMudmFsaWRhdGVTdWJtaXNzaW9uPj4gPSBbXTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5lZWRzQ2hlY2spIGVycm9ycyA9IGF3YWl0IHRoaXMudmFsaWRhdGVTdWJtaXNzaW9uKCk7XG4gICAgICAgICAgICBlbHNlIHRoaXMucGFyc2VkRGVzdGluYXRpb24gPSBtdy5UaXRsZS5uZXdGcm9tVGV4dCh0aGlzLnJlZGlyZWN0SW5wdXQuZ2V0VmFsdWUoKSk7XG5cbiAgICAgICAgICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmVkaXJlY3QtaGVscGVyLXdhcm5pbmcnKSkgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHsgdGl0bGUsIG1lc3NhZ2UgfSBvZiBlcnJvcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBuZXcgT08udWkuSHRtbFNuaXBwZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBgJHt0aXRsZSA/IGA8YSBocmVmPVwiJHttdy51dGlsLmdldFVybCh0aXRsZSl9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHt0aXRsZX08L2E+YCA6ICdUaGlzIHBhZ2UnfSAke21lc3NhZ2V9IENsaWNrIGFnYWluIHdpdGhvdXQgbWFraW5nIGNoYW5nZXMgdG8gc3VibWl0IGFueXdheS5gLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB3YXJuaW5nTWVzc2FnZSA9IG5ldyBPTy51aS5NZXNzYWdlV2lkZ2V0KHsgdHlwZTogJ2Vycm9yJywgY2xhc3NlczogWydyZWRpcmVjdC1oZWxwZXItd2FybmluZyddLCBpbmxpbmU6IHRydWUsIGxhYmVsIH0pO1xuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTWVzc2FnZS4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4JztcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvckJveC4kZWxlbWVudFswXS5hcHBlbmQod2FybmluZ01lc3NhZ2UuJGVsZW1lbnRbMF0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBbdGhpcy5yZWRpcmVjdElucHV0LCB0aGlzLnRhZ1NlbGVjdCwgdGhpcy5zdW1tYXJ5SW5wdXQsIHRoaXMuc3VibWl0QnV0dG9uLCB0aGlzLnN5bmNUYWxrQ2hlY2tib3gsIHRoaXMucGF0cm9sQ2hlY2tib3hdLmZpbHRlcihCb29sZWFuKSlcbiAgICAgICAgICAgICAgICAgICAgKGVsZW1lbnQgYXMgT08udWkuV2lkZ2V0KS5zZXREaXNhYmxlZChmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy50YWdTZWxlY3QuZ2V0VmFsdWUoKS5sZW5ndGggPiAwKSB0aGlzLnByZXZpZXdCdXR0b24uc2V0RGlzYWJsZWQoZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24uc2V0TGFiZWwoJ1N1Ym1pdCBhbnl3YXknKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5lZWRzQ2hlY2sgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogRWRpdC9jcmVhdGUgcmVkaXJlY3QgKi9cbiAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnNldExhYmVsKGAke3RoaXMuZXhpc3RzID8gJ0VkaXRpbmcnIDogJ0NyZWF0aW5nJ30gcmVkaXJlY3QuLi5gKTtcblxuICAgICAgICAgICAgY29uc3Qgb3V0cHV0ID0gW1xuICAgICAgICAgICAgICAgIGAjUkVESVJFQ1QgW1ske3RoaXMucmVkaXJlY3RJbnB1dC5nZXRWYWx1ZSgpLnRyaW0oKX1dXWAsIC8vXG4gICAgICAgICAgICAgICAgdGhpcy50YWdTZWxlY3QuZ2V0VmFsdWUoKS5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgICAgID8gYHt7UmVkaXJlY3QgY2F0ZWdvcnkgc2hlbGx8XFxuJHsodGhpcy50YWdTZWxlY3QuZ2V0VmFsdWUoKSBhcyBzdHJpbmdbXSkubWFwKCh0YWcpID0+IGB7eyR7dGFnfSR7dGhpcy5vbGRSZWRpcmVjdFRhZ0RhdGE/Llt0YWddID8gYHwke3RoaXMub2xkUmVkaXJlY3RUYWdEYXRhW3RhZ119YCA6ICcnfX19YCkuam9pbignXFxuJyl9XFxufX1gXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgICAgICAgICB0aGlzLm9sZFN0cmF5VGV4dCxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgICAgICAgLmpvaW4oJ1xcblxcbicpO1xuXG4gICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0gKHRoaXMuc3VtbWFyeUlucHV0LmdldFZhbHVlKCkgfHwgKHRoaXMuc3VtbWFyeUlucHV0LiR0YWJJbmRleGVkWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnBsYWNlaG9sZGVyKSArICcgKHZpYSBbW1VzZXI6RWVqaXQ0My9zY3JpcHRzL3JlZGlyZWN0LWhlbHBlcnxyZWRpcmVjdC1oZWxwZXJdXSknO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAuZWRpdCh0aGlzLnBhZ2VUaXRsZSwgKCkgPT4gKHsgdGV4dDogb3V0cHV0LCBzdW1tYXJ5IH0pKVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9ySW5mbzogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvckNvZGUgPT09ICdub2NyZWF0ZS1taXNzaW5nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbXcuQXBpKCkuY3JlYXRlKHRoaXMucGFnZVRpdGxlLCB7IHN1bW1hcnkgfSwgb3V0cHV0KS5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9ySW5mbzogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBjcmVhdGluZyAke3RoaXMucGFnZVRpdGxlfTogJHtlcnJvckluZm8/LmVycm9yLmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeShgRXJyb3IgZWRpdGluZyBvciBjcmVhdGluZyAke3RoaXMucGFnZVRpdGxlfTogJHtlcnJvckluZm8/LmVycm9yLmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XG5cbiAgICAgICAgICAgIG13Lm5vdGlmeShgUmVkaXJlY3QgJHt0aGlzLmV4aXN0cyA/ICdlZGl0ZWQnIDogJ2NyZWF0ZWQnfSBzdWNjZXNzZnVsbHkhYCwgeyB0eXBlOiAnc3VjY2VzcycgfSk7XG5cbiAgICAgICAgICAgIC8qIFN5bmMgdGFsayBwYWdlIGNoZWNrYm94IGhhbmRsZXIgKi9cbiAgICAgICAgICAgIGlmICh0aGlzLnN5bmNUYWxrQ2hlY2tib3g/LmlzU2VsZWN0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnNldExhYmVsKCdFZGl0aW5nIHRhbGsgcGFnZS4uLicpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZnJvbU1vdmUgPSB0aGlzLnRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIGZyb20gbW92ZScpO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0ID0gW1xuICAgICAgICAgICAgICAgICAgICBgI1JFRElSRUNUIFtbJHt0aGlzLnBhcnNlZERlc3RpbmF0aW9uIS5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKX1dXWAsIC8vXG4gICAgICAgICAgICAgICAgICAgIGZyb21Nb3ZlID8gJ3t7UmVkaXJlY3QgY2F0ZWdvcnkgc2hlbGx8XFxue3tSIGZyb20gbW92ZX19XFxufX0nIDogbnVsbCxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJ1xcblxcbicpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdGFsa1BhZ2UgPSB0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRhbGtSZXN1bHQgPSBhd2FpdCBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgLmVkaXQodGFsa1BhZ2UsICgpID0+ICh7IHRleHQ6IG91dHB1dCwgc3VtbWFyeTogJ1N5bmNpbmcgcmVkaXJlY3QgZnJvbSBtYWluIHBhZ2UgKHZpYSBbW1VzZXI6RWVqaXQ0My9zY3JpcHRzL3JlZGlyZWN0LWhlbHBlcnxyZWRpcmVjdC1oZWxwZXJdXSknIH0pKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yQ29kZTogc3RyaW5nLCBlcnJvckluZm86IE1lZGlhV2lraURhdGFFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yQ29kZSA9PT0gJ25vY3JlYXRlLW1pc3NpbmcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNyZWF0ZSh0YWxrUGFnZSwgeyBzdW1tYXJ5OiAnU3luY2luZyByZWRpcmVjdCBmcm9tIG1haW4gcGFnZSAodmlhIFtbVXNlcjpFZWppdDQzL3NjcmlwdHMvcmVkaXJlY3QtaGVscGVyfHJlZGlyZWN0LWhlbHBlcl1dKScgfSwgb3V0cHV0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yQ29kZTogc3RyaW5nLCBlcnJvckluZm86IE1lZGlhV2lraURhdGFFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBjcmVhdGluZyAke3RhbGtQYWdlfTogJHtlcnJvckluZm8/LmVycm9yLmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoYEVycm9yIGVkaXRpbmcgb3IgY3JlYXRpbmcgJHt0YWxrUGFnZX06ICR7ZXJyb3JJbmZvPy5lcnJvci5pbmZvID8/ICdVbmtub3duIGVycm9yJ30gKCR7ZXJyb3JDb2RlfSlgLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0YWxrUmVzdWx0KSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBtdy5ub3RpZnkoJ1RhbGsgcGFnZSBzeW5jZWQgc3VjY2Vzc2Z1bGx5IScsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBQYXRyb2wgY2hlY2tib3ggaGFuZGxlciAqL1xuICAgICAgICAgICAgaWYgKHRoaXMucGF0cm9sQ2hlY2tib3g/LmlzU2VsZWN0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnNldExhYmVsKCdQYXRyb2xsaW5nIHJlZGlyZWN0Li4uJyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBwYXRyb2xMaW5rOiBIVE1MQW5jaG9yRWxlbWVudCB8IG51bGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGF0cm9sbGluayBhJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFya1Jldmlld2VkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI213ZS1wdC1tYXJrLWFzLXJldmlld2VkLWJ1dHRvbicpIGFzIEhUTUxCdXR0b25FbGVtZW50IHwgbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmIChwYXRyb2xMaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdHJvbFJlc3VsdCA9IGF3YWl0IG5ldyBtdy5BcGkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBvc3RXaXRoVG9rZW4oJ3BhdHJvbCcsIHsgYWN0aW9uOiAncGF0cm9sJywgcmNpZDogbmV3IFVSTChwYXRyb2xMaW5rLmhyZWYpLnNlYXJjaFBhcmFtcy5nZXQoJ3JjaWQnKSEgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9ySW5mbzogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBwYXRyb2xsaW5nICR7dGhpcy5wYWdlVGl0bGV9IHZpYSBBUEk6ICR7ZXJyb3JJbmZvPy5lcnJvci5pbmZvID8/ICdVbmtub3duIGVycm9yJ30gKCR7ZXJyb3JDb2RlfSlgLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhdHJvbFJlc3VsdCkgbXcubm90aWZ5KCdSZWRpcmVjdCBwYXRyb2xsZWQgc3VjY2Vzc2Z1bGx5IScsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFya1Jldmlld2VkQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtSZXZpZXdlZEJ1dHRvbi5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoJ1JlZGlyZWN0IHBhdHJvbGxlZCBzdWNjZXNzZnVsbHkhJywgeyB0eXBlOiAnc3VjY2VzcycgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIG13Lm5vdGlmeSgnUGFnZSBjdXJhdGlvbiB0b29sYmFyIG5vdCBmb3VuZCwgcmVkaXJlY3QgY2Fubm90IGJlIHBhdHJvbGxlZCEnLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnNldExhYmVsKCdDb21wbGV0ZSwgcmVsb2FkaW5nLi4uJyk7XG5cbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbXcudXRpbC5nZXRVcmwodGhpcy5wYWdlVGl0bGUsIHsgcmVkaXJlY3Q6ICdubycgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZXcgUmVkaXJlY3RIZWxwZXIoKS5ydW4oKTtcbn0pO1xuIl0sCiAgIm1hcHBpbmdzIjogImFBR0EsR0FBRyxPQUFPLE1BQU0sQ0FBQyxpQkFBa0IsZUFBZ0Isa0JBQW1CLGtCQUFtQiwrQkFBZ0MsbUNBQW1DLEVBQUcsSUFBTSxDQU9qSyxNQUFNQSxVQUE0QixHQUFHLEdBQUcsZUFBZ0IsQ0FHcEQsWUFBWUMsRUFBbUNDLEVBQTJCLENBQ3RFLE1BQU1ELENBQU0sRUFDWixHQUFHLEdBQUcsTUFBTSxjQUFjLEtBQUssS0FBOENBLENBQU0sRUFFbkYsS0FBSyxnQkFBa0JDLENBQzNCLENBRUEsa0JBQW1C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b0MsQ0FBRSxLQUFNLFNBQVUsQ0FBQyxFQUM1RWUsR0FDUEEsRUFBbUIsTUFBTSxFQUN6QixHQUFHLE9BQU8sbUNBQW9DLENBQUUsS0FBTSxTQUFVLENBQUMsR0FDOUQsR0FBRyxPQUFPLGlFQUFrRSxDQUFFLEtBQU0sT0FBUSxDQUFDLENBQ3hHLENBRUEsS0FBSyxhQUFhLFNBQVMsd0JBQXdCLEVBRW5ELE9BQU8sU0FBUyxLQUFPLEdBQUcsS0FBSyxPQUFPLEtBQUssVUFBVyxDQUFFLFNBQVUsSUFBSyxDQUFDLEVBQzVFLENBQ0osQ0FFQSxJQUFJaEQsRUFBZSxFQUFFLElBQUksQ0FDN0IsQ0FBQyIsCiAgIm5hbWVzIjogWyJSZWRpcmVjdElucHV0V2lkZ2V0IiwgImNvbmZpZyIsICJwYWdlVGl0bGVQYXJzZWQiLCAidmFsdWUiLCAiZGVmZXJyZWQiLCAidGl0bGUiLCAicmVzdWx0IiwgIm1hdGNoZWRTZWN0aW9ucyIsICJzZWN0aW9uIiwgInBhcnNlZFRpdGxlIiwgInBhZ2UiLCAicmVzcG9uc2UiLCAiZGF0YSIsICJsYWJlbCIsICJUZW1wbGF0ZVByZXZpZXdEaWFsb2ciLCAicG9zdENvbmZpZyIsICJ0YWciLCAiY29udGVudCIsICJwYW5lbExheW91dCIsICJhY3Rpb24iLCAiUmVkaXJlY3RIZWxwZXIiLCAicGFnZUluZm8iLCAiZGlhbG9nSW5mbyIsICJidXR0b24iLCAiUmVkaXJlY3RIZWxwZXJEaWFsb2ciLCAicG9ydGxldExpbmsiLCAiZXZlbnQiLCAicmVkaXJlY3RUZW1wbGF0ZXMiLCAiY29udGVudFRleHQiLCAicGFnZVRpdGxlIiwgImV4aXN0cyIsICJtYWluUGFnZUNvbnRlbnQiLCAidGFyZ2V0IiwgInRhZ09yUmVkaXJlY3QiLCAic29ydGVkVGFncyIsICJhIiwgImIiLCAid2luZG93TWFuYWdlciIsICJ0ZW1wbGF0ZVByZXZpZXdEaWFsb2ciLCAicGFnZVRyaWFnZU1hcmtCdXR0b24iLCAicGF0cm9sUmVzcG9uc2UiLCAicmVkaXJlY3RWYWx1ZSIsICJ0YXJnZXRDaGFuZ2VkIiwgInRhZ3NDaGFuZ2VkIiwgInBhZ2VDb250ZW50IiwgInJlZGlyZWN0cyIsICJvcmlnaW5hbFJlZGlyZWN0VGFncyIsICJtYXRjaCIsICJuZXdUYWciLCAidGVtcGxhdGUiLCAiZXJyb3JzIiwgImRlc3RpbmF0aW9uIiwgImRlc3RpbmF0aW9uRGF0YSIsICJlcnJvckNvZGUiLCAiZGVzdGluYXRpb25QYXJzZVJlc3VsdCIsICJkZXN0aW5hdGlvblJlZGlyZWN0IiwgImRlc3RpbmF0aW9uQ29udGVudCIsICJhbmNob3IiLCAicGFydCIsICJlbGVtZW50IiwgIm1lc3NhZ2UiLCAid2FybmluZ01lc3NhZ2UiLCAib3V0cHV0IiwgInN1bW1hcnkiLCAiZXJyb3JJbmZvIiwgImZyb21Nb3ZlIiwgInRhbGtQYWdlIiwgInBhdHJvbExpbmsiLCAibWFya1Jldmlld2VkQnV0dG9uIl0KfQo=
