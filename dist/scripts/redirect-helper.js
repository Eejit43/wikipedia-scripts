"use strict";
mw.loader.using(["mediawiki.util", "oojs-ui-core", "oojs-ui-widgets", "oojs-ui.styles.icons-content", "oojs-ui.styles.icons-editing-core"], () => {
  class RedirectInputWidget extends OO.ui.TextInputWidget {
    constructor(config, pageTitleParsed) {
      super(config);
      this.getLookupRequest = () => {
        const value = this.getValue();
        const deferred = $.Deferred();
        if (!value)
          deferred.resolve([]);
        else if (value.includes("#")) {
          const title = value.split("#")[0];
          new mw.Api().get({ action: "parse", page: title, prop: "sections", redirects: "1" }).catch(() => null).then((result) => {
            if (result) {
              const matchedSections = result.parse.sections.filter((section) => section.line.toLowerCase().startsWith(value.split("#")[1].toLowerCase()));
              deferred.resolve(matchedSections.map((section) => ({ data: `${result.parse.title}#${section.line}`, label: `${result.parse.title}#${section.line}` })));
            } else
              deferred.resolve([]);
          });
        } else {
          const parsedTitle = mw.Title.newFromText(value);
          new mw.Api().get({
            action: "query",
            formatversion: 2,
            gaplimit: 20,
            gapnamespace: parsedTitle?.getNamespaceId() ?? 0,
            gapprefix: parsedTitle?.getMainText() ?? value,
            generator: "allpages",
            prop: "info|pageprops"
          }).catch(() => null).then((result) => {
            if (result)
              deferred.resolve(
                result.query?.pages ? result.query.pages.filter((page) => page.title !== this.pageTitleParsed.toString()).map((page) => ({
                  data: page.title,
                  label: new OO.ui.HtmlSnippet(
                    `${page.title}${page.pageprops && "disambiguation" in page.pageprops ? " <i>(disambiguation)</i>" : ""}${"redirect" in page ? " <i>(redirect)</i>" : ""}`
                  )
                })) : []
              );
            else
              deferred.resolve([]);
          });
        }
        return deferred.promise({ abort() {
        } });
      };
      this.getLookupCacheDataFromResponse = (response) => response ?? [];
      this.getLookupMenuOptionsFromData = (data) => data.map(({ data: data2, label }) => new OO.ui.MenuOptionWidget({ data: data2, label }));
      OO.ui.mixin.LookupElement.call(this, config);
      this.pageTitleParsed = pageTitleParsed;
    }
  }
  Object.assign(RedirectInputWidget.prototype, OO.ui.mixin.LookupElement.prototype);
  class RedirectHelper {
    /**
     * Runs the redirect helper.
     */
    async run() {
      if (!this.passesPreChecks())
        return;
      this.redirectTemplates = await this.fetchRedirectTemplates();
      this.contentText = document.querySelector("#mw-content-text");
      if (!this.contentText)
        return mw.notify("redirect-helper: Failed to find content text element!", { type: "error" });
      this.pageTitle = mw.config.get("wgPageName");
      this.pageTitleParsed = mw.Title.newFromText(this.pageTitle);
      if (!this.pageTitleParsed)
        return mw.notify("redirect-helper: Failed to parse page title!", { type: "error" });
      await this.checkPageAndLoad();
    }
    /**
     * Checks if the page passes pre checks.
     */
    passesPreChecks() {
      const conditions = [
        mw.config.get("wgNamespaceNumber") >= 0,
        // Is not virtual namespace
        mw.config.get("wgIsProbablyEditable"),
        // Page is editable
        mw.config.get("wgIsArticle"),
        // Viewing the content of a page
        mw.config.get("wgAction") === "view",
        // Viewing the page (not editing)
        mw.config.get("wgRevisionId") === mw.config.get("wgCurRevisionId"),
        // Viewing the current revision
        !mw.config.get("wgDiffOldId")
        // Not viewing a diff
      ];
      return conditions.every(Boolean);
    }
    /**
     * Fetches the redirect templates.
     */
    async fetchRedirectTemplates() {
      return JSON.parse(
        (await new mw.Api().get({
          action: "query",
          formatversion: 2,
          prop: "revisions",
          rvprop: "content",
          rvslots: "*",
          titles: "User:Eejit43/scripts/redirect-helper.json"
        })).query.pages?.[0]?.revisions?.[0]?.slots?.main?.content || "{}"
      );
    }
    /**
     * Checks a page's status and loads the helper appropriately.
     */
    async checkPageAndLoad() {
      const pageInfo = await new mw.Api().get({ action: "query", formatversion: 2, prop: "info", titles: this.pageTitle });
      const dialogInfo = { redirectTemplates: this.redirectTemplates, contentText: this.contentText, pageTitle: this.pageTitle, pageTitleParsed: this.pageTitleParsed };
      if (pageInfo.query.pages[0].missing) {
        const button = new OO.ui.ButtonWidget({ label: "Create redirect", icon: "articleRedirect", flags: ["progressive"] });
        button.$element[0].style.marginBottom = "20px";
        button.on("click", () => {
          button.$element[0].remove();
          new RedirectHelperDialog(dialogInfo, false).run();
        });
        this.contentText.prepend(button.$element[0]);
      } else if (pageInfo.query.pages[0].redirect)
        new RedirectHelperDialog(dialogInfo, true).run();
      else {
        const portletLink = mw.util.addPortletLink(mw.config.get("skin") === "minerva" ? "p-tb" : "p-cactions", "#", "Redirect page", "redirect-helper");
        portletLink.addEventListener("click", (event) => {
          event.preventDefault();
          new RedirectHelperDialog(dialogInfo, false).run();
        });
      }
    }
  }
  class RedirectHelperDialog {
    constructor({ redirectTemplates, contentText, pageTitle, pageTitleParsed }, exists) {
      this.redirectTemplates = redirectTemplates;
      this.contentText = contentText;
      this.pageTitle = pageTitle;
      this.pageTitleParsed = pageTitleParsed;
      this.exists = exists;
    }
    async run() {
      const editorBox = new OO.ui.PanelLayout({ padded: true, expanded: false, framed: true });
      editorBox.$element[0].style.backgroundColor = "#95d4bc";
      editorBox.$element[0].style.width = "700px";
      editorBox.$element[0].style.maxWidth = "calc(100% - 50px)";
      editorBox.$element[0].style.marginLeft = "auto";
      editorBox.$element[0].style.marginRight = "auto";
      editorBox.$element[0].style.marginBottom = "20px";
      let syncWithMainButton;
      if (this.pageTitleParsed.isTalkPage()) {
        const mainPageData = await new mw.Api().get({ action: "query", formatversion: 2, prop: "info", titles: this.pageTitleParsed.getSubjectPage().getPrefixedText() });
        if (mainPageData.query.pages[0].redirect) {
          const mainPageContent = (await new mw.Api().get({
            action: "query",
            formatversion: 2,
            prop: "revisions",
            rvprop: "content",
            rvslots: "*",
            titles: this.pageTitleParsed.getSubjectPage().getPrefixedText()
          })).query.pages[0].revisions[0].slots.main.content.trim();
          syncWithMainButton = new OO.ui.ButtonWidget({ label: "Sync with main page", icon: "link", flags: ["progressive"] });
          syncWithMainButton.on("click", () => {
            const target = /^#redirect:?\s*\[\[\s*([^[\]{|}]+?)\s*(?:\|[^[\]{|}]+?)?]]\s*/i.exec(mainPageContent)?.[1];
            if (!target)
              return mw.notify("Failed to parse main page content!", { type: "error" });
            redirectInput.setValue(mw.Title.newFromText(target)?.getTalkPage()?.toString() ?? "");
            const fromMove = ["R from move", ...this.redirectTemplates["R from move"]].some(
              (tagOrRedirect) => new RegExp(`{{\\s*[${tagOrRedirect[0].toLowerCase()}${tagOrRedirect[0]}]${tagOrRedirect.slice(1)}\\s*(\\||}})`).test(mainPageContent)
            );
            if (fromMove)
              tagSelect.setValue(["R from move"]);
          });
        }
      }
      const redirectInput = new RedirectInputWidget({ placeholder: "Target page name", required: true }, this.pageTitleParsed);
      redirectInput.on("change", () => {
        let value = redirectInput.getValue();
        value = value.replace(new RegExp(`^(https?:)?/{2}?${mw.config.get("wgServer").replace(/^\/{2}/, "")}/wiki/`), "");
        value = value.replace(/^:/, "");
        if (value.length > 0) {
          redirectInput.setValue(value[0].toUpperCase() + value.slice(1).replaceAll("_", " "));
          submitButton.setDisabled(false);
        } else
          submitButton.setDisabled(true);
        updateSummary(this.exists);
        submitButton.setLabel("Submit");
        needsCheck = true;
      });
      const redirectInputLayout = new OO.ui.FieldLayout(redirectInput, { label: new OO.ui.HtmlSnippet("<b>Redirect target:</b>"), align: "top" });
      const tagSelect = new OO.ui.MenuTagMultiselectWidget({
        allowArbitrary: false,
        allowReordering: false,
        options: Object.keys(this.redirectTemplates).map((tag) => ({ data: tag, label: tag }))
      });
      tagSelect.getMenu().filterMode = "substring";
      tagSelect.on("change", () => {
        const sortedTags = tagSelect.getValue().sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));
        if (tagSelect.getValue().join(";") !== sortedTags.join(";"))
          tagSelect.setValue(sortedTags);
        updateSummary(this.exists);
        submitButton.setLabel("Submit");
        needsCheck = true;
      });
      const tagSelectLayout = new OO.ui.FieldLayout(tagSelect, { label: new OO.ui.HtmlSnippet("<b>Redirect categorization template(s):</b>"), align: "top" });
      const summaryInput = new OO.ui.ComboBoxInputWidget({
        options: [
          { data: "Resolve double redirect" },
          //
          { data: "Resolve self redirect" },
          { data: "Remove incorrect rcats" }
        ]
      });
      const summaryInputLayout = new OO.ui.FieldLayout(summaryInput, { label: new OO.ui.HtmlSnippet("<b>Summary:</b>"), align: "top" });
      const submitButton = new OO.ui.ButtonWidget({ label: "Submit", disabled: true, flags: ["progressive"] });
      submitButton.$element[0].style.marginBottom = "0";
      let needsCheck = true;
      submitButton.on("click", async () => {
        for (const element of [redirectInput, tagSelect, summaryInput, submitButton, syncTalkCheckbox, patrolCheckbox].filter(Boolean))
          element.setDisabled(true);
        submitButton.setLabel("Checking target validity...");
        let parsedDestination;
        const errors = [];
        if (needsCheck) {
          const destination = redirectInput.getValue().trim();
          if (!/^\s*[^[\]{|}]+\s*$/.test(destination))
            errors.push({ title: destination, message: "is not a valid page title!" });
          try {
            parsedDestination = mw.Title.newFromText(destination);
          } catch {
            if (errors.length === 0)
              errors.push({ title: destination, message: "is not a valid page title!" });
          }
          if (!parsedDestination && errors.length === 0)
            errors.push({ title: destination, message: "is not a valid page title!" });
          if (parsedDestination?.toString() === this.pageTitleParsed.toString())
            errors.push({ message: "cannot redirect to itself!" });
          const destinationData = await new mw.Api().get({ action: "query", formatversion: 2, prop: "pageprops", titles: destination }).catch((errorCode) => {
            if (errorCode === "missingtitle")
              errors.push({ title: destination, message: "does not exist!" });
            else
              errors.push({ title: destination, message: `was not able to be fetched from the API (${errorCode})!` });
            return null;
          });
          const destinationParseResult = await new mw.Api().get({ action: "parse", page: destination, prop: "sections", redirects: "1" });
          if (destinationParseResult.parse.redirects?.[0]) {
            const destinationRedirect = destinationParseResult.parse.redirects[0].to + (destinationParseResult.parse.redirects[0].tofragment ? `#${destinationParseResult.parse.redirects[0].tofragment}` : "");
            errors.push({
              title: destination,
              message: `is a redirect to <a href="${mw.util.getUrl(
                destinationRedirect
              )}" target="_blank">${destinationRedirect}</a>. Retarget to that page instead, as double redirects aren't allowed.`
            });
          }
          if (destination.split("#").length > 1) {
            const validSection = destinationParseResult.parse.sections.find((section) => section.line === destination.split("#")[1]);
            if (validSection) {
              if (tagSelect.getValue().includes("R to anchor"))
                errors.push({ message: "is tagged as a redirect to an anchor, but it is actually a redirect to a section!" });
              if (!tagSelect.getValue().includes("R to section"))
                errors.push({ message: "is a redirect to a section, but it is not tagged with <code>{{R to section}}</code>!" });
            } else {
              const destinationContent = (await new mw.Api().get({
                action: "query",
                formatversion: 2,
                prop: "revisions",
                rvprop: "content",
                rvslots: "*",
                titles: parsedDestination.toString()
              })).query.pages[0].revisions[0].slots.main.content;
              const anchors = [
                ...destinationContent.match(/(?<={{\s*?[Aa](?:nchors?|nchor for redirect|nker|NCHOR|nc)\s*?\|).+?(?=}})/g)?.map((anchor) => anchor.split("|").map((part) => part.trim()))?.flat() ?? [],
                ...destinationContent.match(/(?<={{\s*?(?:[Vv](?:isible anchors?|isanc|Anch|anchor|isibleanchor|a)|[Aa](?:nchord|chored|nchor\+)|[Tt]ext anchor)\s*?\|).+?(?=(?<!!|=)}})/g)?.map(
                  (anchor) => anchor.split("|").map((part) => part.trim()).filter((part) => !/^text\s*?=/.test(part))
                )?.flat() ?? [],
                ...destinationContent.match(/(?<=id=)"?.+?(?="|>|\|)/g)?.map((anchor) => anchor.trim()) ?? []
              ];
              if (anchors.includes(destination.split("#")[1])) {
                if (tagSelect.getValue().includes("R to section"))
                  errors.push({ message: "is tagged as a redirect to a section, but it is actually a redirect to an anchor!" });
                if (!tagSelect.getValue().includes("R to anchor"))
                  errors.push({ message: "is a redirect to an anchor, but it is not tagged with <code>{{R from anchor}}</code>!" });
              } else
                errors.push({ message: `is a redirect to <a href="${mw.util.getUrl(destination)}" target="_blank">${destination}</a>, but that section or anchor does not exist!` });
            }
          }
          if (destination.split("#").length === 1 && (tagSelect.getValue().includes("R to section") || tagSelect.getValue().includes("R to anchor")))
            errors.push({ message: "is not a redirect to a section/anchor, but it is tagged with <code>{{R from section}}</code> or <code>{{R from anchor}}</code>!" });
          if (destinationData.query.pages[0].pageprops && "disambiguation" in destinationData.query.pages[0].pageprops && ![
            "R from ambiguous sort name",
            "R from ambiguous term",
            "R to disambiguation page",
            "R from incomplete disambiguation",
            "R from incorrect disambiguation",
            "R from other disambiguation"
          ].some((template) => tagSelect.getValue().includes(template)))
            errors.push({ message: "is a redirect to a disambiguation page, but it is not tagged with a disambiguation categorization template!" });
          if (destinationData.query.pages[0].pageprops && !("disambiguation" in destinationData.query.pages[0].pageprops) && ["R from ambiguous sort name", "R from ambiguous term", "R to disambiguation page", "R from incomplete disambiguation"].some(
            (template) => tagSelect.getValue().includes(template)
          ))
            errors.push({ message: "is not a redirect to a disambiguation page, but it is tagged with a disambiguation categorization template!" });
          if (tagSelect.getValue().includes("R to disambiguation page") && !this.pageTitleParsed.getMainText().endsWith(" (disambiguation)"))
            errors.push({
              message: 'is tagged with <code>{{R to disambiguation page}}</code>, but this title does not end with " (disambiguation)". Use <code>{{R from ambiguous term}}</code> or a similar categorization template instead!'
            });
          if (syncTalkCheckbox?.isSelected() && !talkData.query.pages[0].missing && !talkData.query.pages[0].redirect)
            errors.push({ title: this.pageTitleParsed.getTalkPage().getPrefixedText(), message: "exists, but is not a redirect!" });
        }
        if (errors.length > 0) {
          for (const element of document.querySelectorAll(".redirect-helper-warning"))
            element.remove();
          for (const { title, message } of errors) {
            const label = new OO.ui.HtmlSnippet(
              `${title ? `<a href="${mw.util.getUrl(title)}" target="_blank">${title}</a>` : "This page"} ${message} Click again without making changes to submit anyway.`
            );
            const warningMessage = new OO.ui.MessageWidget({ type: "error", classes: ["redirect-helper-warning"], inline: true, label });
            warningMessage.$element[0].style.marginTop = "8px";
            editorBox.$element[0].append(warningMessage.$element[0]);
          }
          for (const element of [redirectInput, tagSelect, summaryInput, submitButton, syncTalkCheckbox, patrolCheckbox].filter(Boolean))
            element.setDisabled(false);
          submitButton.setLabel("Submit anyway");
          needsCheck = false;
          return;
        }
        parsedDestination = mw.Title.newFromText(redirectInput.getValue());
        submitButton.setLabel(`${this.exists ? "Editing" : "Creating"} redirect...`);
        const output = [
          `#REDIRECT [[${redirectInput.getValue().trim()}]]`,
          //
          tagSelect.getValue().length > 0 ? `{{Redirect category shell|
${tagSelect.getValue().map((tag) => `{{${tag}${oldRedirectTagData?.[tag] ? `|${oldRedirectTagData[tag]}` : ""}}}`).join("\n")}
}}` : null,
          oldStrayText
        ].filter(Boolean).join("\n\n");
        const summary = (summaryInput.getValue() || summaryInput.$tabIndexed[0].placeholder) + " (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])";
        const result = await new mw.Api().edit(this.pageTitle, () => ({ text: output, summary })).catch((errorCode, errorInfo) => {
          if (errorCode === "nocreate-missing")
            return new mw.Api().create(this.pageTitle, { summary }, output).catch((errorCode2, errorInfo2) => {
              mw.notify(`Error creating ${this.pageTitle}: ${errorInfo2?.error.info ?? "Unknown error"} (${errorCode2})`, { type: "error" });
            });
          else {
            mw.notify(`Error editing or creating ${this.pageTitle}: ${errorInfo?.error.info ?? "Unknown error"} (${errorCode})`, { type: "error" });
            return null;
          }
        });
        if (!result)
          return;
        mw.notify(`Redirect ${this.exists ? "edited" : "created"} successfully!`, { type: "success" });
        if (syncTalkCheckbox?.isSelected()) {
          submitButton.setLabel("Editing talk page...");
          const fromMove = tagSelect.getValue().includes("R from move");
          const output2 = [
            `#REDIRECT [[${parsedDestination.getTalkPage().getPrefixedText()}]]`,
            //
            fromMove ? "{{Redirect category shell|\n{{R from move}}\n}}" : null
          ].filter(Boolean).join("\n\n");
          const talkPage = this.pageTitleParsed.getTalkPage().getPrefixedText();
          const talkResult = await new mw.Api().edit(talkPage, () => ({ text: output2, summary: "Syncing redirect from main page (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])" })).catch((errorCode, errorInfo) => {
            if (errorCode === "nocreate-missing")
              return new mw.Api().create(talkPage, { summary: "Syncing redirect from main page (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])" }, output2).catch((errorCode2, errorInfo2) => {
                mw.notify(`Error creating ${talkPage}: ${errorInfo2?.error.info ?? "Unknown error"} (${errorCode2})`, { type: "error" });
              });
            else {
              mw.notify(`Error editing or creating ${talkPage}: ${errorInfo?.error.info ?? "Unknown error"} (${errorCode})`, { type: "error" });
              return null;
            }
          });
          if (!talkResult)
            return;
          mw.notify("Talk page synced successfully!", { type: "success" });
        }
        if (patrolCheckbox?.isSelected()) {
          submitButton.setLabel("Patrolling redirect...");
          const patrolLink = document.querySelector(".patrollink a");
          const markReviewedButton = document.querySelector("#mwe-pt-mark-as-reviewed-button");
          if (patrolLink) {
            const patrolResult = await new mw.Api().postWithToken("patrol", { action: "patrol", rcid: new URL(patrolLink.href).searchParams.get("rcid") }).catch((errorCode, errorInfo) => {
              mw.notify(`Error patrolling ${this.pageTitle} via API: ${errorInfo?.error.info ?? "Unknown error"} (${errorCode})`, { type: "error" });
              return null;
            });
            if (patrolResult)
              mw.notify("Redirect patrolled successfully!", { type: "success" });
          } else if (markReviewedButton) {
            markReviewedButton.click();
            mw.notify("Redirect patrolled successfully!", { type: "success" });
          } else
            mw.notify("Page curation toolbar not found, redirect cannot be patrolled!", { type: "error" });
        }
        submitButton.setLabel("Complete, reloading...");
        window.location.href = mw.util.getUrl(this.pageTitle, { redirect: "no" });
      });
      let talkData;
      let syncTalkCheckbox, syncTalkLayout;
      if (!this.pageTitleParsed.isTalkPage()) {
        talkData = await new mw.Api().get({ action: "query", formatversion: 2, prop: "info", titles: this.pageTitleParsed.getTalkPage().getPrefixedText() });
        syncTalkCheckbox = new OO.ui.CheckboxInputWidget({ selected: !!talkData.query.pages[0].redirect });
        syncTalkLayout = new OO.ui.Widget({ content: [new OO.ui.FieldLayout(syncTalkCheckbox, { label: "Sync talk page", align: "inline" })] });
        syncTalkLayout.$element[0].style.marginBottom = "0";
      }
      const markButton = document.querySelector("#mwe-pt-mark .mwe-pt-tool-icon");
      markButton?.click();
      markButton?.click();
      let shouldPromptPatrol;
      if (mw.config.get("wgNamespaceNumber") !== 0)
        shouldPromptPatrol = false;
      else if (document.querySelector(".patrollink"))
        shouldPromptPatrol = true;
      else if (document.querySelector("#mwe-pt-mark-as-reviewed-button"))
        shouldPromptPatrol = true;
      else if (document.querySelector("#mwe-pt-mark-as-unreviewed-button"))
        shouldPromptPatrol = false;
      else {
        if (!mw.config.get("wgArticleId"))
          shouldPromptPatrol = false;
        const userPermissions = await new mw.Api().get({ action: "query", meta: "userinfo", uiprop: "rights" });
        if (!userPermissions.query.userinfo.rights.includes("patrol"))
          shouldPromptPatrol = false;
        const patrolResponse = await new mw.Api().get({ action: "pagetriagelist", page_id: mw.config.get("wgArticleId") });
        if (patrolResponse.pagetriagelist.pages[0]?.user_name === mw.config.get("wgUserName"))
          shouldPromptPatrol = false;
        else if (patrolResponse.pagetriagelist.result !== "success" || patrolResponse.pagetriagelist.pages.length === 0)
          shouldPromptPatrol = false;
        else
          shouldPromptPatrol = !Number.parseInt(patrolResponse.pagetriagelist.pages[0]?.patrol_status);
      }
      let patrolCheckbox, patrolLayout;
      if (shouldPromptPatrol) {
        patrolCheckbox = new OO.ui.CheckboxInputWidget({ selected: true });
        patrolLayout = new OO.ui.Widget({ content: [new OO.ui.FieldLayout(patrolCheckbox, { label: "Mark as patrolled", align: "inline" })] });
        patrolLayout.$element[0].style.marginBottom = "0";
      }
      const submitLayout = new OO.ui.HorizontalLayout({ items: [submitButton, syncTalkLayout, patrolLayout].filter(Boolean) });
      submitLayout.$element[0].style.marginTop = "10px";
      editorBox.$element[0].append(
        ...[syncWithMainButton?.$element?.[0], redirectInputLayout.$element[0], tagSelectLayout.$element[0], summaryInputLayout.$element[0], submitLayout.$element[0]].filter(
          Boolean
        )
      );
      this.contentText.prepend(editorBox.$element[0]);
      function updateSummary(exists) {
        const redirectValue = redirectInput.getValue().trim();
        if (!redirectValue)
          summaryInput.$tabIndexed[0].placeholder = "";
        else if (exists) {
          const targetChanged = redirectValue !== oldRedirectTarget?.replaceAll("_", " ");
          const tagsChanged = tagSelect.getValue().join(";") !== oldRedirectTags?.join(";");
          if (targetChanged && tagsChanged)
            summaryInput.$tabIndexed[0].placeholder = `Changing redirect to [[${redirectValue}]] and changing categorization templates`;
          else if (targetChanged)
            summaryInput.$tabIndexed[0].placeholder = `Changing redirect to [[${redirectValue}]]`;
          else if (tagsChanged)
            summaryInput.$tabIndexed[0].placeholder = "Changing categorization templates";
          else
            summaryInput.$tabIndexed[0].placeholder = "Redirect cleanup";
        } else
          summaryInput.$tabIndexed[0].placeholder = `Creating redirect to [[${redirectValue}]]`;
      }
      let oldRedirectTarget, oldRedirectTags, oldRedirectTagData, oldStrayText;
      if (this.exists) {
        const pageContent = (await new mw.Api().get({ action: "query", formatversion: 2, prop: "revisions", rvprop: "content", rvslots: "*", titles: this.pageTitle })).query.pages[0].revisions[0].slots.main.content.trim();
        oldRedirectTarget = /^#redirect:?\s*\[\[\s*([^[\]{|}]+?)\s*(?:\|[^[\]{|}]+?)?]]\s*/i.exec(pageContent)?.[1];
        oldRedirectTags = Object.entries(this.redirectTemplates).map(
          ([tag, redirects]) => [tag, ...redirects].some(
            (tagOrRedirect) => new RegExp(`{{\\s*[${tagOrRedirect[0].toLowerCase()}${tagOrRedirect[0]}]${tagOrRedirect.slice(1)}\\s*(\\||}})`).test(pageContent)
          ) ? tag : null
        ).filter(Boolean).sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));
        const originalRedirectTags = Object.entries(this.redirectTemplates).flatMap(([tag, redirects]) => [tag, ...redirects]).map((tagOrRedirect) => new RegExp(`{{\\s*[${tagOrRedirect[0].toLowerCase()}${tagOrRedirect[0]}]${tagOrRedirect.slice(1)}\\s*(\\||}})`).test(pageContent) ? tagOrRedirect : null).filter(Boolean);
        oldRedirectTagData = Object.fromEntries(
          originalRedirectTags.map((tag) => {
            const match = new RegExp(`{{\\s*[${tag[0].toLowerCase()}${tag[0]}]${tag.slice(1)}\\|?(.*?)\\s*}}`).exec(pageContent);
            const newTag = Object.entries(this.redirectTemplates).find(([template, redirects]) => [template, ...redirects].includes(tag))?.[0];
            return match ? [newTag, match[1]] : null;
          }).filter(Boolean)
        );
        oldStrayText = [
          pageContent.match(/{{short description\|.*?}}/i)?.[0],
          pageContent.match(/{{DISPLAYTITLE:.*?}}/)?.[0],
          pageContent.match(/{{italic title\|?.*?}}/i)?.[0],
          pageContent.match(/{{DEFAULTSORT:.*?}}/)?.[0],
          pageContent.match(/{{title language\|.*?}}/)?.[0],
          ...pageContent.match(/\[\[[Cc]ategory:.+?]]/g) ?? []
        ].filter(Boolean).join("\n");
        if (oldRedirectTarget)
          redirectInput.setValue(oldRedirectTarget.replaceAll("_", " "));
        else
          mw.notify("Could not find redirect target!", { type: "error" });
        tagSelect.setValue(oldRedirectTags);
        updateSummary(this.exists);
      }
    }
  }
  new RedirectHelper().run();
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc2NyaXB0cy9yZWRpcmVjdC1oZWxwZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1lZGlhV2lraURhdGFFcnJvciwgUGFnZVJldmlzaW9uc1Jlc3VsdCB9IGZyb20gJy4uL2dsb2JhbC10eXBlcyc7XG5cbi8vIERlZmluZSB0eXBlc1xuaW50ZXJmYWNlIFBhZ2VJbmZvUmVzdWx0IHtcbiAgICBxdWVyeTogeyBwYWdlczogeyBtaXNzaW5nPzogc3RyaW5nOyByZWRpcmVjdD86IHN0cmluZyB9W10gfTtcbn1cblxuaW50ZXJmYWNlIEFsbFBhZ2VzR2VuZXJhdG9yUmVzdWx0IHtcbiAgICBxdWVyeTogeyBwYWdlczogeyB0aXRsZTogc3RyaW5nOyBwYWdlcHJvcHM6IHsgZGlzYW1iaWd1YXRpb24/OiBzdHJpbmcgfTsgcmVkaXJlY3Q/OiBzdHJpbmcgfVtdIH07XG59XG5cbmludGVyZmFjZSBQYWdlUGFyc2VSZXN1bHQge1xuICAgIHBhcnNlOiB7IHRpdGxlOiBzdHJpbmc7IHJlZGlyZWN0czogeyB0bzogc3RyaW5nOyB0b2ZyYWdtZW50OiBzdHJpbmcgfVtdOyBzZWN0aW9uczogeyBsaW5lOiBzdHJpbmcgfVtdIH07XG59XG5cbmludGVyZmFjZSBQYWdlcHJvcHNSZXN1bHQge1xuICAgIHF1ZXJ5OiB7IHBhZ2VzOiB7IHBhZ2Vwcm9wcz86IHsgZGlzYW1iaWd1YXRpb24/OiBzdHJpbmcgfSB9W10gfTtcbn1cblxuaW50ZXJmYWNlIFVzZXJQZXJtaXNzaW9uc1Jlc3BvbnNlIHtcbiAgICBxdWVyeTogeyB1c2VyaW5mbzogeyByaWdodHM6IHN0cmluZ1tdIH0gfTtcbn1cblxuaW50ZXJmYWNlIFBhZ2VUcmlhZ2VMaXN0UmVzcG9uc2Uge1xuICAgIHBhZ2V0cmlhZ2VsaXN0OiB7IHBhZ2VzOiB7IHVzZXJfbmFtZTogc3RyaW5nOyBwYXRyb2xfc3RhdHVzOiBzdHJpbmcgfVtdOyByZXN1bHQ6IHN0cmluZyB9OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxufVxuXG5tdy5sb2FkZXIudXNpbmcoWydtZWRpYXdpa2kudXRpbCcsICdvb2pzLXVpLWNvcmUnLCAnb29qcy11aS13aWRnZXRzJywgJ29vanMtdWkuc3R5bGVzLmljb25zLWNvbnRlbnQnLCAnb29qcy11aS5zdHlsZXMuaWNvbnMtZWRpdGluZy1jb3JlJ10sICgpID0+IHtcbiAgICAvLyBTZXR1cCBSZWRpcmVjdElucHV0V2lkZ2V0XG4gICAgaW50ZXJmYWNlIFJlZGlyZWN0SW5wdXRXaWRnZXRDb25maWcgZXh0ZW5kcyBPTy51aS5UZXh0SW5wdXRXaWRnZXQuQ29uZmlnT3B0aW9ucywgT08udWkubWl4aW4uTG9va3VwRWxlbWVudC5Db25maWdPcHRpb25zIHt9XG5cbiAgICAvKipcbiAgICAgKiBBbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzIGlzIGEgdGl0bGUgbG9va3VwIGVsZW1lbnQuXG4gICAgICovXG4gICAgY2xhc3MgUmVkaXJlY3RJbnB1dFdpZGdldCBleHRlbmRzIE9PLnVpLlRleHRJbnB1dFdpZGdldCB7XG4gICAgICAgIHBhZ2VUaXRsZVBhcnNlZDogbXcuVGl0bGU7XG5cbiAgICAgICAgY29uc3RydWN0b3IoY29uZmlnOiBSZWRpcmVjdElucHV0V2lkZ2V0Q29uZmlnLCBwYWdlVGl0bGVQYXJzZWQ6IG13LlRpdGxlKSB7XG4gICAgICAgICAgICBzdXBlcihjb25maWcpO1xuICAgICAgICAgICAgT08udWkubWl4aW4uTG9va3VwRWxlbWVudC5jYWxsKHRoaXMgYXMgdW5rbm93biBhcyBPTy51aS5taXhpbi5Mb29rdXBFbGVtZW50LCBjb25maWcpO1xuXG4gICAgICAgICAgICB0aGlzLnBhZ2VUaXRsZVBhcnNlZCA9IHBhZ2VUaXRsZVBhcnNlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldExvb2t1cFJlcXVlc3QgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGNvbnN0IGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuXG4gICAgICAgICAgICBpZiAoIXZhbHVlKSBkZWZlcnJlZC5yZXNvbHZlKFtdKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlLmluY2x1ZGVzKCcjJykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0aXRsZSA9IHZhbHVlLnNwbGl0KCcjJylbMF07XG5cbiAgICAgICAgICAgICAgICBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgLmdldCh7IGFjdGlvbjogJ3BhcnNlJywgcGFnZTogdGl0bGUsIHByb3A6ICdzZWN0aW9ucycsIHJlZGlyZWN0czogJzEnIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiBudWxsKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzdWx0OiBQYWdlUGFyc2VSZXN1bHQgfCBudWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlZFNlY3Rpb25zID0gcmVzdWx0LnBhcnNlLnNlY3Rpb25zLmZpbHRlcigoc2VjdGlvbikgPT4gc2VjdGlvbi5saW5lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCh2YWx1ZS5zcGxpdCgnIycpWzFdLnRvTG93ZXJDYXNlKCkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKG1hdGNoZWRTZWN0aW9ucy5tYXAoKHNlY3Rpb24pID0+ICh7IGRhdGE6IGAke3Jlc3VsdC5wYXJzZS50aXRsZX0jJHtzZWN0aW9uLmxpbmV9YCwgbGFiZWw6IGAke3Jlc3VsdC5wYXJzZS50aXRsZX0jJHtzZWN0aW9uLmxpbmV9YCB9KSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGRlZmVycmVkLnJlc29sdmUoW10pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkVGl0bGUgPSBtdy5UaXRsZS5uZXdGcm9tVGV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgbmV3IG13LkFwaSgpXG4gICAgICAgICAgICAgICAgICAgIC5nZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0dmVyc2lvbjogMixcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhcGxpbWl0OiAyMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhcG5hbWVzcGFjZTogcGFyc2VkVGl0bGU/LmdldE5hbWVzcGFjZUlkKCkgPz8gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhcHByZWZpeDogcGFyc2VkVGl0bGU/LmdldE1haW5UZXh0KCkgPz8gdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZW5lcmF0b3I6ICdhbGxwYWdlcycsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wOiAnaW5mb3xwYWdlcHJvcHMnLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdDogQWxsUGFnZXNHZW5lcmF0b3JSZXN1bHQgfCBudWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5xdWVyeT8ucGFnZXMgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcmVzdWx0LnF1ZXJ5LnBhZ2VzIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKChwYWdlKSA9PiBwYWdlLnRpdGxlICE9PSB0aGlzLnBhZ2VUaXRsZVBhcnNlZC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgocGFnZSkgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBwYWdlLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBuZXcgT08udWkuSHRtbFNuaXBwZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAke3BhZ2UudGl0bGV9JHtwYWdlLnBhZ2Vwcm9wcyAmJiAnZGlzYW1iaWd1YXRpb24nIGluIHBhZ2UucGFnZXByb3BzID8gJyA8aT4oZGlzYW1iaWd1YXRpb24pPC9pPicgOiAnJ30keydyZWRpcmVjdCcgaW4gcGFnZSA/ICcgPGk+KHJlZGlyZWN0KTwvaT4nIDogJyd9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGRlZmVycmVkLnJlc29sdmUoW10pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoeyBhYm9ydCgpIHt9IH0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICB9O1xuXG4gICAgICAgIGdldExvb2t1cENhY2hlRGF0YUZyb21SZXNwb25zZSA9IDxUPihyZXNwb25zZTogVFtdIHwgbnVsbCB8IHVuZGVmaW5lZCkgPT4gcmVzcG9uc2UgPz8gW107XG5cbiAgICAgICAgZ2V0TG9va3VwTWVudU9wdGlvbnNGcm9tRGF0YSA9IChkYXRhOiB7IGRhdGE6IHN0cmluZzsgbGFiZWw6IHN0cmluZyB9W10pID0+IGRhdGEubWFwKCh7IGRhdGEsIGxhYmVsIH0pID0+IG5ldyBPTy51aS5NZW51T3B0aW9uV2lkZ2V0KHsgZGF0YSwgbGFiZWwgfSkpO1xuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24oUmVkaXJlY3RJbnB1dFdpZGdldC5wcm90b3R5cGUsIE9PLnVpLm1peGluLkxvb2t1cEVsZW1lbnQucHJvdG90eXBlKTtcblxuICAgIC8qKlxuICAgICAqIEFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MgaGFuZGxlcyB0aGUgZW50aXJlIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIHJlZGlyZWN0LWhlbHBlciBzY3JpcHQuXG4gICAgICovXG4gICAgY2xhc3MgUmVkaXJlY3RIZWxwZXIge1xuICAgICAgICByZWRpcmVjdFRlbXBsYXRlcyE6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjtcbiAgICAgICAgY29udGVudFRleHQhOiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgcGFnZVRpdGxlITogc3RyaW5nO1xuICAgICAgICBwYWdlVGl0bGVQYXJzZWQhOiBtdy5UaXRsZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUnVucyB0aGUgcmVkaXJlY3QgaGVscGVyLlxuICAgICAgICAgKi9cbiAgICAgICAgYXN5bmMgcnVuKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnBhc3Nlc1ByZUNoZWNrcygpKSByZXR1cm47XG5cbiAgICAgICAgICAgIHRoaXMucmVkaXJlY3RUZW1wbGF0ZXMgPSBhd2FpdCB0aGlzLmZldGNoUmVkaXJlY3RUZW1wbGF0ZXMoKTtcblxuICAgICAgICAgICAgdGhpcy5jb250ZW50VGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtdy1jb250ZW50LXRleHQnKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIGlmICghdGhpcy5jb250ZW50VGV4dCkgcmV0dXJuIG13Lm5vdGlmeSgncmVkaXJlY3QtaGVscGVyOiBGYWlsZWQgdG8gZmluZCBjb250ZW50IHRleHQgZWxlbWVudCEnLCB7IHR5cGU6ICdlcnJvcicgfSk7XG5cbiAgICAgICAgICAgIHRoaXMucGFnZVRpdGxlID0gbXcuY29uZmlnLmdldCgnd2dQYWdlTmFtZScpO1xuXG4gICAgICAgICAgICB0aGlzLnBhZ2VUaXRsZVBhcnNlZCA9IG13LlRpdGxlLm5ld0Zyb21UZXh0KHRoaXMucGFnZVRpdGxlKSE7XG4gICAgICAgICAgICBpZiAoIXRoaXMucGFnZVRpdGxlUGFyc2VkKSByZXR1cm4gbXcubm90aWZ5KCdyZWRpcmVjdC1oZWxwZXI6IEZhaWxlZCB0byBwYXJzZSBwYWdlIHRpdGxlIScsIHsgdHlwZTogJ2Vycm9yJyB9KTtcblxuICAgICAgICAgICAgYXdhaXQgdGhpcy5jaGVja1BhZ2VBbmRMb2FkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hlY2tzIGlmIHRoZSBwYWdlIHBhc3NlcyBwcmUgY2hlY2tzLlxuICAgICAgICAgKi9cbiAgICAgICAgcGFzc2VzUHJlQ2hlY2tzKCkge1xuICAgICAgICAgICAgY29uc3QgY29uZGl0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICBtdy5jb25maWcuZ2V0KCd3Z05hbWVzcGFjZU51bWJlcicpID49IDAsIC8vIElzIG5vdCB2aXJ0dWFsIG5hbWVzcGFjZVxuICAgICAgICAgICAgICAgIG13LmNvbmZpZy5nZXQoJ3dnSXNQcm9iYWJseUVkaXRhYmxlJyksIC8vIFBhZ2UgaXMgZWRpdGFibGVcbiAgICAgICAgICAgICAgICBtdy5jb25maWcuZ2V0KCd3Z0lzQXJ0aWNsZScpLCAvLyBWaWV3aW5nIHRoZSBjb250ZW50IG9mIGEgcGFnZVxuICAgICAgICAgICAgICAgIG13LmNvbmZpZy5nZXQoJ3dnQWN0aW9uJykgPT09ICd2aWV3JywgLy8gVmlld2luZyB0aGUgcGFnZSAobm90IGVkaXRpbmcpXG4gICAgICAgICAgICAgICAgbXcuY29uZmlnLmdldCgnd2dSZXZpc2lvbklkJykgPT09IG13LmNvbmZpZy5nZXQoJ3dnQ3VyUmV2aXNpb25JZCcpLCAvLyBWaWV3aW5nIHRoZSBjdXJyZW50IHJldmlzaW9uXG4gICAgICAgICAgICAgICAgIW13LmNvbmZpZy5nZXQoJ3dnRGlmZk9sZElkJyksIC8vIE5vdCB2aWV3aW5nIGEgZGlmZlxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgcmV0dXJuIGNvbmRpdGlvbnMuZXZlcnkoQm9vbGVhbik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmV0Y2hlcyB0aGUgcmVkaXJlY3QgdGVtcGxhdGVzLlxuICAgICAgICAgKi9cbiAgICAgICAgYXN5bmMgZmV0Y2hSZWRpcmVjdFRlbXBsYXRlcygpIHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKFxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0dmVyc2lvbjogMixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3A6ICdyZXZpc2lvbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcnZwcm9wOiAnY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBydnNsb3RzOiAnKicsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZXM6ICdVc2VyOkVlaml0NDMvc2NyaXB0cy9yZWRpcmVjdC1oZWxwZXIuanNvbicsXG4gICAgICAgICAgICAgICAgICAgIH0pKSBhcyBQYWdlUmV2aXNpb25zUmVzdWx0XG4gICAgICAgICAgICAgICAgKS5xdWVyeS5wYWdlcz8uWzBdPy5yZXZpc2lvbnM/LlswXT8uc2xvdHM/Lm1haW4/LmNvbnRlbnQgfHwgJ3t9JyxcbiAgICAgICAgICAgICkgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nW10+O1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoZWNrcyBhIHBhZ2UncyBzdGF0dXMgYW5kIGxvYWRzIHRoZSBoZWxwZXIgYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICovXG4gICAgICAgIGFzeW5jIGNoZWNrUGFnZUFuZExvYWQoKSB7XG4gICAgICAgICAgICBjb25zdCBwYWdlSW5mbyA9IChhd2FpdCBuZXcgbXcuQXBpKCkuZ2V0KHsgYWN0aW9uOiAncXVlcnknLCBmb3JtYXR2ZXJzaW9uOiAyLCBwcm9wOiAnaW5mbycsIHRpdGxlczogdGhpcy5wYWdlVGl0bGUgfSkpIGFzIFBhZ2VJbmZvUmVzdWx0O1xuXG4gICAgICAgICAgICBjb25zdCBkaWFsb2dJbmZvID0geyByZWRpcmVjdFRlbXBsYXRlczogdGhpcy5yZWRpcmVjdFRlbXBsYXRlcywgY29udGVudFRleHQ6IHRoaXMuY29udGVudFRleHQsIHBhZ2VUaXRsZTogdGhpcy5wYWdlVGl0bGUsIHBhZ2VUaXRsZVBhcnNlZDogdGhpcy5wYWdlVGl0bGVQYXJzZWQgfTtcblxuICAgICAgICAgICAgaWYgKHBhZ2VJbmZvLnF1ZXJ5LnBhZ2VzWzBdLm1pc3NpbmcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgT08udWkuQnV0dG9uV2lkZ2V0KHsgbGFiZWw6ICdDcmVhdGUgcmVkaXJlY3QnLCBpY29uOiAnYXJ0aWNsZVJlZGlyZWN0JywgZmxhZ3M6IFsncHJvZ3Jlc3NpdmUnXSB9KTtcbiAgICAgICAgICAgICAgICBidXR0b24uJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luQm90dG9tID0gJzIwcHgnO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi4kZWxlbWVudFswXS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3IFJlZGlyZWN0SGVscGVyRGlhbG9nKGRpYWxvZ0luZm8sIGZhbHNlKS5ydW4oKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudFRleHQucHJlcGVuZChidXR0b24uJGVsZW1lbnRbMF0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYWdlSW5mby5xdWVyeS5wYWdlc1swXS5yZWRpcmVjdCkgbmV3IFJlZGlyZWN0SGVscGVyRGlhbG9nKGRpYWxvZ0luZm8sIHRydWUpLnJ1bigpO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcG9ydGxldExpbmsgPSBtdy51dGlsLmFkZFBvcnRsZXRMaW5rKG13LmNvbmZpZy5nZXQoJ3NraW4nKSA9PT0gJ21pbmVydmEnID8gJ3AtdGInIDogJ3AtY2FjdGlvbnMnLCAnIycsICdSZWRpcmVjdCBwYWdlJywgJ3JlZGlyZWN0LWhlbHBlcicpITtcbiAgICAgICAgICAgICAgICBwb3J0bGV0TGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBuZXcgUmVkaXJlY3RIZWxwZXJEaWFsb2coZGlhbG9nSW5mbywgZmFsc2UpLnJ1bigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xhc3MgUmVkaXJlY3RIZWxwZXJEaWFsb2cge1xuICAgICAgICByZWRpcmVjdFRlbXBsYXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+O1xuICAgICAgICBjb250ZW50VGV4dDogSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIHBhZ2VUaXRsZTogc3RyaW5nO1xuICAgICAgICBwYWdlVGl0bGVQYXJzZWQ6IG13LlRpdGxlO1xuXG4gICAgICAgIGV4aXN0czogYm9vbGVhbjtcblxuICAgICAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgICAgIHsgcmVkaXJlY3RUZW1wbGF0ZXMsIGNvbnRlbnRUZXh0LCBwYWdlVGl0bGUsIHBhZ2VUaXRsZVBhcnNlZCB9OiB7IHJlZGlyZWN0VGVtcGxhdGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47IGNvbnRlbnRUZXh0OiBIVE1MRGl2RWxlbWVudDsgcGFnZVRpdGxlOiBzdHJpbmc7IHBhZ2VUaXRsZVBhcnNlZDogbXcuVGl0bGUgfSxcbiAgICAgICAgICAgIGV4aXN0czogYm9vbGVhbixcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0VGVtcGxhdGVzID0gcmVkaXJlY3RUZW1wbGF0ZXM7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUZXh0ID0gY29udGVudFRleHQ7XG4gICAgICAgICAgICB0aGlzLnBhZ2VUaXRsZSA9IHBhZ2VUaXRsZTtcbiAgICAgICAgICAgIHRoaXMucGFnZVRpdGxlUGFyc2VkID0gcGFnZVRpdGxlUGFyc2VkO1xuXG4gICAgICAgICAgICB0aGlzLmV4aXN0cyA9IGV4aXN0cztcbiAgICAgICAgfVxuXG4gICAgICAgIGFzeW5jIHJ1bigpIHtcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvckJveCA9IG5ldyBPTy51aS5QYW5lbExheW91dCh7IHBhZGRlZDogdHJ1ZSwgZXhwYW5kZWQ6IGZhbHNlLCBmcmFtZWQ6IHRydWUgfSk7XG4gICAgICAgICAgICBlZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyM5NWQ0YmMnO1xuICAgICAgICAgICAgZWRpdG9yQm94LiRlbGVtZW50WzBdLnN0eWxlLndpZHRoID0gJzcwMHB4JztcbiAgICAgICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS5tYXhXaWR0aCA9ICdjYWxjKDEwMCUgLSA1MHB4KSc7XG4gICAgICAgICAgICBlZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luTGVmdCA9ICdhdXRvJztcbiAgICAgICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5SaWdodCA9ICdhdXRvJztcbiAgICAgICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMjBweCc7XG5cbiAgICAgICAgICAgIGxldCBzeW5jV2l0aE1haW5CdXR0b247XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBhZ2VUaXRsZVBhcnNlZC5pc1RhbGtQYWdlKCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYWluUGFnZURhdGEgPSAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3F1ZXJ5JywgZm9ybWF0dmVyc2lvbjogMiwgcHJvcDogJ2luZm8nLCB0aXRsZXM6IHRoaXMucGFnZVRpdGxlUGFyc2VkLmdldFN1YmplY3RQYWdlKCkhLmdldFByZWZpeGVkVGV4dCgpIH0pKSBhcyBQYWdlSW5mb1Jlc3VsdDtcblxuICAgICAgICAgICAgICAgIGlmIChtYWluUGFnZURhdGEucXVlcnkucGFnZXNbMF0ucmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWFpblBhZ2VDb250ZW50ID0gKFxuICAgICAgICAgICAgICAgICAgICAgICAgKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3F1ZXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3A6ICdyZXZpc2lvbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ2cHJvcDogJ2NvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ2c2xvdHM6ICcqJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZXM6IHRoaXMucGFnZVRpdGxlUGFyc2VkLmdldFN1YmplY3RQYWdlKCkhLmdldFByZWZpeGVkVGV4dCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpIGFzIFBhZ2VSZXZpc2lvbnNSZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgKS5xdWVyeS5wYWdlc1swXS5yZXZpc2lvbnNbMF0uc2xvdHMubWFpbi5jb250ZW50LnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgc3luY1dpdGhNYWluQnV0dG9uID0gbmV3IE9PLnVpLkJ1dHRvbldpZGdldCh7IGxhYmVsOiAnU3luYyB3aXRoIG1haW4gcGFnZScsIGljb246ICdsaW5rJywgZmxhZ3M6IFsncHJvZ3Jlc3NpdmUnXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3luY1dpdGhNYWluQnV0dG9uLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IC9eI3JlZGlyZWN0Oj9cXHMqXFxbXFxbXFxzKihbXltcXF17fH1dKz8pXFxzKig/OlxcfFteW1xcXXt8fV0rPyk/XV1cXHMqL2kuZXhlYyhtYWluUGFnZUNvbnRlbnQpPy5bMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgcmV0dXJuIG13Lm5vdGlmeSgnRmFpbGVkIHRvIHBhcnNlIG1haW4gcGFnZSBjb250ZW50IScsIHsgdHlwZTogJ2Vycm9yJyB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3RJbnB1dC5zZXRWYWx1ZShtdy5UaXRsZS5uZXdGcm9tVGV4dCh0YXJnZXQpPy5nZXRUYWxrUGFnZSgpPy50b1N0cmluZygpID8/ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb21Nb3ZlID0gWydSIGZyb20gbW92ZScsIC4uLnRoaXMucmVkaXJlY3RUZW1wbGF0ZXNbJ1IgZnJvbSBtb3ZlJ11dLnNvbWUoKHRhZ09yUmVkaXJlY3QpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFJlZ0V4cChge3tcXFxccypbJHt0YWdPclJlZGlyZWN0WzBdLnRvTG93ZXJDYXNlKCl9JHt0YWdPclJlZGlyZWN0WzBdfV0ke3RhZ09yUmVkaXJlY3Quc2xpY2UoMSl9XFxcXHMqKFxcXFx8fH19KWApLnRlc3QobWFpblBhZ2VDb250ZW50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnJvbU1vdmUpIHRhZ1NlbGVjdC5zZXRWYWx1ZShbJ1IgZnJvbSBtb3ZlJ10pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIFJlZGlyZWN0IHRhcmdldCBpbnB1dCAqL1xuICAgICAgICAgICAgY29uc3QgcmVkaXJlY3RJbnB1dCA9IG5ldyBSZWRpcmVjdElucHV0V2lkZ2V0KHsgcGxhY2Vob2xkZXI6ICdUYXJnZXQgcGFnZSBuYW1lJywgcmVxdWlyZWQ6IHRydWUgfSwgdGhpcy5wYWdlVGl0bGVQYXJzZWQpO1xuICAgICAgICAgICAgcmVkaXJlY3RJbnB1dC5vbignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IHJlZGlyZWN0SW5wdXQuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UobmV3IFJlZ0V4cChgXihodHRwcz86KT8vezJ9PyR7bXcuY29uZmlnLmdldCgnd2dTZXJ2ZXInKS5yZXBsYWNlKC9eXFwvezJ9LywgJycpfS93aWtpL2ApLCAnJyk7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9eOi8sICcnKTtcblxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0SW5wdXQuc2V0VmFsdWUodmFsdWVbMF0udG9VcHBlckNhc2UoKSArIHZhbHVlLnNsaWNlKDEpLnJlcGxhY2VBbGwoJ18nLCAnICcpKTtcbiAgICAgICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Ugc3VibWl0QnV0dG9uLnNldERpc2FibGVkKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgdXBkYXRlU3VtbWFyeSh0aGlzLmV4aXN0cyk7XG4gICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnNldExhYmVsKCdTdWJtaXQnKTtcbiAgICAgICAgICAgICAgICBuZWVkc0NoZWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCByZWRpcmVjdElucHV0TGF5b3V0ID0gbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHJlZGlyZWN0SW5wdXQsIHsgbGFiZWw6IG5ldyBPTy51aS5IdG1sU25pcHBldCgnPGI+UmVkaXJlY3QgdGFyZ2V0OjwvYj4nKSwgYWxpZ246ICd0b3AnIH0pO1xuXG4gICAgICAgICAgICAvKiBSZWRpcmVjdCBjYXRlZ29yaXphdGlvbiB0ZW1wbGF0ZSBzZWxlY3Rpb24gKi9cbiAgICAgICAgICAgIGNvbnN0IHRhZ1NlbGVjdCA9IG5ldyBPTy51aS5NZW51VGFnTXVsdGlzZWxlY3RXaWRnZXQoe1xuICAgICAgICAgICAgICAgIGFsbG93QXJiaXRyYXJ5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBhbGxvd1Jlb3JkZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IE9iamVjdC5rZXlzKHRoaXMucmVkaXJlY3RUZW1wbGF0ZXMpLm1hcCgodGFnKSA9PiAoeyBkYXRhOiB0YWcsIGxhYmVsOiB0YWcgfSkpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAodGFnU2VsZWN0LmdldE1lbnUoKSBhcyBPTy51aS5NZW51U2VsZWN0V2lkZ2V0LkNvbmZpZ09wdGlvbnMpLmZpbHRlck1vZGUgPSAnc3Vic3RyaW5nJztcbiAgICAgICAgICAgIHRhZ1NlbGVjdC5vbignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvcnRlZFRhZ3MgPSAodGFnU2VsZWN0LmdldFZhbHVlKCkgYXMgc3RyaW5nW10pLnNvcnQoKGEsIGIpID0+IGEudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGIudG9Mb3dlckNhc2UoKSkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCh0YWdTZWxlY3QuZ2V0VmFsdWUoKSBhcyBzdHJpbmdbXSkuam9pbignOycpICE9PSBzb3J0ZWRUYWdzLmpvaW4oJzsnKSkgdGFnU2VsZWN0LnNldFZhbHVlKHNvcnRlZFRhZ3MpO1xuXG4gICAgICAgICAgICAgICAgdXBkYXRlU3VtbWFyeSh0aGlzLmV4aXN0cyk7XG4gICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnNldExhYmVsKCdTdWJtaXQnKTtcbiAgICAgICAgICAgICAgICBuZWVkc0NoZWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCB0YWdTZWxlY3RMYXlvdXQgPSBuZXcgT08udWkuRmllbGRMYXlvdXQodGFnU2VsZWN0LCB7IGxhYmVsOiBuZXcgT08udWkuSHRtbFNuaXBwZXQoJzxiPlJlZGlyZWN0IGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlKHMpOjwvYj4nKSwgYWxpZ246ICd0b3AnIH0pO1xuXG4gICAgICAgICAgICAvKiBTdW1tYXJ5IGlucHV0ICovXG4gICAgICAgICAgICBjb25zdCBzdW1tYXJ5SW5wdXQgPSBuZXcgT08udWkuQ29tYm9Cb3hJbnB1dFdpZGdldCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uczogW1xuICAgICAgICAgICAgICAgICAgICB7IGRhdGE6ICdSZXNvbHZlIGRvdWJsZSByZWRpcmVjdCcgfSwgLy9cbiAgICAgICAgICAgICAgICAgICAgeyBkYXRhOiAnUmVzb2x2ZSBzZWxmIHJlZGlyZWN0JyB9LFxuICAgICAgICAgICAgICAgICAgICB7IGRhdGE6ICdSZW1vdmUgaW5jb3JyZWN0IHJjYXRzJyB9LFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3Qgc3VtbWFyeUlucHV0TGF5b3V0ID0gbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHN1bW1hcnlJbnB1dCwgeyBsYWJlbDogbmV3IE9PLnVpLkh0bWxTbmlwcGV0KCc8Yj5TdW1tYXJ5OjwvYj4nKSwgYWxpZ246ICd0b3AnIH0pO1xuXG4gICAgICAgICAgICAvKiBTdWJtaXQgYnV0dG9uICovXG4gICAgICAgICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBuZXcgT08udWkuQnV0dG9uV2lkZ2V0KHsgbGFiZWw6ICdTdWJtaXQnLCBkaXNhYmxlZDogdHJ1ZSwgZmxhZ3M6IFsncHJvZ3Jlc3NpdmUnXSB9KTtcbiAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7XG5cbiAgICAgICAgICAgIGxldCBuZWVkc0NoZWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5vbignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIFtyZWRpcmVjdElucHV0LCB0YWdTZWxlY3QsIHN1bW1hcnlJbnB1dCwgc3VibWl0QnV0dG9uLCBzeW5jVGFsa0NoZWNrYm94LCBwYXRyb2xDaGVja2JveF0uZmlsdGVyKEJvb2xlYW4pKSAoZWxlbWVudCBhcyBPTy51aS5XaWRnZXQpLnNldERpc2FibGVkKHRydWUpO1xuICAgICAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRMYWJlbCgnQ2hlY2tpbmcgdGFyZ2V0IHZhbGlkaXR5Li4uJyk7XG5cbiAgICAgICAgICAgICAgICBsZXQgcGFyc2VkRGVzdGluYXRpb247XG5cbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvcnMgPSBbXTtcblxuICAgICAgICAgICAgICAgIC8qIFRpdGxlIHZhbGlkYXRpb24gKi9cbiAgICAgICAgICAgICAgICBpZiAobmVlZHNDaGVjaykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXN0aW5hdGlvbiA9IHJlZGlyZWN0SW5wdXQuZ2V0VmFsdWUoKS50cmltKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogSW52YWxpZCBjaGFyYWN0ZXJzICovXG4gICAgICAgICAgICAgICAgICAgIGlmICghL15cXHMqW15bXFxde3x9XStcXHMqJC8udGVzdChkZXN0aW5hdGlvbikpIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiAnaXMgbm90IGEgdmFsaWQgcGFnZSB0aXRsZSEnIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qIEZhaWxlZCBkdXJpbmcgdGl0bGUgcGFyc2luZyAqL1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkRGVzdGluYXRpb24gPSBtdy5UaXRsZS5uZXdGcm9tVGV4dChkZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9ycy5sZW5ndGggPT09IDApIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiAnaXMgbm90IGEgdmFsaWQgcGFnZSB0aXRsZSEnIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGFyc2VkRGVzdGluYXRpb24gJiYgZXJyb3JzLmxlbmd0aCA9PT0gMCkgZXJyb3JzLnB1c2goeyB0aXRsZTogZGVzdGluYXRpb24sIG1lc3NhZ2U6ICdpcyBub3QgYSB2YWxpZCBwYWdlIHRpdGxlIScgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogU2VsZiByZWRpcmVjdHMgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlZERlc3RpbmF0aW9uPy50b1N0cmluZygpID09PSB0aGlzLnBhZ2VUaXRsZVBhcnNlZC50b1N0cmluZygpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdjYW5ub3QgcmVkaXJlY3QgdG8gaXRzZWxmIScgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb25EYXRhID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdxdWVyeScsIGZvcm1hdHZlcnNpb246IDIsIHByb3A6ICdwYWdlcHJvcHMnLCB0aXRsZXM6IGRlc3RpbmF0aW9uIH0pLmNhdGNoKChlcnJvckNvZGU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogTm9uZXhpc3RlbnQgZGVzdGluYXRpb24gKi8gaWYgKGVycm9yQ29kZSA9PT0gJ21pc3Npbmd0aXRsZScpIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiAnZG9lcyBub3QgZXhpc3QhJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIE90aGVyIEFQSSBlcnJvciAqLyBlbHNlIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiBgd2FzIG5vdCBhYmxlIHRvIGJlIGZldGNoZWQgZnJvbSB0aGUgQVBJICgke2Vycm9yQ29kZX0pIWAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfSkpIGFzIFBhZ2Vwcm9wc1Jlc3VsdCB8IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uUGFyc2VSZXN1bHQgPSAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3BhcnNlJywgcGFnZTogZGVzdGluYXRpb24sIHByb3A6ICdzZWN0aW9ucycsIHJlZGlyZWN0czogJzEnIH0pKSBhcyBQYWdlUGFyc2VSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogRG91YmxlIHJlZGlyZWN0cyAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5yZWRpcmVjdHM/LlswXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb25SZWRpcmVjdCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5yZWRpcmVjdHNbMF0udG8gKyAoZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5yZWRpcmVjdHNbMF0udG9mcmFnbWVudCA/IGAjJHtkZXN0aW5hdGlvblBhcnNlUmVzdWx0LnBhcnNlLnJlZGlyZWN0c1swXS50b2ZyYWdtZW50fWAgOiAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGRlc3RpbmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBpcyBhIHJlZGlyZWN0IHRvIDxhIGhyZWY9XCIke213LnV0aWwuZ2V0VXJsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvblJlZGlyZWN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtkZXN0aW5hdGlvblJlZGlyZWN0fTwvYT4uIFJldGFyZ2V0IHRvIHRoYXQgcGFnZSBpbnN0ZWFkLCBhcyBkb3VibGUgcmVkaXJlY3RzIGFyZW4ndCBhbGxvd2VkLmAsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qIE5vbmV4aXN0ZW50IHNlY3Rpb24gKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uLnNwbGl0KCcjJykubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsaWRTZWN0aW9uID0gZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5zZWN0aW9ucy5maW5kKChzZWN0aW9uKSA9PiBzZWN0aW9uLmxpbmUgPT09IGRlc3RpbmF0aW9uLnNwbGl0KCcjJylbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkU2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcygnUiB0byBhbmNob3InKSkgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgdGFnZ2VkIGFzIGEgcmVkaXJlY3QgdG8gYW4gYW5jaG9yLCBidXQgaXQgaXMgYWN0dWFsbHkgYSByZWRpcmVjdCB0byBhIHNlY3Rpb24hJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIHNlY3Rpb24nKSkgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgYSByZWRpcmVjdCB0byBhIHNlY3Rpb24sIGJ1dCBpdCBpcyBub3QgdGFnZ2VkIHdpdGggPGNvZGU+e3tSIHRvIHNlY3Rpb259fTwvY29kZT4hJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb25Db250ZW50ID0gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdxdWVyeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogJ3JldmlzaW9ucycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydnByb3A6ICdjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ2c2xvdHM6ICcqJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlczogcGFyc2VkRGVzdGluYXRpb24hLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSBhcyBQYWdlUmV2aXNpb25zUmVzdWx0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5xdWVyeS5wYWdlc1swXS5yZXZpc2lvbnNbMF0uc2xvdHMubWFpbi5jb250ZW50O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW5jaG9ycyA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uKGRlc3RpbmF0aW9uQ29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hdGNoKC8oPzw9e3tcXHMqP1tBYV0oPzpuY2hvcnM/fG5jaG9yIGZvciByZWRpcmVjdHxua2VyfE5DSE9SfG5jKVxccyo/XFx8KS4rPyg/PX19KS9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPy5tYXAoKGFuY2hvcjogc3RyaW5nKSA9PiBhbmNob3Iuc3BsaXQoJ3wnKS5tYXAoKHBhcnQpID0+IHBhcnQudHJpbSgpKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8uZmxhdCgpID8/IFtdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uKGRlc3RpbmF0aW9uQ29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hdGNoKC8oPzw9e3tcXHMqPyg/OltWdl0oPzppc2libGUgYW5jaG9ycz98aXNhbmN8QW5jaHxhbmNob3J8aXNpYmxlYW5jaG9yfGEpfFtBYV0oPzpuY2hvcmR8Y2hvcmVkfG5jaG9yXFwrKXxbVHRdZXh0IGFuY2hvcilcXHMqP1xcfCkuKz8oPz0oPzwhIXw9KX19KS9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPy5tYXAoKGFuY2hvcjogc3RyaW5nKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoJ3wnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKChwYXJ0KSA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigocGFydCkgPT4gIS9edGV4dFxccyo/PS8udGVzdChwYXJ0KSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/LmZsYXQoKSA/PyBbXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLihkZXN0aW5hdGlvbkNvbnRlbnQubWF0Y2goLyg/PD1pZD0pXCI/Lis/KD89XCJ8PnxcXHwpL2cpPy5tYXAoKGFuY2hvcjogc3RyaW5nKSA9PiBhbmNob3IudHJpbSgpKSA/PyBbXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5jaG9ycy5pbmNsdWRlcyhkZXN0aW5hdGlvbi5zcGxpdCgnIycpWzFdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gc2VjdGlvbicpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdpcyB0YWdnZWQgYXMgYSByZWRpcmVjdCB0byBhIHNlY3Rpb24sIGJ1dCBpdCBpcyBhY3R1YWxseSBhIHJlZGlyZWN0IHRvIGFuIGFuY2hvciEnIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIGFuY2hvcicpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdpcyBhIHJlZGlyZWN0IHRvIGFuIGFuY2hvciwgYnV0IGl0IGlzIG5vdCB0YWdnZWQgd2l0aCA8Y29kZT57e1IgZnJvbSBhbmNob3J9fTwvY29kZT4hJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiBgaXMgYSByZWRpcmVjdCB0byA8YSBocmVmPVwiJHttdy51dGlsLmdldFVybChkZXN0aW5hdGlvbil9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtkZXN0aW5hdGlvbn08L2E+LCBidXQgdGhhdCBzZWN0aW9uIG9yIGFuY2hvciBkb2VzIG5vdCBleGlzdCFgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLyogSW1wcm9wZXJseSB0YWdnZWQgYXMgcmVkaXJlY3QgdG8gc2VjdGlvbi9hbmNob3IgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uLnNwbGl0KCcjJykubGVuZ3RoID09PSAxICYmICh0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcygnUiB0byBzZWN0aW9uJykgfHwgdGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gYW5jaG9yJykpKVxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgbm90IGEgcmVkaXJlY3QgdG8gYSBzZWN0aW9uL2FuY2hvciwgYnV0IGl0IGlzIHRhZ2dlZCB3aXRoIDxjb2RlPnt7UiBmcm9tIHNlY3Rpb259fTwvY29kZT4gb3IgPGNvZGU+e3tSIGZyb20gYW5jaG9yfX08L2NvZGU+IScgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogUmVkaXJlY3QgdG8gZGlzYW1iaWd1YXRpb24gcGFnZSB3aXRob3V0IHRlbXBsYXRlICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uRGF0YSEucXVlcnkucGFnZXNbMF0ucGFnZXByb3BzICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGlzYW1iaWd1YXRpb24nIGluIGRlc3RpbmF0aW9uRGF0YSEucXVlcnkucGFnZXNbMF0ucGFnZXByb3BzICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdSIGZyb20gYW1iaWd1b3VzIHNvcnQgbmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1IgZnJvbSBhbWJpZ3VvdXMgdGVybScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1IgZnJvbSBpbmNvbXBsZXRlIGRpc2FtYmlndWF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUiBmcm9tIGluY29ycmVjdCBkaXNhbWJpZ3VhdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1IgZnJvbSBvdGhlciBkaXNhbWJpZ3VhdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBdLnNvbWUoKHRlbXBsYXRlKSA9PiB0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcyh0ZW1wbGF0ZSkpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogJ2lzIGEgcmVkaXJlY3QgdG8gYSBkaXNhbWJpZ3VhdGlvbiBwYWdlLCBidXQgaXQgaXMgbm90IHRhZ2dlZCB3aXRoIGEgZGlzYW1iaWd1YXRpb24gY2F0ZWdvcml6YXRpb24gdGVtcGxhdGUhJyB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvKiBJbXByb3Blcmx5IHRhZ2dlZCBhcyByZWRpcmVjdCB0byBkaXNhbWJpZ3VhdGlvbiBwYWdlICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uRGF0YSEucXVlcnkucGFnZXNbMF0ucGFnZXByb3BzICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhKCdkaXNhbWJpZ3VhdGlvbicgaW4gZGVzdGluYXRpb25EYXRhIS5xdWVyeS5wYWdlc1swXS5wYWdlcHJvcHMpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBbJ1IgZnJvbSBhbWJpZ3VvdXMgc29ydCBuYW1lJywgJ1IgZnJvbSBhbWJpZ3VvdXMgdGVybScsICdSIHRvIGRpc2FtYmlndWF0aW9uIHBhZ2UnLCAnUiBmcm9tIGluY29tcGxldGUgZGlzYW1iaWd1YXRpb24nXS5zb21lKCh0ZW1wbGF0ZSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcyh0ZW1wbGF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogJ2lzIG5vdCBhIHJlZGlyZWN0IHRvIGEgZGlzYW1iaWd1YXRpb24gcGFnZSwgYnV0IGl0IGlzIHRhZ2dlZCB3aXRoIGEgZGlzYW1iaWd1YXRpb24gY2F0ZWdvcml6YXRpb24gdGVtcGxhdGUhJyB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvKiB7e1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZX19IHdpdGhvdXQgXCIgKGRpc2FtYmlndWF0aW9uKVwiIGF0IGVuZCBvZiB0aXRsZSAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZScpICYmICF0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRNYWluVGV4dCgpLmVuZHNXaXRoKCcgKGRpc2FtYmlndWF0aW9uKScpKVxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpcyB0YWdnZWQgd2l0aCA8Y29kZT57e1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZX19PC9jb2RlPiwgYnV0IHRoaXMgdGl0bGUgZG9lcyBub3QgZW5kIHdpdGggXCIgKGRpc2FtYmlndWF0aW9uKVwiLiBVc2UgPGNvZGU+e3tSIGZyb20gYW1iaWd1b3VzIHRlcm19fTwvY29kZT4gb3IgYSBzaW1pbGFyIGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlIGluc3RlYWQhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qIFN5bmNpbmcgdGFsayBwYWdlIGJ1dCB0YWxrIHBhZ2UgZXhpc3RzIGFuZCBpc24ndCBhIHJlZGlyZWN0ICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChzeW5jVGFsa0NoZWNrYm94Py5pc1NlbGVjdGVkKCkgJiYgIXRhbGtEYXRhIS5xdWVyeS5wYWdlc1swXS5taXNzaW5nICYmICF0YWxrRGF0YSEucXVlcnkucGFnZXNbMF0ucmVkaXJlY3QpXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7IHRpdGxlOiB0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKSwgbWVzc2FnZTogJ2V4aXN0cywgYnV0IGlzIG5vdCBhIHJlZGlyZWN0IScgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmVkaXJlY3QtaGVscGVyLXdhcm5pbmcnKSkgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB7IHRpdGxlLCBtZXNzYWdlIH0gb2YgZXJyb3JzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsYWJlbCA9IG5ldyBPTy51aS5IdG1sU25pcHBldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJHt0aXRsZSA/IGA8YSBocmVmPVwiJHttdy51dGlsLmdldFVybCh0aXRsZSl9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHt0aXRsZX08L2E+YCA6ICdUaGlzIHBhZ2UnfSAke21lc3NhZ2V9IENsaWNrIGFnYWluIHdpdGhvdXQgbWFraW5nIGNoYW5nZXMgdG8gc3VibWl0IGFueXdheS5gLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhcm5pbmdNZXNzYWdlID0gbmV3IE9PLnVpLk1lc3NhZ2VXaWRnZXQoeyB0eXBlOiAnZXJyb3InLCBjbGFzc2VzOiBbJ3JlZGlyZWN0LWhlbHBlci13YXJuaW5nJ10sIGlubGluZTogdHJ1ZSwgbGFiZWwgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTWVzc2FnZS4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4JztcblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yQm94LiRlbGVtZW50WzBdLmFwcGVuZCh3YXJuaW5nTWVzc2FnZS4kZWxlbWVudFswXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgW3JlZGlyZWN0SW5wdXQsIHRhZ1NlbGVjdCwgc3VtbWFyeUlucHV0LCBzdWJtaXRCdXR0b24sIHN5bmNUYWxrQ2hlY2tib3gsIHBhdHJvbENoZWNrYm94XS5maWx0ZXIoQm9vbGVhbikpIChlbGVtZW50IGFzIE9PLnVpLldpZGdldCkuc2V0RGlzYWJsZWQoZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRMYWJlbCgnU3VibWl0IGFueXdheScpO1xuICAgICAgICAgICAgICAgICAgICBuZWVkc0NoZWNrID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHBhcnNlZERlc3RpbmF0aW9uID0gbXcuVGl0bGUubmV3RnJvbVRleHQocmVkaXJlY3RJbnB1dC5nZXRWYWx1ZSgpKTtcblxuICAgICAgICAgICAgICAgIC8qIEVkaXQvY3JlYXRlIHJlZGlyZWN0ICovXG4gICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnNldExhYmVsKGAke3RoaXMuZXhpc3RzID8gJ0VkaXRpbmcnIDogJ0NyZWF0aW5nJ30gcmVkaXJlY3QuLi5gKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IFtcbiAgICAgICAgICAgICAgICAgICAgYCNSRURJUkVDVCBbWyR7cmVkaXJlY3RJbnB1dC5nZXRWYWx1ZSgpLnRyaW0oKX1dXWAsIC8vXG4gICAgICAgICAgICAgICAgICAgIHRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYHt7UmVkaXJlY3QgY2F0ZWdvcnkgc2hlbGx8XFxuJHsodGFnU2VsZWN0LmdldFZhbHVlKCkgYXMgc3RyaW5nW10pLm1hcCgodGFnKSA9PiBge3ske3RhZ30ke29sZFJlZGlyZWN0VGFnRGF0YT8uW3RhZ10gPyBgfCR7b2xkUmVkaXJlY3RUYWdEYXRhW3RhZ119YCA6ICcnfX19YCkuam9pbignXFxuJyl9XFxufX1gXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG9sZFN0cmF5VGV4dCxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJ1xcblxcbicpO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgc3VtbWFyeSA9IChzdW1tYXJ5SW5wdXQuZ2V0VmFsdWUoKSB8fCAoc3VtbWFyeUlucHV0LiR0YWJJbmRleGVkWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnBsYWNlaG9sZGVyKSArICcgKHZpYSBbW1VzZXI6RWVqaXQ0My9zY3JpcHRzL3JlZGlyZWN0LWhlbHBlcnxyZWRpcmVjdC1oZWxwZXJdXSknO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IG13LkFwaSgpXG4gICAgICAgICAgICAgICAgICAgIC5lZGl0KHRoaXMucGFnZVRpdGxlLCAoKSA9PiAoeyB0ZXh0OiBvdXRwdXQsIHN1bW1hcnkgfSkpXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9ySW5mbzogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3JDb2RlID09PSAnbm9jcmVhdGUtbWlzc2luZycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBtdy5BcGkoKS5jcmVhdGUodGhpcy5wYWdlVGl0bGUsIHsgc3VtbWFyeSB9LCBvdXRwdXQpLmNhdGNoKChlcnJvckNvZGU6IHN0cmluZywgZXJyb3JJbmZvOiBNZWRpYVdpa2lEYXRhRXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBjcmVhdGluZyAke3RoaXMucGFnZVRpdGxlfTogJHtlcnJvckluZm8/LmVycm9yLmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeShgRXJyb3IgZWRpdGluZyBvciBjcmVhdGluZyAke3RoaXMucGFnZVRpdGxlfTogJHtlcnJvckluZm8/LmVycm9yLmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgbXcubm90aWZ5KGBSZWRpcmVjdCAke3RoaXMuZXhpc3RzID8gJ2VkaXRlZCcgOiAnY3JlYXRlZCd9IHN1Y2Nlc3NmdWxseSFgLCB7IHR5cGU6ICdzdWNjZXNzJyB9KTtcblxuICAgICAgICAgICAgICAgIC8qIFN5bmMgdGFsayBwYWdlIGNoZWNrYm94IGhhbmRsZXIgKi9cbiAgICAgICAgICAgICAgICBpZiAoc3luY1RhbGtDaGVja2JveD8uaXNTZWxlY3RlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRMYWJlbCgnRWRpdGluZyB0YWxrIHBhZ2UuLi4nKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcm9tTW92ZSA9IHRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIGZyb20gbW92ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIGAjUkVESVJFQ1QgW1ske3BhcnNlZERlc3RpbmF0aW9uIS5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKX1dXWAsIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tTW92ZSA/ICd7e1JlZGlyZWN0IGNhdGVnb3J5IHNoZWxsfFxcbnt7UiBmcm9tIG1vdmV9fVxcbn19JyA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCdcXG5cXG4nKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWxrUGFnZSA9IHRoaXMucGFnZVRpdGxlUGFyc2VkLmdldFRhbGtQYWdlKCkhLmdldFByZWZpeGVkVGV4dCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhbGtSZXN1bHQgPSBhd2FpdCBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lZGl0KHRhbGtQYWdlLCAoKSA9PiAoeyB0ZXh0OiBvdXRwdXQsIHN1bW1hcnk6ICdTeW5jaW5nIHJlZGlyZWN0IGZyb20gbWFpbiBwYWdlICh2aWEgW1tVc2VyOkVlaml0NDMvc2NyaXB0cy9yZWRpcmVjdC1oZWxwZXJ8cmVkaXJlY3QtaGVscGVyXV0pJyB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9ySW5mbzogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yQ29kZSA9PT0gJ25vY3JlYXRlLW1pc3NpbmcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IG13LkFwaSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3JlYXRlKHRhbGtQYWdlLCB7IHN1bW1hcnk6ICdTeW5jaW5nIHJlZGlyZWN0IGZyb20gbWFpbiBwYWdlICh2aWEgW1tVc2VyOkVlaml0NDMvc2NyaXB0cy9yZWRpcmVjdC1oZWxwZXJ8cmVkaXJlY3QtaGVscGVyXV0pJyB9LCBvdXRwdXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yQ29kZTogc3RyaW5nLCBlcnJvckluZm86IE1lZGlhV2lraURhdGFFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeShgRXJyb3IgY3JlYXRpbmcgJHt0YWxrUGFnZX06ICR7ZXJyb3JJbmZvPy5lcnJvci5pbmZvID8/ICdVbmtub3duIGVycm9yJ30gKCR7ZXJyb3JDb2RlfSlgLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBlZGl0aW5nIG9yIGNyZWF0aW5nICR7dGFsa1BhZ2V9OiAke2Vycm9ySW5mbz8uZXJyb3IuaW5mbyA/PyAnVW5rbm93biBlcnJvcid9ICgke2Vycm9yQ29kZX0pYCwgeyB0eXBlOiAnZXJyb3InIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhbGtSZXN1bHQpIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoJ1RhbGsgcGFnZSBzeW5jZWQgc3VjY2Vzc2Z1bGx5IScsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qIFBhdHJvbCBjaGVja2JveCBoYW5kbGVyICovXG4gICAgICAgICAgICAgICAgaWYgKHBhdHJvbENoZWNrYm94Py5pc1NlbGVjdGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnNldExhYmVsKCdQYXRyb2xsaW5nIHJlZGlyZWN0Li4uJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF0cm9sTGluazogSFRNTEFuY2hvckVsZW1lbnQgfCBudWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhdHJvbGxpbmsgYScpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXJrUmV2aWV3ZWRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbXdlLXB0LW1hcmstYXMtcmV2aWV3ZWQtYnV0dG9uJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQgfCBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXRyb2xMaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRyb2xSZXN1bHQgPSBhd2FpdCBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zdFdpdGhUb2tlbigncGF0cm9sJywgeyBhY3Rpb246ICdwYXRyb2wnLCByY2lkOiBuZXcgVVJMKHBhdHJvbExpbmsuaHJlZikuc2VhcmNoUGFyYW1zLmdldCgncmNpZCcpISB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9ySW5mbzogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeShgRXJyb3IgcGF0cm9sbGluZyAke3RoaXMucGFnZVRpdGxlfSB2aWEgQVBJOiAke2Vycm9ySW5mbz8uZXJyb3IuaW5mbyA/PyAnVW5rbm93biBlcnJvcid9ICgke2Vycm9yQ29kZX0pYCwgeyB0eXBlOiAnZXJyb3InIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXRyb2xSZXN1bHQpIG13Lm5vdGlmeSgnUmVkaXJlY3QgcGF0cm9sbGVkIHN1Y2Nlc3NmdWxseSEnLCB7IHR5cGU6ICdzdWNjZXNzJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXJrUmV2aWV3ZWRCdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtSZXZpZXdlZEJ1dHRvbi5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KCdSZWRpcmVjdCBwYXRyb2xsZWQgc3VjY2Vzc2Z1bGx5IScsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgbXcubm90aWZ5KCdQYWdlIGN1cmF0aW9uIHRvb2xiYXIgbm90IGZvdW5kLCByZWRpcmVjdCBjYW5ub3QgYmUgcGF0cm9sbGVkIScsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzdWJtaXRCdXR0b24uc2V0TGFiZWwoJ0NvbXBsZXRlLCByZWxvYWRpbmcuLi4nKTtcblxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbXcudXRpbC5nZXRVcmwodGhpcy5wYWdlVGl0bGUsIHsgcmVkaXJlY3Q6ICdubycgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IHRhbGtEYXRhOiBQYWdlSW5mb1Jlc3VsdCB8IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgbGV0IHN5bmNUYWxrQ2hlY2tib3g6IE9PLnVpLkNoZWNrYm94SW5wdXRXaWRnZXQgfCB1bmRlZmluZWQsIHN5bmNUYWxrTGF5b3V0OiBPTy51aS5XaWRnZXQgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMucGFnZVRpdGxlUGFyc2VkLmlzVGFsa1BhZ2UoKSkge1xuICAgICAgICAgICAgICAgIHRhbGtEYXRhID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdxdWVyeScsIGZvcm1hdHZlcnNpb246IDIsIHByb3A6ICdpbmZvJywgdGl0bGVzOiB0aGlzLnBhZ2VUaXRsZVBhcnNlZC5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKSB9KSkgYXMgUGFnZUluZm9SZXN1bHQ7XG4gICAgICAgICAgICAgICAgc3luY1RhbGtDaGVja2JveCA9IG5ldyBPTy51aS5DaGVja2JveElucHV0V2lkZ2V0KHsgc2VsZWN0ZWQ6ICEhdGFsa0RhdGEucXVlcnkucGFnZXNbMF0ucmVkaXJlY3QgfSk7XG5cbiAgICAgICAgICAgICAgICBzeW5jVGFsa0xheW91dCA9IG5ldyBPTy51aS5XaWRnZXQoeyBjb250ZW50OiBbbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHN5bmNUYWxrQ2hlY2tib3gsIHsgbGFiZWw6ICdTeW5jIHRhbGsgcGFnZScsIGFsaWduOiAnaW5saW5lJyB9KV0gfSk7XG4gICAgICAgICAgICAgICAgc3luY1RhbGtMYXlvdXQuJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luQm90dG9tID0gJzAnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBtYXJrQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI213ZS1wdC1tYXJrIC5td2UtcHQtdG9vbC1pY29uJykgYXMgSFRNTEltYWdlRWxlbWVudCB8IG51bGw7XG4gICAgICAgICAgICBtYXJrQnV0dG9uPy5jbGljaygpO1xuICAgICAgICAgICAgbWFya0J1dHRvbj8uY2xpY2soKTtcblxuICAgICAgICAgICAgbGV0IHNob3VsZFByb21wdFBhdHJvbDtcbiAgICAgICAgICAgIGlmIChtdy5jb25maWcuZ2V0KCd3Z05hbWVzcGFjZU51bWJlcicpICE9PSAwKSBzaG91bGRQcm9tcHRQYXRyb2wgPSBmYWxzZTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXRyb2xsaW5rJykpIHNob3VsZFByb21wdFBhdHJvbCA9IHRydWU7XG4gICAgICAgICAgICBlbHNlIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbXdlLXB0LW1hcmstYXMtcmV2aWV3ZWQtYnV0dG9uJykpIHNob3VsZFByb21wdFBhdHJvbCA9IHRydWU7XG4gICAgICAgICAgICBlbHNlIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbXdlLXB0LW1hcmstYXMtdW5yZXZpZXdlZC1idXR0b24nKSkgc2hvdWxkUHJvbXB0UGF0cm9sID0gZmFsc2U7XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIW13LmNvbmZpZy5nZXQoJ3dnQXJ0aWNsZUlkJykpIHNob3VsZFByb21wdFBhdHJvbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJQZXJtaXNzaW9ucyA9IChhd2FpdCBuZXcgbXcuQXBpKCkuZ2V0KHsgYWN0aW9uOiAncXVlcnknLCBtZXRhOiAndXNlcmluZm8nLCB1aXByb3A6ICdyaWdodHMnIH0pKSBhcyBVc2VyUGVybWlzc2lvbnNSZXNwb25zZTtcbiAgICAgICAgICAgICAgICBpZiAoIXVzZXJQZXJtaXNzaW9ucy5xdWVyeS51c2VyaW5mby5yaWdodHMuaW5jbHVkZXMoJ3BhdHJvbCcpKSBzaG91bGRQcm9tcHRQYXRyb2wgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdHJvbFJlc3BvbnNlID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdwYWdldHJpYWdlbGlzdCcsIHBhZ2VfaWQ6IG13LmNvbmZpZy5nZXQoJ3dnQXJ0aWNsZUlkJykgfSkpIGFzIFBhZ2VUcmlhZ2VMaXN0UmVzcG9uc2U7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uXG5cbiAgICAgICAgICAgICAgICBpZiAocGF0cm9sUmVzcG9uc2UucGFnZXRyaWFnZWxpc3QucGFnZXNbMF0/LnVzZXJfbmFtZSA9PT0gbXcuY29uZmlnLmdldCgnd2dVc2VyTmFtZScpKSBzaG91bGRQcm9tcHRQYXRyb2wgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5yZXN1bHQgIT09ICdzdWNjZXNzJyB8fCBwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5wYWdlcy5sZW5ndGggPT09IDApIHNob3VsZFByb21wdFBhdHJvbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGVsc2Ugc2hvdWxkUHJvbXB0UGF0cm9sID0gIU51bWJlci5wYXJzZUludChwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5wYWdlc1swXT8ucGF0cm9sX3N0YXR1cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBwYXRyb2xDaGVja2JveDogT08udWkuQ2hlY2tib3hJbnB1dFdpZGdldCB8IHVuZGVmaW5lZCwgcGF0cm9sTGF5b3V0OiBPTy51aS5XaWRnZXQgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoc2hvdWxkUHJvbXB0UGF0cm9sKSB7XG4gICAgICAgICAgICAgICAgcGF0cm9sQ2hlY2tib3ggPSBuZXcgT08udWkuQ2hlY2tib3hJbnB1dFdpZGdldCh7IHNlbGVjdGVkOiB0cnVlIH0pO1xuXG4gICAgICAgICAgICAgICAgcGF0cm9sTGF5b3V0ID0gbmV3IE9PLnVpLldpZGdldCh7IGNvbnRlbnQ6IFtuZXcgT08udWkuRmllbGRMYXlvdXQocGF0cm9sQ2hlY2tib3gsIHsgbGFiZWw6ICdNYXJrIGFzIHBhdHJvbGxlZCcsIGFsaWduOiAnaW5saW5lJyB9KV0gfSk7XG4gICAgICAgICAgICAgICAgcGF0cm9sTGF5b3V0LiRlbGVtZW50WzBdLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc3VibWl0TGF5b3V0ID0gbmV3IE9PLnVpLkhvcml6b250YWxMYXlvdXQoeyBpdGVtczogW3N1Ym1pdEJ1dHRvbiwgc3luY1RhbGtMYXlvdXQsIHBhdHJvbExheW91dF0uZmlsdGVyKEJvb2xlYW4pIGFzIE9PLnVpLldpZGdldFtdIH0pO1xuICAgICAgICAgICAgc3VibWl0TGF5b3V0LiRlbGVtZW50WzBdLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JztcblxuICAgICAgICAgICAgLyogQWRkIGVsZW1lbnRzIHRvIHNjcmVlbiAqL1xuICAgICAgICAgICAgZWRpdG9yQm94LiRlbGVtZW50WzBdLmFwcGVuZChcbiAgICAgICAgICAgICAgICAuLi4oW3N5bmNXaXRoTWFpbkJ1dHRvbj8uJGVsZW1lbnQ/LlswXSwgcmVkaXJlY3RJbnB1dExheW91dC4kZWxlbWVudFswXSwgdGFnU2VsZWN0TGF5b3V0LiRlbGVtZW50WzBdLCBzdW1tYXJ5SW5wdXRMYXlvdXQuJGVsZW1lbnRbMF0sIHN1Ym1pdExheW91dC4kZWxlbWVudFswXV0uZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICBCb29sZWFuLFxuICAgICAgICAgICAgICAgICkgYXMgSFRNTEVsZW1lbnRbXSksXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUZXh0LnByZXBlbmQoZWRpdG9yQm94LiRlbGVtZW50WzBdKTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVcGRhdGVzIHRoZSBzdW1tYXJ5IGlucHV0IHBsYWNlaG9sZGVyLlxuICAgICAgICAgICAgICogQHBhcmFtIGV4aXN0cyBXaGV0aGVyIHRoZSByZWRpcmVjdCBhbHJlYWR5IGV4aXN0cy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlU3VtbWFyeShleGlzdHM6IGJvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWRpcmVjdFZhbHVlID0gcmVkaXJlY3RJbnB1dC5nZXRWYWx1ZSgpLnRyaW0oKTtcblxuICAgICAgICAgICAgICAgIGlmICghcmVkaXJlY3RWYWx1ZSkgKHN1bW1hcnlJbnB1dC4kdGFiSW5kZXhlZFswXSBhcyBIVE1MSW5wdXRFbGVtZW50KS5wbGFjZWhvbGRlciA9ICcnO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRDaGFuZ2VkID0gcmVkaXJlY3RWYWx1ZSAhPT0gb2xkUmVkaXJlY3RUYXJnZXQ/LnJlcGxhY2VBbGwoJ18nLCAnICcpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdzQ2hhbmdlZCA9IHRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmpvaW4oJzsnKSAhPT0gb2xkUmVkaXJlY3RUYWdzPy5qb2luKCc7Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldENoYW5nZWQgJiYgdGFnc0NoYW5nZWQpIChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSBgQ2hhbmdpbmcgcmVkaXJlY3QgdG8gW1ske3JlZGlyZWN0VmFsdWV9XV0gYW5kIGNoYW5naW5nIGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlc2A7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRhcmdldENoYW5nZWQpIChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSBgQ2hhbmdpbmcgcmVkaXJlY3QgdG8gW1ske3JlZGlyZWN0VmFsdWV9XV1gO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0YWdzQ2hhbmdlZCkgKHN1bW1hcnlJbnB1dC4kdGFiSW5kZXhlZFswXSBhcyBIVE1MSW5wdXRFbGVtZW50KS5wbGFjZWhvbGRlciA9ICdDaGFuZ2luZyBjYXRlZ29yaXphdGlvbiB0ZW1wbGF0ZXMnO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSAnUmVkaXJlY3QgY2xlYW51cCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSBgQ3JlYXRpbmcgcmVkaXJlY3QgdG8gW1ske3JlZGlyZWN0VmFsdWV9XV1gO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBMb2FkIGN1cnJlbnQgdGFyZ2V0IGFuZCB0YWdzLCBpZiBhcHBsaWNhYmxlICovXG4gICAgICAgICAgICBsZXQgb2xkUmVkaXJlY3RUYXJnZXQ6IHN0cmluZyB8IHVuZGVmaW5lZCwgb2xkUmVkaXJlY3RUYWdzOiBzdHJpbmdbXSB8IHVuZGVmaW5lZCwgb2xkUmVkaXJlY3RUYWdEYXRhOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkLCBvbGRTdHJheVRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmICh0aGlzLmV4aXN0cykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhZ2VDb250ZW50ID0gKFxuICAgICAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3F1ZXJ5JywgZm9ybWF0dmVyc2lvbjogMiwgcHJvcDogJ3JldmlzaW9ucycsIHJ2cHJvcDogJ2NvbnRlbnQnLCBydnNsb3RzOiAnKicsIHRpdGxlczogdGhpcy5wYWdlVGl0bGUgfSkpIGFzIFBhZ2VSZXZpc2lvbnNSZXN1bHRcbiAgICAgICAgICAgICAgICApLnF1ZXJ5LnBhZ2VzWzBdLnJldmlzaW9uc1swXS5zbG90cy5tYWluLmNvbnRlbnQudHJpbSgpO1xuXG4gICAgICAgICAgICAgICAgb2xkUmVkaXJlY3RUYXJnZXQgPSAvXiNyZWRpcmVjdDo/XFxzKlxcW1xcW1xccyooW15bXFxde3x9XSs/KVxccyooPzpcXHxbXltcXF17fH1dKz8pP11dXFxzKi9pLmV4ZWMocGFnZUNvbnRlbnQpPy5bMV07XG4gICAgICAgICAgICAgICAgb2xkUmVkaXJlY3RUYWdzID0gKFxuICAgICAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyh0aGlzLnJlZGlyZWN0VGVtcGxhdGVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgoW3RhZywgcmVkaXJlY3RzXSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbdGFnLCAuLi5yZWRpcmVjdHNdLnNvbWUoKHRhZ09yUmVkaXJlY3QpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBSZWdFeHAoYHt7XFxcXHMqWyR7dGFnT3JSZWRpcmVjdFswXS50b0xvd2VyQ2FzZSgpfSR7dGFnT3JSZWRpcmVjdFswXX1dJHt0YWdPclJlZGlyZWN0LnNsaWNlKDEpfVxcXFxzKihcXFxcfHx9fSlgKS50ZXN0KHBhZ2VDb250ZW50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGFnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW11cbiAgICAgICAgICAgICAgICApLnNvcnQoKGEsIGIpID0+IGEudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGIudG9Mb3dlckNhc2UoKSkpO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxSZWRpcmVjdFRhZ3MgPSBPYmplY3QuZW50cmllcyh0aGlzLnJlZGlyZWN0VGVtcGxhdGVzKVxuICAgICAgICAgICAgICAgICAgICAuZmxhdE1hcCgoW3RhZywgcmVkaXJlY3RzXSkgPT4gW3RhZywgLi4ucmVkaXJlY3RzXSlcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgodGFnT3JSZWRpcmVjdCkgPT4gKG5ldyBSZWdFeHAoYHt7XFxcXHMqWyR7dGFnT3JSZWRpcmVjdFswXS50b0xvd2VyQ2FzZSgpfSR7dGFnT3JSZWRpcmVjdFswXX1dJHt0YWdPclJlZGlyZWN0LnNsaWNlKDEpfVxcXFxzKihcXFxcfHx9fSlgKS50ZXN0KHBhZ2VDb250ZW50KSA/IHRhZ09yUmVkaXJlY3QgOiBudWxsKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKSBhcyBzdHJpbmdbXTtcblxuICAgICAgICAgICAgICAgIG9sZFJlZGlyZWN0VGFnRGF0YSA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxSZWRpcmVjdFRhZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKHRhZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbmV3IFJlZ0V4cChge3tcXFxccypbJHt0YWdbMF0udG9Mb3dlckNhc2UoKX0ke3RhZ1swXX1dJHt0YWcuc2xpY2UoMSl9XFxcXHw/KC4qPylcXFxccyp9fWApLmV4ZWMocGFnZUNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VGFnID0gT2JqZWN0LmVudHJpZXModGhpcy5yZWRpcmVjdFRlbXBsYXRlcykuZmluZCgoW3RlbXBsYXRlLCByZWRpcmVjdHNdKSA9PiBbdGVtcGxhdGUsIC4uLnJlZGlyZWN0c10uaW5jbHVkZXModGFnKSk/LlswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaCA/IFtuZXdUYWcsIG1hdGNoWzFdXSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKSBhcyBbc3RyaW5nLCBzdHJpbmddW10sXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBvbGRTdHJheVRleHQgPSBbXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VDb250ZW50Lm1hdGNoKC97e3Nob3J0IGRlc2NyaXB0aW9uXFx8Lio/fX0vaSk/LlswXSxcbiAgICAgICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7RElTUExBWVRJVExFOi4qP319Lyk/LlswXSxcbiAgICAgICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7aXRhbGljIHRpdGxlXFx8Py4qP319L2kpPy5bMF0sXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VDb250ZW50Lm1hdGNoKC97e0RFRkFVTFRTT1JUOi4qP319Lyk/LlswXSxcbiAgICAgICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7dGl0bGUgbGFuZ3VhZ2VcXHwuKj99fS8pPy5bMF0sXG4gICAgICAgICAgICAgICAgICAgIC4uLihwYWdlQ29udGVudC5tYXRjaCgvXFxbXFxbW0NjXWF0ZWdvcnk6Lis/XV0vZykgPz8gW10pLFxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAgICAgICAgICAgICAuam9pbignXFxuJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAob2xkUmVkaXJlY3RUYXJnZXQpIHJlZGlyZWN0SW5wdXQuc2V0VmFsdWUob2xkUmVkaXJlY3RUYXJnZXQucmVwbGFjZUFsbCgnXycsICcgJykpO1xuICAgICAgICAgICAgICAgIGVsc2UgbXcubm90aWZ5KCdDb3VsZCBub3QgZmluZCByZWRpcmVjdCB0YXJnZXQhJywgeyB0eXBlOiAnZXJyb3InIH0pO1xuICAgICAgICAgICAgICAgIHRhZ1NlbGVjdC5zZXRWYWx1ZShvbGRSZWRpcmVjdFRhZ3MpO1xuXG4gICAgICAgICAgICAgICAgdXBkYXRlU3VtbWFyeSh0aGlzLmV4aXN0cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZXcgUmVkaXJlY3RIZWxwZXIoKS5ydW4oKTtcbn0pO1xuIl0sCiAgIm1hcHBpbmdzIjogIjtBQTJCQSxHQUFHLE9BQU8sTUFBTSxDQUFDLGtCQUFrQixnQkFBZ0IsbUJBQW1CLGdDQUFnQyxtQ0FBbUMsR0FBRyxNQUFNO0FBQUEsRUFPOUksTUFBTSw0QkFBNEIsR0FBRyxHQUFHLGdCQUFnQjtBQUFBLElBR3BELFlBQVksUUFBbUMsaUJBQTJCO0FBQ3RFLFlBQU0sTUFBTTtBQU1oQiw4QkFBbUIsTUFBTTtBQUNyQixjQUFNLFFBQVEsS0FBSyxTQUFTO0FB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USxDQUFDLENBQUMsS0FBSyxTQUFTLE1BQU0sQ0FBQyxLQUFLLEdBQUcsU0FBUyxDQUFDLEVBQ2pELElBQUksQ0FBQyxrQkFBbUIsSUFBSSxPQUFPLFVBQVUsY0FBYyxDQUFDLEVBQUUsWUFBWSxDQUFDLEdBQUcsY0FBYyxDQUFDLENBQUMsSUFBSSxjQUFjLE1BQU0sQ0FBQyxDQUFDLGNBQWMsRUFBRSxLQUFLLFdBQVcsSUFBSSxnQkFBZ0IsSUFBSyxFQUNqTCxPQUFPLE9BQU87QUFFbkIsNkJBQXFCLE9BQU87QUFBQSxVQUN4QixxQkFDSyxJQUFJLENBQUMsUUFBUTtBQUNWLGtCQUFNLFFBQVEsSUFBSSxPQUFPLFVBQVUsSUFBSSxDQUFDLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLE1BQU0sQ0FBQyxDQUFDLGlCQUFpQixFQUFFLEtBQUssV0FBVztBQUVuSCxrQkFBTSxTQUFTLE9BQU8sUUFBUSxLQUFLLGlCQUFpQixFQUFFLEtBQUssQ0FBQyxDQUFDLFVBQVUsU0FBUyxNQUFNLENBQUMsVUFBVSxHQUFHLFNBQVMsRUFBRSxTQUFTLEdBQUcsQ0FBQyxJQUFJLENBQUM7QUFFakksbUJBQU8sUUFBUSxDQUFDLFFBQVEsTUFBTSxDQUFDLENBQUMsSUFBSTtBQUFBLFVBQ3hDLENBQUMsRUFDQSxPQUFPLE9BQU87QUFBQSxRQUN2QjtBQUNBLHVCQUFlO0FBQUEsVUFDWCxZQUFZLE1BQU0sNkJBQTZCLElBQUksQ0FBQztBQUFBLFVBQ3BELFlBQVksTUFBTSxzQkFBc0IsSUFBSSxDQUFDO0FBQUEsVUFDN0MsWUFBWSxNQUFNLHlCQUF5QixJQUFJLENBQUM7QUFBQSxVQUNoRCxZQUFZLE1BQU0scUJBQXFCLElBQUksQ0FBQztBQUFBLFVBQzVDLFlBQVksTUFBTSx5QkFBeUIsSUFBSSxDQUFDO0FBQUEsVUFDaEQsR0FBSSxZQUFZLE1BQU0sd0JBQXdCLEtBQUssQ0FBQztBQUFBLFFBQ3hELEVBQ0ssT0FBTyxPQUFPLEVBQ2QsS0FBSyxJQUFJO0FBRWQsWUFBSTtBQUFtQix3QkFBYyxTQUFTLGtCQUFrQixXQUFXLEtBQUssR0FBRyxDQUFDO0FBQUE7QUFDL0UsYUFBRyxPQUFPLG1DQUFtQyxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBQ25FLGtCQUFVLFNBQVMsZUFBZTtBQUVsQyxzQkFBYyxLQUFLLE1BQU07QUFBQSxNQUM3QjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBRUEsTUFBSSxlQUFlLEVBQUUsSUFBSTtBQUM3QixDQUFDOyIsCiAgIm5hbWVzIjogWyJkYXRhIiwgImVycm9yQ29kZSIsICJlcnJvckluZm8iLCAib3V0cHV0Il0KfQo=
