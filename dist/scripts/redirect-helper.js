"use strict";
mw.loader.using(["mediawiki.util", "oojs-ui-core", "oojs-ui-widgets", "oojs-ui.styles.icons-content", "oojs-ui.styles.icons-editing-core"], async () => {
  if (mw.config.get("wgNamespaceNumber") < 0)
    return;
  if (!mw.config.get("wgIsProbablyEditable"))
    return;
  if (mw.config.get("wgAction") !== "view" || !mw.config.get("wgIsArticle"))
    return;
  if (mw.util.getParamValue("oldid") || mw.config.get("wgDiffOldId"))
    return;
  const contentText = document.querySelector("#mw-content-text");
  if (!contentText)
    return mw.notify("Failed to find content text element!", { type: "error" });
  const redirectTemplates = JSON.parse(
    (await new mw.Api().get({
      action: "query",
      formatversion: 2,
      prop: "revisions",
      rvprop: "content",
      rvslots: "*",
      titles: "User:Eejit43/scripts/redirect-helper.json"
    })).query.pages?.[0]?.revisions?.[0]?.slots?.main?.content || "[]"
  );
  const pageTitle = mw.config.get("wgPageName");
  const pageTitleParsed = mw.Title.newFromText(pageTitle);
  if (!pageTitleParsed)
    return mw.notify("Failed to parse page title!", { type: "error" });
  const pageInfo = await new mw.Api().get({ action: "query", formatversion: 2, prop: "info", titles: pageTitle });
  if (pageInfo.query.pages[0].missing) {
    const button = new OO.ui.ButtonWidget({ label: "Create redirect", icon: "articleRedirect", flags: ["progressive"] });
    button.$element[0].style.marginBottom = "20px";
    button.on("click", () => {
      button.$element[0].remove();
      showRedirectInfo(false);
    });
    contentText.prepend(button.$element[0]);
  } else if (pageInfo.query.pages[0].redirect)
    showRedirectInfo(true);
  else {
    const portletLink = mw.util.addPortletLink(mw.config.get("skin") === "minerva" ? "p-tb" : "p-cactions", "#", "Redirect page", "redirect-helper");
    portletLink.addEventListener("click", (event) => {
      event.preventDefault();
      showRedirectInfo(false);
    });
  }
  async function showRedirectInfo(exists) {
    const editorBox = new OO.ui.PanelLayout({ padded: true, expanded: false, framed: true });
    editorBox.$element[0].style.backgroundColor = "#95d4bc";
    editorBox.$element[0].style.width = "700px";
    editorBox.$element[0].style.maxWidth = "calc(100% - 50px)";
    editorBox.$element[0].style.marginLeft = "auto";
    editorBox.$element[0].style.marginRight = "auto";
    editorBox.$element[0].style.marginBottom = "20px";
    let syncWithMainButton;
    if (pageTitleParsed.isTalkPage()) {
      const mainPageData = await new mw.Api().get({ action: "query", formatversion: 2, prop: "info", titles: pageTitleParsed.getSubjectPage().getPrefixedText() });
      if (mainPageData.query.pages[0].redirect) {
        const mainPageContent = (await new mw.Api().get({
          action: "query",
          formatversion: 2,
          prop: "revisions",
          rvprop: "content",
          rvslots: "*",
          titles: pageTitleParsed.getSubjectPage().getPrefixedText()
        })).query.pages[0].revisions[0].slots.main.content.trim();
        syncWithMainButton = new OO.ui.ButtonWidget({ label: "Sync with main page", icon: "link", flags: ["progressive"] });
        syncWithMainButton.on("click", () => {
          const target = /^#redirect:?\s*\[\[\s*([^[\]{|}]+?)\s*(?:\|[^[\]{|}]+?)?]]\s*/i.exec(mainPageContent)?.[1];
          if (!target)
            return mw.notify("Failed to parse main page content!", { type: "error" });
          redirectInput.setValue(mw.Title.newFromText(target)?.getTalkPage()?.toString() ?? "");
          const fromMove = ["R from move", ...redirectTemplates["R from move"]].some(
            (tagOrRedirect) => new RegExp(`{{\\s*[${tagOrRedirect[0].toLowerCase()}${tagOrRedirect[0]}]${tagOrRedirect.slice(1)}\\s*(\\||}})`).test(mainPageContent)
          );
          if (fromMove)
            tagSelect.setValue(["R from move"]);
        });
      }
    }
    class RedirectInputWidget extends OO.ui.TextInputWidget {
      constructor(config) {
        super(config);
        this.getLookupRequest = () => {
          const value = this.getValue();
          const deferred = $.Deferred();
          if (!value)
            deferred.resolve([]);
          else if (value.includes("#")) {
            const title = value.split("#")[0];
            new mw.Api().get({ action: "parse", page: title, prop: "sections", redirects: "1" }).catch(() => null).then((result) => {
              if (result) {
                const matchedSections = result.parse.sections.filter((section) => section.line.toLowerCase().startsWith(value.split("#")[1].toLowerCase()));
                deferred.resolve(matchedSections.map((section) => ({ data: `${result.parse.title}#${section.line}`, label: `${result.parse.title}#${section.line}` })));
              } else
                deferred.resolve([]);
            });
          } else {
            const parsedTitle = mw.Title.newFromText(value);
            new mw.Api().get({
              action: "query",
              formatversion: 2,
              gaplimit: 20,
              gapnamespace: parsedTitle?.namespace ?? 0,
              gapprefix: parsedTitle?.title ?? value,
              generator: "allpages",
              prop: "info|pageprops"
            }).catch(() => null).then((result) => {
              if (result)
                deferred.resolve(
                  result.query?.pages ? result.query.pages.filter((page) => page.title !== pageTitleParsed.toString()).map((page) => ({
                    data: page.title,
                    label: new OO.ui.HtmlSnippet(
                      `${page.title}${page.pageprops && "disambiguation" in page.pageprops ? " <i>(disambiguation)</i>" : ""}${"redirect" in page ? " <i>(redirect)</i>" : ""}`
                    )
                  })) : []
                );
              else
                deferred.resolve([]);
            });
          }
          return deferred.promise({ abort() {
          } });
        };
        this.getLookupCacheDataFromResponse = (response) => response ?? [];
        this.getLookupMenuOptionsFromData = (data) => data.map(({ data: data2, label }) => new OO.ui.MenuOptionWidget({ data: data2, label }));
        OO.ui.mixin.LookupElement.call(this, config);
      }
    }
    Object.assign(RedirectInputWidget.prototype, OO.ui.mixin.LookupElement.prototype);
    const redirectInput = new RedirectInputWidget({ placeholder: "Target page name", required: true });
    redirectInput.on("change", () => {
      let value = redirectInput.getValue();
      value = value.replace(new RegExp(`^(https?:)?/{2}?${mw.config.get("wgServer").replace(/^\/{2}/, "")}/wiki/`), "");
      value = value.replace(/^:/, "");
      if (value.length > 0) {
        redirectInput.setValue(value[0].toUpperCase() + value.slice(1).replaceAll("_", " "));
        submitButton.setDisabled(false);
      } else
        submitButton.setDisabled(true);
      updateSummary();
      submitButton.setLabel("Submit");
      needsCheck = true;
    });
    const redirectInputLayout = new OO.ui.FieldLayout(redirectInput, { label: new OO.ui.HtmlSnippet("<b>Redirect target:</b>"), align: "top" });
    const tagSelect = new OO.ui.MenuTagMultiselectWidget({
      allowArbitrary: false,
      allowReordering: false,
      options: Object.keys(redirectTemplates).map((tag) => ({ data: tag, label: tag }))
    });
    tagSelect.getMenu().filterMode = "substring";
    tagSelect.on("change", () => {
      const sortedTags = tagSelect.getValue().sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));
      if (tagSelect.getValue().join(";") !== sortedTags.join(";"))
        tagSelect.setValue(sortedTags);
      updateSummary();
      submitButton.setLabel("Submit");
      needsCheck = true;
    });
    const tagSelectLayout = new OO.ui.FieldLayout(tagSelect, { label: new OO.ui.HtmlSnippet("<b>Redirect categorization template(s):</b>"), align: "top" });
    const summaryInput = new OO.ui.ComboBoxInputWidget({
      options: [
        { data: "Resolve double redirect" },
        //
        { data: "Resolve self redirect" },
        { data: "Remove incorrect rcats" }
      ]
    });
    const summaryInputLayout = new OO.ui.FieldLayout(summaryInput, { label: new OO.ui.HtmlSnippet("<b>Summary:</b>"), align: "top" });
    const submitButton = new OO.ui.ButtonWidget({ label: "Submit", disabled: true, flags: ["progressive"] });
    submitButton.$element[0].style.marginBottom = "0";
    let needsCheck = true;
    submitButton.on("click", async () => {
      for (const element of [redirectInput, tagSelect, summaryInput, submitButton, syncTalkCheckbox, patrolCheckbox].filter(Boolean))
        element.setDisabled(true);
      submitButton.setLabel("Checking target validity...");
      let parsedDestination;
      const errors = [];
      if (needsCheck) {
        const destination = redirectInput.getValue().trim();
        if (!/^\s*[^[\]{|}]+\s*$/.test(destination))
          errors.push({ title: destination, message: "is not a valid page title!" });
        try {
          parsedDestination = mw.Title.newFromText(destination);
        } catch {
          if (errors.length === 0)
            errors.push({ title: destination, message: "is not a valid page title!" });
        }
        if (!parsedDestination && errors.length === 0)
          errors.push({ title: destination, message: "is not a valid page title!" });
        if (parsedDestination?.toString() === pageTitleParsed.toString())
          errors.push({ message: "cannot redirect to itself!" });
        const destinationData = await new mw.Api().get({ action: "query", formatversion: 2, prop: "pageprops", titles: destination }).catch((errorCode) => {
          if (errorCode === "missingtitle")
            errors.push({ title: destination, message: "does not exist!" });
          else
            errors.push({ title: destination, message: `was not able to be fetched from the API (${errorCode})!` });
          return null;
        });
        const destinationParseResult = await new mw.Api().get({ action: "parse", page: destination, prop: "sections", redirects: "1" });
        if (destinationParseResult.parse.redirects?.[0]) {
          const destinationRedirect = destinationParseResult.parse.redirects[0].to + (destinationParseResult.parse.redirects[0].tofragment ? `#${destinationParseResult.parse.redirects[0].tofragment}` : "");
          errors.push({
            title: destination,
            message: `is a redirect to <a href="${mw.util.getUrl(
              destinationRedirect
            )}" target="_blank">${destinationRedirect}</a>. Retarget to that page instead, as double redirects aren't allowed.`
          });
        }
        if (destination.split("#").length > 1) {
          const validSection = destinationParseResult.parse.sections.find((section) => section.line === destination.split("#")[1]);
          if (validSection) {
            if (tagSelect.getValue().includes("R to anchor"))
              errors.push({ message: "is tagged as a redirect to an anchor, but it is actually a redirect to a section!" });
            if (!tagSelect.getValue().includes("R to section"))
              errors.push({ message: "is a redirect to a section, but it is not tagged with <code>{{R to section}}</code>!" });
          } else {
            const destinationContent = (await new mw.Api().get({
              action: "query",
              formatversion: 2,
              prop: "revisions",
              rvprop: "content",
              rvslots: "*",
              titles: parsedDestination.toString()
            })).query.pages[0].revisions[0].slots.main.content;
            const anchors = [
              ...destinationContent.match(/(?<={{\s*?[Aa](?:nchors?|nchor for redirect|nker|NCHOR|nc)\s*?\|).+?(?=}})/g)?.map((anchor) => anchor.split("|").map((part) => part.trim()))?.flat() ?? [],
              ...destinationContent.match(/(?<={{\s*?(?:[Vv](?:isible anchors?|isanc|Anch|anchor|isibleanchor|a)|[Aa](?:nchord|chored|nchor\+)|[Tt]ext anchor)\s*?\|).+?(?=(?<!!|=)}})/g)?.map(
                (anchor) => anchor.split("|").map((part) => part.trim()).filter((part) => !/^text\s*?=/.test(part))
              )?.flat() ?? [],
              ...destinationContent.match(/(?<=id=)"?.+?(?="|>|\|)/g)?.map((anchor) => anchor.trim()) ?? []
            ];
            if (anchors.includes(destination.split("#")[1])) {
              if (tagSelect.getValue().includes("R to section"))
                errors.push({ message: "is tagged as a redirect to a section, but it is actually a redirect to an anchor!" });
              if (!tagSelect.getValue().includes("R to anchor"))
                errors.push({ message: "is a redirect to an anchor, but it is not tagged with <code>{{R from anchor}}</code>!" });
            } else
              errors.push({ message: `is a redirect to <a href="${mw.util.getUrl(destination)}" target="_blank">${destination}</a>, but that section or anchor does not exist!` });
          }
        }
        if (destination.split("#").length === 1 && (tagSelect.getValue().includes("R to section") || tagSelect.getValue().includes("R to anchor")))
          errors.push({ message: "is not a redirect to a section/anchor, but it is tagged with <code>{{R from section}}</code> or <code>{{R from anchor}}</code>!" });
        if ("disambiguation" in destinationData.query.pages[0].pageprops && ![
          "R from ambiguous sort name",
          "R from ambiguous term",
          "R to disambiguation page",
          "R from incomplete disambiguation",
          "R from incorrect disambiguation",
          "R from other disambiguation"
        ].some((template) => tagSelect.getValue().includes(template)))
          errors.push({ message: "is a redirect to a disambiguation page, but it is not tagged with a disambiguation categorization template!" });
        if (!("disambiguation" in destinationData.query.pages[0].pageprops) && ["R from ambiguous sort name", "R from ambiguous term", "R to disambiguation page", "R from incomplete disambiguation"].some((template) => tagSelect.getValue().includes(template)))
          errors.push({ message: "is not a redirect to a disambiguation page, but it is tagged with a disambiguation categorization template!" });
        if (tagSelect.getValue().includes("R to disambiguation page") && !pageTitleParsed.getMainText().endsWith(" (disambiguation)"))
          errors.push({
            message: 'is tagged with <code>{{R to disambiguation page}}</code>, but this title does not end with " (disambiguation)". Use <code>{{R from ambiguous term}}</code> or a similar categorization template instead!'
          });
        if (syncTalkCheckbox?.isSelected() && !talkData.query.pages[0].missing && !talkData.query.pages[0].redirect)
          errors.push({ title: pageTitleParsed.getTalkPage().getPrefixedText(), message: "exists, but is not a redirect!" });
      }
      if (errors.length > 0) {
        for (const element of document.querySelectorAll(".redirect-helper-warning"))
          element.remove();
        for (const { title, message } of errors) {
          const label = new OO.ui.HtmlSnippet(
            `${title ? `<a href="${mw.util.getUrl(title)}" target="_blank">${title}</a>` : "This page"} ${message} Click again without making changes to submit anyway.`
          );
          const warningMessage = new OO.ui.MessageWidget({ type: "error", classes: ["redirect-helper-warning"], inline: true, label });
          warningMessage.$element[0].style.marginTop = "8px";
          editorBox.$element[0].append(warningMessage.$element[0]);
        }
        for (const element of [redirectInput, tagSelect, summaryInput, submitButton, syncTalkCheckbox, patrolCheckbox].filter(Boolean))
          element.setDisabled(false);
        submitButton.setLabel("Submit anyway");
        needsCheck = false;
        return;
      }
      parsedDestination = mw.Title.newFromText(redirectInput.getValue());
      submitButton.setLabel(`${exists ? "Editing" : "Creating"} redirect...`);
      const output = [
        `#REDIRECT [[${redirectInput.getValue().trim()}]]`,
        //
        tagSelect.getValue().length > 0 ? `{{Redirect category shell|
${tagSelect.getValue().map((tag) => `{{${tag}${oldRedirectTagData?.[tag] ? `|${oldRedirectTagData[tag]}` : ""}}}`).join("\n")}
}}` : null,
        oldStrayText
      ].filter(Boolean).join("\n\n");
      const summary = (summaryInput.getValue() || summaryInput.$tabIndexed[0].placeholder) + " (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])";
      const result = await new mw.Api().edit(pageTitle, () => ({ text: output, summary })).catch((errorCode, { error }) => {
        if (errorCode === "nocreate-missing")
          return new mw.Api().create(pageTitle, { summary }, output).catch((errorCode2, { error: error2 }) => {
            mw.notify(`Error creating ${pageTitle}: ${error2.info} (${errorCode2})`, { type: "error" });
          });
        else {
          mw.notify(`Error editing or creating ${pageTitle}: ${error.info} (${errorCode})`, { type: "error" });
          return null;
        }
      });
      if (!result)
        return;
      mw.notify(`Redirect ${exists ? "edited" : "created"} successfully!`, { type: "success" });
      if (syncTalkCheckbox?.isSelected()) {
        submitButton.setLabel("Editing talk page...");
        const fromMove = tagSelect.getValue().includes("R from move");
        const output2 = [
          `#REDIRECT [[${parsedDestination.getTalkPage().getPrefixedText()}]]`,
          //
          fromMove ? "{{Redirect category shell|\n{{R from move}}\n}}" : null
        ].filter(Boolean).join("\n\n");
        const talkPage = pageTitleParsed.getTalkPage().getPrefixedText();
        const talkResult = await new mw.Api().edit(talkPage, () => ({ text: output2, summary: "Syncing redirect from main page (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])" })).catch((errorCode, { error }) => {
          if (errorCode === "nocreate-missing")
            return new mw.Api().create(talkPage, { summary: "Syncing redirect from main page (via [[User:Eejit43/scripts/redirect-helper|redirect-helper]])" }, output2).catch((errorCode2, { error: error2 }) => {
              mw.notify(`Error creating ${talkPage}: ${error2.info} (${errorCode2})`, { type: "error" });
            });
          else {
            mw.notify(`Error editing or creating ${talkPage}: ${error.info} (${errorCode})`, { type: "error" });
            return null;
          }
        });
        if (!talkResult)
          return;
        mw.notify("Talk page synced successfully!", { type: "success" });
      }
      if (patrolCheckbox?.isSelected()) {
        submitButton.setLabel("Patrolling redirect...");
        const patrolLink = document.querySelector(".patrollink a");
        const markReviewedButton = document.querySelector("#mwe-pt-mark-as-reviewed-button");
        if (patrolLink) {
          const patrolResult = await new mw.Api().postWithToken("patrol", { action: "patrol", rcid: new URL(patrolLink.href).searchParams.get("rcid") }).catch((errorCode, { error }) => {
            mw.notify(`Error patrolling ${pageTitle} via API: ${error.info} (${errorCode})`, { type: "error" });
            return null;
          });
          if (patrolResult)
            mw.notify("Redirect patrolled successfully!", { type: "success" });
        } else if (markReviewedButton) {
          markReviewedButton.click();
          mw.notify("Redirect patrolled successfully!", { type: "success" });
        } else
          mw.notify("Page curation toolbar not found, redirect cannot be patrolled!", { type: "error" });
      }
      submitButton.setLabel("Complete, reloading...");
      window.location.href = mw.util.getUrl(pageTitle, { redirect: "no" });
    });
    let talkData;
    let syncTalkCheckbox, syncTalkLayout;
    if (!pageTitleParsed.isTalkPage()) {
      talkData = await new mw.Api().get({ action: "query", formatversion: 2, prop: "info", titles: pageTitleParsed.getTalkPage().getPrefixedText() });
      syncTalkCheckbox = new OO.ui.CheckboxInputWidget({ selected: !!talkData.query.pages[0].redirect });
      syncTalkLayout = new OO.ui.Widget({ content: [new OO.ui.FieldLayout(syncTalkCheckbox, { label: "Sync talk page", align: "inline" })] });
      syncTalkLayout.$element[0].style.marginBottom = "0";
    }
    const markButton = document.querySelector("#mwe-pt-mark .mwe-pt-tool-icon");
    markButton?.click();
    markButton?.click();
    let shouldPromptPatrol;
    if (mw.config.get("wgNamespaceNumber") !== 0)
      shouldPromptPatrol = false;
    else if (document.querySelector(".patrollink"))
      shouldPromptPatrol = true;
    else if (document.querySelector("#mwe-pt-mark-as-reviewed-button"))
      shouldPromptPatrol = true;
    else if (document.querySelector("#mwe-pt-mark-as-unreviewed-button"))
      shouldPromptPatrol = false;
    else {
      if (!mw.config.get("wgArticleId"))
        shouldPromptPatrol = false;
      const userPermissions = await new mw.Api().get({ action: "query", meta: "userinfo", uiprop: "rights" });
      if (!userPermissions.query.userinfo.rights.includes("patrol"))
        shouldPromptPatrol = false;
      const patrolResponse = await new mw.Api().get({ action: "pagetriagelist", page_id: mw.config.get("wgArticleId") });
      if (patrolResponse.pagetriagelist.pages[0]?.user_name === mw.config.get("wgUserName"))
        shouldPromptPatrol = false;
      else if (patrolResponse.pagetriagelist.result !== "success" || patrolResponse.pagetriagelist.pages.length === 0)
        shouldPromptPatrol = false;
      else
        shouldPromptPatrol = !Number.parseInt(patrolResponse.pagetriagelist.pages[0]?.patrol_status);
    }
    let patrolCheckbox, patrolLayout;
    if (shouldPromptPatrol) {
      patrolCheckbox = new OO.ui.CheckboxInputWidget({ selected: true });
      patrolLayout = new OO.ui.Widget({ content: [new OO.ui.FieldLayout(patrolCheckbox, { label: "Mark as patrolled", align: "inline" })] });
      patrolLayout.$element[0].style.marginBottom = "0";
    }
    const submitLayout = new OO.ui.HorizontalLayout({ items: [submitButton, syncTalkLayout, patrolLayout].filter(Boolean) });
    submitLayout.$element[0].style.marginTop = "10px";
    editorBox.$element[0].append(
      ...[syncWithMainButton?.$element?.[0], redirectInputLayout.$element[0], tagSelectLayout.$element[0], summaryInputLayout.$element[0], submitLayout.$element[0]].filter(
        Boolean
      )
    );
    contentText.prepend(editorBox.$element[0]);
    function updateSummary() {
      const redirectValue = redirectInput.getValue().trim();
      if (!redirectValue)
        summaryInput.$tabIndexed[0].placeholder = "";
      else if (exists) {
        const targetChanged = redirectValue !== oldRedirectTarget;
        const tagsChanged = tagSelect.getValue().join(";") !== oldRedirectTags?.join(";");
        if (targetChanged && tagsChanged)
          summaryInput.$tabIndexed[0].placeholder = `Changing redirect to [[${redirectValue}]] and changing categorization templates`;
        else if (targetChanged)
          summaryInput.$tabIndexed[0].placeholder = `Changing redirect to [[${redirectValue}]]`;
        else if (tagsChanged)
          summaryInput.$tabIndexed[0].placeholder = "Changing categorization templates";
        else
          summaryInput.$tabIndexed[0].placeholder = "Redirect cleanup";
      } else
        summaryInput.$tabIndexed[0].placeholder = `Creating redirect to [[${redirectValue}]]`;
    }
    let oldRedirectTarget, oldRedirectTags, oldRedirectTagData, oldStrayText;
    if (exists) {
      const pageContent = (await new mw.Api().get({ action: "query", formatversion: 2, prop: "revisions", rvprop: "content", rvslots: "*", titles: pageTitle })).query.pages[0].revisions[0].slots.main.content.trim();
      oldRedirectTarget = /^#redirect:?\s*\[\[\s*([^[\]{|}]+?)\s*(?:\|[^[\]{|}]+?)?]]\s*/i.exec(pageContent)?.[1];
      oldRedirectTags = Object.entries(redirectTemplates).map(
        ([tag, redirects]) => [tag, ...redirects].some((tagOrRedirect) => new RegExp(`{{\\s*[${tagOrRedirect[0].toLowerCase()}${tagOrRedirect[0]}]${tagOrRedirect.slice(1)}\\s*(\\||}})`).test(pageContent)) ? tag : null
      ).filter(Boolean).sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));
      oldRedirectTagData = Object.fromEntries(
        oldRedirectTags.map((tag) => {
          const match = new RegExp(`{{\\s*(?:${[tag, ...redirectTemplates[tag]].map((tag2) => `[${tag2[0].toLowerCase()}${tag2[0]}]${tag2.slice(1)}`).join("|")})\\|?(.*?)\\s*}}`).exec(
            pageContent
          );
          return match ? [tag, match[1]] : null;
        }).filter(Boolean)
      );
      oldStrayText = [
        pageContent.match(/{{short description\|.*?}}/i)?.[0],
        pageContent.match(/{{DISPLAYTITLE:.*?}}/)?.[0],
        pageContent.match(/{{italic title\|?.*?}}/i)?.[0],
        pageContent.match(/{{DEFAULTSORT:.*?}}/)?.[0],
        ...pageContent.match(/\[\[[Cc]ategory:.+?]]/g) ?? []
      ].filter(Boolean).join("\n");
      if (oldRedirectTarget)
        redirectInput.setValue(oldRedirectTarget.replaceAll("_", " "));
      else
        mw.notify("Could not find redirect target!", { type: "error" });
      tagSelect.setValue(oldRedirectTags);
    }
  }
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc2NyaXB0cy9yZWRpcmVjdC1oZWxwZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1lZGlhV2lraURhdGFFcnJvciwgUGFnZVJldmlzaW9uc1Jlc3VsdCB9IGZyb20gJy4uL2dsb2JhbC10eXBlcyc7XG5cbmludGVyZmFjZSBQYWdlSW5mb1Jlc3VsdCB7XG4gICAgcXVlcnk6IHsgcGFnZXM6IHsgbWlzc2luZz86IHN0cmluZzsgcmVkaXJlY3Q/OiBzdHJpbmcgfVtdIH07XG59XG5cbmludGVyZmFjZSBBbGxQYWdlc0dlbmVyYXRvclJlc3VsdCB7XG4gICAgcXVlcnk6IHsgcGFnZXM6IHsgdGl0bGU6IHN0cmluZzsgcGFnZXByb3BzOiB7IGRpc2FtYmlndWF0aW9uPzogc3RyaW5nIH07IHJlZGlyZWN0Pzogc3RyaW5nIH1bXSB9O1xufVxuXG5pbnRlcmZhY2UgUGFnZVBhcnNlUmVzdWx0IHtcbiAgICBwYXJzZTogeyB0aXRsZTogc3RyaW5nOyByZWRpcmVjdHM6IHsgdG86IHN0cmluZzsgdG9mcmFnbWVudDogc3RyaW5nIH1bXTsgc2VjdGlvbnM6IHsgbGluZTogc3RyaW5nIH1bXSB9O1xufVxuXG5pbnRlcmZhY2UgUGFnZXByb3BzUmVzdWx0IHtcbiAgICBxdWVyeTogeyBwYWdlczogeyBwYWdlcHJvcHM6IHsgZGlzYW1iaWd1YXRpb24/OiBzdHJpbmcgfSB9W10gfTtcbn1cblxuaW50ZXJmYWNlIFVzZXJQZXJtaXNzaW9uc1Jlc3BvbnNlIHtcbiAgICBxdWVyeTogeyB1c2VyaW5mbzogeyByaWdodHM6IHN0cmluZ1tdIH0gfTtcbn1cblxuaW50ZXJmYWNlIFBhZ2VUcmlhZ2VMaXN0UmVzcG9uc2Uge1xuICAgIHBhZ2V0cmlhZ2VsaXN0OiB7IHBhZ2VzOiB7IHVzZXJfbmFtZTogc3RyaW5nOyBwYXRyb2xfc3RhdHVzOiBzdHJpbmcgfVtdOyByZXN1bHQ6IHN0cmluZyB9OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxufVxuXG5tdy5sb2FkZXIudXNpbmcoWydtZWRpYXdpa2kudXRpbCcsICdvb2pzLXVpLWNvcmUnLCAnb29qcy11aS13aWRnZXRzJywgJ29vanMtdWkuc3R5bGVzLmljb25zLWNvbnRlbnQnLCAnb29qcy11aS5zdHlsZXMuaWNvbnMtZWRpdGluZy1jb3JlJ10sIGFzeW5jICgpID0+IHtcbiAgICBpZiAobXcuY29uZmlnLmdldCgnd2dOYW1lc3BhY2VOdW1iZXInKSA8IDApIHJldHVybjsgLy8gRG9uJ3QgcnVuIGluIHZpcnR1YWwgbmFtZXNwYWNlc1xuICAgIGlmICghbXcuY29uZmlnLmdldCgnd2dJc1Byb2JhYmx5RWRpdGFibGUnKSkgcmV0dXJuOyAvLyBEb24ndCBydW4gaWYgdXNlciBjYW4ndCBlZGl0IHBhZ2VcbiAgICBpZiAobXcuY29uZmlnLmdldCgnd2dBY3Rpb24nKSAhPT0gJ3ZpZXcnIHx8ICFtdy5jb25maWcuZ2V0KCd3Z0lzQXJ0aWNsZScpKSByZXR1cm47IC8vIERvbid0IHJ1biBpZiBub3Qgdmlld2luZyBwYWdlXG4gICAgaWYgKG13LnV0aWwuZ2V0UGFyYW1WYWx1ZSgnb2xkaWQnKSB8fCBtdy5jb25maWcuZ2V0KCd3Z0RpZmZPbGRJZCcpKSByZXR1cm47IC8vIERvbid0IHJ1biBpZiB2aWV3aW5nIG9sZCByZXZpc2lvbiBvciBkaWZmXG5cbiAgICBjb25zdCBjb250ZW50VGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtdy1jb250ZW50LXRleHQnKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuICAgIGlmICghY29udGVudFRleHQpIHJldHVybiBtdy5ub3RpZnkoJ0ZhaWxlZCB0byBmaW5kIGNvbnRlbnQgdGV4dCBlbGVtZW50IScsIHsgdHlwZTogJ2Vycm9yJyB9KTtcblxuICAgIGNvbnN0IHJlZGlyZWN0VGVtcGxhdGVzID0gSlNPTi5wYXJzZShcbiAgICAgICAgKFxuICAgICAgICAgICAgKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogJ3F1ZXJ5JyxcbiAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAyLFxuICAgICAgICAgICAgICAgIHByb3A6ICdyZXZpc2lvbnMnLFxuICAgICAgICAgICAgICAgIHJ2cHJvcDogJ2NvbnRlbnQnLFxuICAgICAgICAgICAgICAgIHJ2c2xvdHM6ICcqJyxcbiAgICAgICAgICAgICAgICB0aXRsZXM6ICdVc2VyOkVlaml0NDMvc2NyaXB0cy9yZWRpcmVjdC1oZWxwZXIuanNvbicsXG4gICAgICAgICAgICB9KSkgYXMgUGFnZVJldmlzaW9uc1Jlc3VsdFxuICAgICAgICApLnF1ZXJ5LnBhZ2VzPy5bMF0/LnJldmlzaW9ucz8uWzBdPy5zbG90cz8ubWFpbj8uY29udGVudCB8fCAnW10nLFxuICAgICkgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nW10+O1xuXG4gICAgY29uc3QgcGFnZVRpdGxlID0gbXcuY29uZmlnLmdldCgnd2dQYWdlTmFtZScpO1xuICAgIGNvbnN0IHBhZ2VUaXRsZVBhcnNlZCA9IG13LlRpdGxlLm5ld0Zyb21UZXh0KHBhZ2VUaXRsZSkhO1xuXG4gICAgaWYgKCFwYWdlVGl0bGVQYXJzZWQpIHJldHVybiBtdy5ub3RpZnkoJ0ZhaWxlZCB0byBwYXJzZSBwYWdlIHRpdGxlIScsIHsgdHlwZTogJ2Vycm9yJyB9KTtcblxuICAgIGNvbnN0IHBhZ2VJbmZvID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdxdWVyeScsIGZvcm1hdHZlcnNpb246IDIsIHByb3A6ICdpbmZvJywgdGl0bGVzOiBwYWdlVGl0bGUgfSkpIGFzIFBhZ2VJbmZvUmVzdWx0O1xuXG4gICAgaWYgKHBhZ2VJbmZvLnF1ZXJ5LnBhZ2VzWzBdLm1pc3NpbmcpIHtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IE9PLnVpLkJ1dHRvbldpZGdldCh7IGxhYmVsOiAnQ3JlYXRlIHJlZGlyZWN0JywgaWNvbjogJ2FydGljbGVSZWRpcmVjdCcsIGZsYWdzOiBbJ3Byb2dyZXNzaXZlJ10gfSk7XG4gICAgICAgIGJ1dHRvbi4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMjBweCc7XG4gICAgICAgIGJ1dHRvbi5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBidXR0b24uJGVsZW1lbnRbMF0ucmVtb3ZlKCk7XG4gICAgICAgICAgICBzaG93UmVkaXJlY3RJbmZvKGZhbHNlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29udGVudFRleHQucHJlcGVuZChidXR0b24uJGVsZW1lbnRbMF0pO1xuICAgIH0gZWxzZSBpZiAocGFnZUluZm8ucXVlcnkucGFnZXNbMF0ucmVkaXJlY3QpIHNob3dSZWRpcmVjdEluZm8odHJ1ZSk7XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHBvcnRsZXRMaW5rID0gbXcudXRpbC5hZGRQb3J0bGV0TGluayhtdy5jb25maWcuZ2V0KCdza2luJykgPT09ICdtaW5lcnZhJyA/ICdwLXRiJyA6ICdwLWNhY3Rpb25zJywgJyMnLCAnUmVkaXJlY3QgcGFnZScsICdyZWRpcmVjdC1oZWxwZXInKTtcbiAgICAgICAgcG9ydGxldExpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBzaG93UmVkaXJlY3RJbmZvKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvd3MgdGhlIHJlZGlyZWN0IGluZm9ybWF0aW9uIGJveC5cbiAgICAgKiBAcGFyYW0gZXhpc3RzIFdoZXRoZXIgdGhlIHBhZ2UgZXhpc3RzLlxuICAgICAqL1xuICAgIGFzeW5jIGZ1bmN0aW9uIHNob3dSZWRpcmVjdEluZm8oZXhpc3RzOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGVkaXRvckJveCA9IG5ldyBPTy51aS5QYW5lbExheW91dCh7IHBhZGRlZDogdHJ1ZSwgZXhwYW5kZWQ6IGZhbHNlLCBmcmFtZWQ6IHRydWUgfSk7XG4gICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnIzk1ZDRiYyc7XG4gICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS53aWR0aCA9ICc3MDBweCc7XG4gICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS5tYXhXaWR0aCA9ICdjYWxjKDEwMCUgLSA1MHB4KSc7XG4gICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5MZWZ0ID0gJ2F1dG8nO1xuICAgICAgICBlZGl0b3JCb3guJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luUmlnaHQgPSAnYXV0byc7XG4gICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMjBweCc7XG5cbiAgICAgICAgbGV0IHN5bmNXaXRoTWFpbkJ1dHRvbjtcblxuICAgICAgICBpZiAocGFnZVRpdGxlUGFyc2VkLmlzVGFsa1BhZ2UoKSkge1xuICAgICAgICAgICAgY29uc3QgbWFpblBhZ2VEYXRhID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdxdWVyeScsIGZvcm1hdHZlcnNpb246IDIsIHByb3A6ICdpbmZvJywgdGl0bGVzOiBwYWdlVGl0bGVQYXJzZWQuZ2V0U3ViamVjdFBhZ2UoKSEuZ2V0UHJlZml4ZWRUZXh0KCkgfSkpIGFzIFBhZ2VJbmZvUmVzdWx0O1xuXG4gICAgICAgICAgICBpZiAobWFpblBhZ2VEYXRhLnF1ZXJ5LnBhZ2VzWzBdLnJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFpblBhZ2VDb250ZW50ID0gKFxuICAgICAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdxdWVyeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR2ZXJzaW9uOiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogJ3JldmlzaW9ucycsXG4gICAgICAgICAgICAgICAgICAgICAgICBydnByb3A6ICdjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ2c2xvdHM6ICcqJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlczogcGFnZVRpdGxlUGFyc2VkLmdldFN1YmplY3RQYWdlKCkhLmdldFByZWZpeGVkVGV4dCgpLFxuICAgICAgICAgICAgICAgICAgICB9KSkgYXMgUGFnZVJldmlzaW9uc1Jlc3VsdFxuICAgICAgICAgICAgICAgICkucXVlcnkucGFnZXNbMF0ucmV2aXNpb25zWzBdLnNsb3RzLm1haW4uY29udGVudC50cmltKCk7XG4gICAgICAgICAgICAgICAgc3luY1dpdGhNYWluQnV0dG9uID0gbmV3IE9PLnVpLkJ1dHRvbldpZGdldCh7IGxhYmVsOiAnU3luYyB3aXRoIG1haW4gcGFnZScsIGljb246ICdsaW5rJywgZmxhZ3M6IFsncHJvZ3Jlc3NpdmUnXSB9KTtcbiAgICAgICAgICAgICAgICBzeW5jV2l0aE1haW5CdXR0b24ub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSAvXiNyZWRpcmVjdDo/XFxzKlxcW1xcW1xccyooW15bXFxde3x9XSs/KVxccyooPzpcXHxbXltcXF17fH1dKz8pP11dXFxzKi9pLmV4ZWMobWFpblBhZ2VDb250ZW50KT8uWzFdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgcmV0dXJuIG13Lm5vdGlmeSgnRmFpbGVkIHRvIHBhcnNlIG1haW4gcGFnZSBjb250ZW50IScsIHsgdHlwZTogJ2Vycm9yJyB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdElucHV0LnNldFZhbHVlKG13LlRpdGxlLm5ld0Zyb21UZXh0KHRhcmdldCk/LmdldFRhbGtQYWdlKCk/LnRvU3RyaW5nKCkgPz8gJycpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcm9tTW92ZSA9IFsnUiBmcm9tIG1vdmUnLCAuLi5yZWRpcmVjdFRlbXBsYXRlc1snUiBmcm9tIG1vdmUnXV0uc29tZSgodGFnT3JSZWRpcmVjdCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBSZWdFeHAoYHt7XFxcXHMqWyR7dGFnT3JSZWRpcmVjdFswXS50b0xvd2VyQ2FzZSgpfSR7dGFnT3JSZWRpcmVjdFswXX1dJHt0YWdPclJlZGlyZWN0LnNsaWNlKDEpfVxcXFxzKihcXFxcfHx9fSlgKS50ZXN0KG1haW5QYWdlQ29udGVudCksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmcm9tTW92ZSkgdGFnU2VsZWN0LnNldFZhbHVlKFsnUiBmcm9tIG1vdmUnXSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBSZWRpcmVjdCB0YXJnZXQgaW5wdXQgKi9cbiAgICAgICAgaW50ZXJmYWNlIFJlZGlyZWN0SW5wdXRXaWRnZXRDb25maWcgZXh0ZW5kcyBPTy51aS5UZXh0SW5wdXRXaWRnZXQuQ29uZmlnT3B0aW9ucywgT08udWkubWl4aW4uTG9va3VwRWxlbWVudC5Db25maWdPcHRpb25zIHt9XG5cbiAgICAgICAgY2xhc3MgUmVkaXJlY3RJbnB1dFdpZGdldCBleHRlbmRzIE9PLnVpLlRleHRJbnB1dFdpZGdldCB7XG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcihjb25maWc6IFJlZGlyZWN0SW5wdXRXaWRnZXRDb25maWcpIHtcbiAgICAgICAgICAgICAgICBzdXBlcihjb25maWcpO1xuICAgICAgICAgICAgICAgIE9PLnVpLm1peGluLkxvb2t1cEVsZW1lbnQuY2FsbCh0aGlzIGFzIHVua25vd24gYXMgT08udWkubWl4aW4uTG9va3VwRWxlbWVudCwgY29uZmlnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZ2V0TG9va3VwUmVxdWVzdCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcblxuICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIGRlZmVycmVkLnJlc29sdmUoW10pO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlLmluY2x1ZGVzKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSB2YWx1ZS5zcGxpdCgnIycpWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgIG5ldyBtdy5BcGkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldCh7IGFjdGlvbjogJ3BhcnNlJywgcGFnZTogdGl0bGUsIHByb3A6ICdzZWN0aW9ucycsIHJlZGlyZWN0czogJzEnIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXN1bHQ6IFBhZ2VQYXJzZVJlc3VsdCB8IG51bGwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoZWRTZWN0aW9ucyA9IHJlc3VsdC5wYXJzZS5zZWN0aW9ucy5maWx0ZXIoKHNlY3Rpb24pID0+IHNlY3Rpb24ubGluZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgodmFsdWUuc3BsaXQoJyMnKVsxXS50b0xvd2VyQ2FzZSgpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUobWF0Y2hlZFNlY3Rpb25zLm1hcCgoc2VjdGlvbikgPT4gKHsgZGF0YTogYCR7cmVzdWx0LnBhcnNlLnRpdGxlfSMke3NlY3Rpb24ubGluZX1gLCBsYWJlbDogYCR7cmVzdWx0LnBhcnNlLnRpdGxlfSMke3NlY3Rpb24ubGluZX1gIH0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGRlZmVycmVkLnJlc29sdmUoW10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkVGl0bGUgPSBtdy5UaXRsZS5uZXdGcm9tVGV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBtdy5BcGkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHZlcnNpb246IDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FwbGltaXQ6IDIwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcG5hbWVzcGFjZTogcGFyc2VkVGl0bGU/Lm5hbWVzcGFjZSA/PyAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcHByZWZpeDogcGFyc2VkVGl0bGU/LnRpdGxlID8/IHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYXRvcjogJ2FsbHBhZ2VzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wOiAnaW5mb3xwYWdlcHJvcHMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdDogQWxsUGFnZXNHZW5lcmF0b3JSZXN1bHQgfCBudWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5xdWVyeT8ucGFnZXMgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHJlc3VsdC5xdWVyeS5wYWdlcyAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKHBhZ2UpID0+IHBhZ2UudGl0bGUgIT09IHBhZ2VUaXRsZVBhcnNlZC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKHBhZ2UpID0+ICh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHBhZ2UudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBuZXcgT08udWkuSHRtbFNuaXBwZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJHtwYWdlLnRpdGxlfSR7cGFnZS5wYWdlcHJvcHMgJiYgJ2Rpc2FtYmlndWF0aW9uJyBpbiBwYWdlLnBhZ2Vwcm9wcyA/ICcgPGk+KGRpc2FtYmlndWF0aW9uKTwvaT4nIDogJyd9JHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmVkaXJlY3QnIGluIHBhZ2UgPyAnIDxpPihyZWRpcmVjdCk8L2k+JyA6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgZGVmZXJyZWQucmVzb2x2ZShbXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSh7IGFib3J0KCkge30gfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBnZXRMb29rdXBDYWNoZURhdGFGcm9tUmVzcG9uc2UgPSA8VD4ocmVzcG9uc2U6IFRbXSB8IG51bGwgfCB1bmRlZmluZWQpID0+IHJlc3BvbnNlID8/IFtdO1xuXG4gICAgICAgICAgICBnZXRMb29rdXBNZW51T3B0aW9uc0Zyb21EYXRhID0gKGRhdGE6IHsgZGF0YTogc3RyaW5nOyBsYWJlbDogc3RyaW5nIH1bXSkgPT4gZGF0YS5tYXAoKHsgZGF0YSwgbGFiZWwgfSkgPT4gbmV3IE9PLnVpLk1lbnVPcHRpb25XaWRnZXQoeyBkYXRhLCBsYWJlbCB9KSk7XG4gICAgICAgIH1cblxuICAgICAgICBPYmplY3QuYXNzaWduKFJlZGlyZWN0SW5wdXRXaWRnZXQucHJvdG90eXBlLCBPTy51aS5taXhpbi5Mb29rdXBFbGVtZW50LnByb3RvdHlwZSk7XG5cbiAgICAgICAgY29uc3QgcmVkaXJlY3RJbnB1dCA9IG5ldyBSZWRpcmVjdElucHV0V2lkZ2V0KHsgcGxhY2Vob2xkZXI6ICdUYXJnZXQgcGFnZSBuYW1lJywgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICAgIHJlZGlyZWN0SW5wdXQub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IHJlZGlyZWN0SW5wdXQuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKGBeKGh0dHBzPzopPy97Mn0/JHttdy5jb25maWcuZ2V0KCd3Z1NlcnZlcicpLnJlcGxhY2UoL15cXC97Mn0vLCAnJyl9L3dpa2kvYCksICcnKTtcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXjovLCAnJyk7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmVkaXJlY3RJbnB1dC5zZXRWYWx1ZSh2YWx1ZVswXS50b1VwcGVyQ2FzZSgpICsgdmFsdWUuc2xpY2UoMSkucmVwbGFjZUFsbCgnXycsICcgJykpO1xuICAgICAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXREaXNhYmxlZChmYWxzZSk7XG4gICAgICAgICAgICB9IGVsc2Ugc3VibWl0QnV0dG9uLnNldERpc2FibGVkKHRydWUpO1xuXG4gICAgICAgICAgICB1cGRhdGVTdW1tYXJ5KCk7XG4gICAgICAgICAgICBzdWJtaXRCdXR0b24uc2V0TGFiZWwoJ1N1Ym1pdCcpO1xuICAgICAgICAgICAgbmVlZHNDaGVjayA9IHRydWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlZGlyZWN0SW5wdXRMYXlvdXQgPSBuZXcgT08udWkuRmllbGRMYXlvdXQocmVkaXJlY3RJbnB1dCwgeyBsYWJlbDogbmV3IE9PLnVpLkh0bWxTbmlwcGV0KCc8Yj5SZWRpcmVjdCB0YXJnZXQ6PC9iPicpLCBhbGlnbjogJ3RvcCcgfSk7XG5cbiAgICAgICAgLyogUmVkaXJlY3QgY2F0ZWdvcml6YXRpb24gdGVtcGxhdGUgc2VsZWN0aW9uICovXG4gICAgICAgIGNvbnN0IHRhZ1NlbGVjdCA9IG5ldyBPTy51aS5NZW51VGFnTXVsdGlzZWxlY3RXaWRnZXQoe1xuICAgICAgICAgICAgYWxsb3dBcmJpdHJhcnk6IGZhbHNlLFxuICAgICAgICAgICAgYWxsb3dSZW9yZGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIG9wdGlvbnM6IE9iamVjdC5rZXlzKHJlZGlyZWN0VGVtcGxhdGVzKS5tYXAoKHRhZykgPT4gKHsgZGF0YTogdGFnLCBsYWJlbDogdGFnIH0pKSxcbiAgICAgICAgfSk7XG4gICAgICAgICh0YWdTZWxlY3QuZ2V0TWVudSgpIGFzIE9PLnVpLk1lbnVTZWxlY3RXaWRnZXQuQ29uZmlnT3B0aW9ucykuZmlsdGVyTW9kZSA9ICdzdWJzdHJpbmcnO1xuICAgICAgICB0YWdTZWxlY3Qub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNvcnRlZFRhZ3MgPSAodGFnU2VsZWN0LmdldFZhbHVlKCkgYXMgc3RyaW5nW10pLnNvcnQoKGEsIGIpID0+IGEudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGIudG9Mb3dlckNhc2UoKSkpO1xuXG4gICAgICAgICAgICBpZiAoKHRhZ1NlbGVjdC5nZXRWYWx1ZSgpIGFzIHN0cmluZ1tdKS5qb2luKCc7JykgIT09IHNvcnRlZFRhZ3Muam9pbignOycpKSB0YWdTZWxlY3Quc2V0VmFsdWUoc29ydGVkVGFncyk7XG5cbiAgICAgICAgICAgIHVwZGF0ZVN1bW1hcnkoKTtcbiAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRMYWJlbCgnU3VibWl0Jyk7XG4gICAgICAgICAgICBuZWVkc0NoZWNrID0gdHJ1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdGFnU2VsZWN0TGF5b3V0ID0gbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHRhZ1NlbGVjdCwgeyBsYWJlbDogbmV3IE9PLnVpLkh0bWxTbmlwcGV0KCc8Yj5SZWRpcmVjdCBjYXRlZ29yaXphdGlvbiB0ZW1wbGF0ZShzKTo8L2I+JyksIGFsaWduOiAndG9wJyB9KTtcblxuICAgICAgICAvKiBTdW1tYXJ5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IHN1bW1hcnlJbnB1dCA9IG5ldyBPTy51aS5Db21ib0JveElucHV0V2lkZ2V0KHtcbiAgICAgICAgICAgIG9wdGlvbnM6IFtcbiAgICAgICAgICAgICAgICB7IGRhdGE6ICdSZXNvbHZlIGRvdWJsZSByZWRpcmVjdCcgfSwgLy9cbiAgICAgICAgICAgICAgICB7IGRhdGE6ICdSZXNvbHZlIHNlbGYgcmVkaXJlY3QnIH0sXG4gICAgICAgICAgICAgICAgeyBkYXRhOiAnUmVtb3ZlIGluY29ycmVjdCByY2F0cycgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHN1bW1hcnlJbnB1dExheW91dCA9IG5ldyBPTy51aS5GaWVsZExheW91dChzdW1tYXJ5SW5wdXQsIHsgbGFiZWw6IG5ldyBPTy51aS5IdG1sU25pcHBldCgnPGI+U3VtbWFyeTo8L2I+JyksIGFsaWduOiAndG9wJyB9KTtcblxuICAgICAgICAvKiBTdWJtaXQgYnV0dG9uICovXG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IG5ldyBPTy51aS5CdXR0b25XaWRnZXQoeyBsYWJlbDogJ1N1Ym1pdCcsIGRpc2FibGVkOiB0cnVlLCBmbGFnczogWydwcm9ncmVzc2l2ZSddIH0pO1xuICAgICAgICBzdWJtaXRCdXR0b24uJGVsZW1lbnRbMF0uc3R5bGUubWFyZ2luQm90dG9tID0gJzAnO1xuXG4gICAgICAgIGxldCBuZWVkc0NoZWNrID0gdHJ1ZTtcbiAgICAgICAgc3VibWl0QnV0dG9uLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBbcmVkaXJlY3RJbnB1dCwgdGFnU2VsZWN0LCBzdW1tYXJ5SW5wdXQsIHN1Ym1pdEJ1dHRvbiwgc3luY1RhbGtDaGVja2JveCwgcGF0cm9sQ2hlY2tib3hdLmZpbHRlcihCb29sZWFuKSkgKGVsZW1lbnQgYXMgT08udWkuV2lkZ2V0KS5zZXREaXNhYmxlZCh0cnVlKTtcbiAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRMYWJlbCgnQ2hlY2tpbmcgdGFyZ2V0IHZhbGlkaXR5Li4uJyk7XG5cbiAgICAgICAgICAgIGxldCBwYXJzZWREZXN0aW5hdGlvbjtcblxuICAgICAgICAgICAgY29uc3QgZXJyb3JzID0gW107XG5cbiAgICAgICAgICAgIC8qIFRpdGxlIHZhbGlkYXRpb24gKi9cbiAgICAgICAgICAgIGlmIChuZWVkc0NoZWNrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb24gPSByZWRpcmVjdElucHV0LmdldFZhbHVlKCkudHJpbSgpO1xuXG4gICAgICAgICAgICAgICAgLyogSW52YWxpZCBjaGFyYWN0ZXJzICovXG4gICAgICAgICAgICAgICAgaWYgKCEvXlxccypbXltcXF17fH1dK1xccyokLy50ZXN0KGRlc3RpbmF0aW9uKSkgZXJyb3JzLnB1c2goeyB0aXRsZTogZGVzdGluYXRpb24sIG1lc3NhZ2U6ICdpcyBub3QgYSB2YWxpZCBwYWdlIHRpdGxlIScgfSk7XG5cbiAgICAgICAgICAgICAgICAvKiBGYWlsZWQgZHVyaW5nIHRpdGxlIHBhcnNpbmcgKi9cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWREZXN0aW5hdGlvbiA9IG13LlRpdGxlLm5ld0Zyb21UZXh0KGRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9ycy5sZW5ndGggPT09IDApIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiAnaXMgbm90IGEgdmFsaWQgcGFnZSB0aXRsZSEnIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXBhcnNlZERlc3RpbmF0aW9uICYmIGVycm9ycy5sZW5ndGggPT09IDApIGVycm9ycy5wdXNoKHsgdGl0bGU6IGRlc3RpbmF0aW9uLCBtZXNzYWdlOiAnaXMgbm90IGEgdmFsaWQgcGFnZSB0aXRsZSEnIH0pO1xuXG4gICAgICAgICAgICAgICAgLyogU2VsZiByZWRpcmVjdHMgKi9cbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkRGVzdGluYXRpb24/LnRvU3RyaW5nKCkgPT09IHBhZ2VUaXRsZVBhcnNlZC50b1N0cmluZygpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdjYW5ub3QgcmVkaXJlY3QgdG8gaXRzZWxmIScgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBkZXN0aW5hdGlvbkRhdGEgPSAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3F1ZXJ5JywgZm9ybWF0dmVyc2lvbjogMiwgcHJvcDogJ3BhZ2Vwcm9wcycsIHRpdGxlczogZGVzdGluYXRpb24gfSkuY2F0Y2goKGVycm9yQ29kZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8qIE5vbi1leGlzdGVudCBkZXN0aW5hdGlvbiAqLyBpZiAoZXJyb3JDb2RlID09PSAnbWlzc2luZ3RpdGxlJykgZXJyb3JzLnB1c2goeyB0aXRsZTogZGVzdGluYXRpb24sIG1lc3NhZ2U6ICdkb2VzIG5vdCBleGlzdCEnIH0pO1xuICAgICAgICAgICAgICAgICAgICAvKiBPdGhlciBBUEkgZXJyb3IgKi8gZWxzZSBlcnJvcnMucHVzaCh7IHRpdGxlOiBkZXN0aW5hdGlvbiwgbWVzc2FnZTogYHdhcyBub3QgYWJsZSB0byBiZSBmZXRjaGVkIGZyb20gdGhlIEFQSSAoJHtlcnJvckNvZGV9KSFgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9KSkgYXMgUGFnZXByb3BzUmVzdWx0IHwgbnVsbDtcbiAgICAgICAgICAgICAgICBjb25zdCBkZXN0aW5hdGlvblBhcnNlUmVzdWx0ID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdwYXJzZScsIHBhZ2U6IGRlc3RpbmF0aW9uLCBwcm9wOiAnc2VjdGlvbnMnLCByZWRpcmVjdHM6ICcxJyB9KSkgYXMgUGFnZVBhcnNlUmVzdWx0O1xuXG4gICAgICAgICAgICAgICAgLyogRG91YmxlIHJlZGlyZWN0cyAqL1xuICAgICAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvblBhcnNlUmVzdWx0LnBhcnNlLnJlZGlyZWN0cz8uWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uUmVkaXJlY3QgPVxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5yZWRpcmVjdHNbMF0udG8gKyAoZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5yZWRpcmVjdHNbMF0udG9mcmFnbWVudCA/IGAjJHtkZXN0aW5hdGlvblBhcnNlUmVzdWx0LnBhcnNlLnJlZGlyZWN0c1swXS50b2ZyYWdtZW50fWAgOiAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkZXN0aW5hdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBpcyBhIHJlZGlyZWN0IHRvIDxhIGhyZWY9XCIke213LnV0aWwuZ2V0VXJsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uUmVkaXJlY3QsXG4gICAgICAgICAgICAgICAgICAgICAgICApfVwiIHRhcmdldD1cIl9ibGFua1wiPiR7ZGVzdGluYXRpb25SZWRpcmVjdH08L2E+LiBSZXRhcmdldCB0byB0aGF0IHBhZ2UgaW5zdGVhZCwgYXMgZG91YmxlIHJlZGlyZWN0cyBhcmVuJ3QgYWxsb3dlZC5gLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiBOb24tZXhpc3RlbnQgc2VjdGlvbiAqL1xuICAgICAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvbi5zcGxpdCgnIycpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsaWRTZWN0aW9uID0gZGVzdGluYXRpb25QYXJzZVJlc3VsdC5wYXJzZS5zZWN0aW9ucy5maW5kKChzZWN0aW9uKSA9PiBzZWN0aW9uLmxpbmUgPT09IGRlc3RpbmF0aW9uLnNwbGl0KCcjJylbMV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRTZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gYW5jaG9yJykpIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogJ2lzIHRhZ2dlZCBhcyBhIHJlZGlyZWN0IHRvIGFuIGFuY2hvciwgYnV0IGl0IGlzIGFjdHVhbGx5IGEgcmVkaXJlY3QgdG8gYSBzZWN0aW9uIScgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIHNlY3Rpb24nKSkgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgYSByZWRpcmVjdCB0byBhIHNlY3Rpb24sIGJ1dCBpdCBpcyBub3QgdGFnZ2VkIHdpdGggPGNvZGU+e3tSIHRvIHNlY3Rpb259fTwvY29kZT4hJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uQ29udGVudCA9IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3F1ZXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0dmVyc2lvbjogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcDogJ3JldmlzaW9ucycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ2cHJvcDogJ2NvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydnNsb3RzOiAnKicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlczogcGFyc2VkRGVzdGluYXRpb24hLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpIGFzIFBhZ2VSZXZpc2lvbnNSZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgICAgICkucXVlcnkucGFnZXNbMF0ucmV2aXNpb25zWzBdLnNsb3RzLm1haW4uY29udGVudDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW5jaG9ycyA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi4oZGVzdGluYXRpb25Db250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXRjaCgvKD88PXt7XFxzKj9bQWFdKD86bmNob3JzP3xuY2hvciBmb3IgcmVkaXJlY3R8bmtlcnxOQ0hPUnxuYylcXHMqP1xcfCkuKz8oPz19fSkvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPy5tYXAoKGFuY2hvcjogc3RyaW5nKSA9PiBhbmNob3Iuc3BsaXQoJ3wnKS5tYXAoKHBhcnQpID0+IHBhcnQudHJpbSgpKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPy5mbGF0KCkgPz8gW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLihkZXN0aW5hdGlvbkNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hdGNoKC8oPzw9e3tcXHMqPyg/OltWdl0oPzppc2libGUgYW5jaG9ycz98aXNhbmN8QW5jaHxhbmNob3J8aXNpYmxlYW5jaG9yfGEpfFtBYV0oPzpuY2hvcmR8Y2hvcmVkfG5jaG9yXFwrKXxbVHRdZXh0IGFuY2hvcilcXHMqP1xcfCkuKz8oPz0oPzwhIXw9KX19KS9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Lm1hcCgoYW5jaG9yOiBzdHJpbmcpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoJ3wnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKHBhcnQpID0+IHBhcnQudHJpbSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKHBhcnQpID0+ICEvXnRleHRcXHMqPz0vLnRlc3QocGFydCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8uZmxhdCgpID8/IFtdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi4oZGVzdGluYXRpb25Db250ZW50Lm1hdGNoKC8oPzw9aWQ9KVwiPy4rPyg/PVwifD58XFx8KS9nKT8ubWFwKChhbmNob3I6IHN0cmluZykgPT4gYW5jaG9yLnRyaW0oKSkgPz8gW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmNob3JzLmluY2x1ZGVzKGRlc3RpbmF0aW9uLnNwbGl0KCcjJylbMV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIHNlY3Rpb24nKSkgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgdGFnZ2VkIGFzIGEgcmVkaXJlY3QgdG8gYSBzZWN0aW9uLCBidXQgaXQgaXMgYWN0dWFsbHkgYSByZWRpcmVjdCB0byBhbiBhbmNob3IhJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIGFuY2hvcicpKSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdpcyBhIHJlZGlyZWN0IHRvIGFuIGFuY2hvciwgYnV0IGl0IGlzIG5vdCB0YWdnZWQgd2l0aCA8Y29kZT57e1IgZnJvbSBhbmNob3J9fTwvY29kZT4hJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6IGBpcyBhIHJlZGlyZWN0IHRvIDxhIGhyZWY9XCIke213LnV0aWwuZ2V0VXJsKGRlc3RpbmF0aW9uKX1cIiB0YXJnZXQ9XCJfYmxhbmtcIj4ke2Rlc3RpbmF0aW9ufTwvYT4sIGJ1dCB0aGF0IHNlY3Rpb24gb3IgYW5jaG9yIGRvZXMgbm90IGV4aXN0IWAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiBJbXByb3Blcmx5IHRhZ2dlZCBhcyByZWRpcmVjdCB0byBzZWN0aW9uL2FuY2hvciAqL1xuICAgICAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvbi5zcGxpdCgnIycpLmxlbmd0aCA9PT0gMSAmJiAodGFnU2VsZWN0LmdldFZhbHVlKCkuaW5jbHVkZXMoJ1IgdG8gc2VjdGlvbicpIHx8IHRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmluY2x1ZGVzKCdSIHRvIGFuY2hvcicpKSlcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goeyBtZXNzYWdlOiAnaXMgbm90IGEgcmVkaXJlY3QgdG8gYSBzZWN0aW9uL2FuY2hvciwgYnV0IGl0IGlzIHRhZ2dlZCB3aXRoIDxjb2RlPnt7UiBmcm9tIHNlY3Rpb259fTwvY29kZT4gb3IgPGNvZGU+e3tSIGZyb20gYW5jaG9yfX08L2NvZGU+IScgfSk7XG5cbiAgICAgICAgICAgICAgICAvKiBSZWRpcmVjdCB0byBkaXNhbWJpZ3VhdGlvbiBwYWdlIHdpdGhvdXQgdGVtcGxhdGUgKi9cbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICdkaXNhbWJpZ3VhdGlvbicgaW4gZGVzdGluYXRpb25EYXRhIS5xdWVyeS5wYWdlc1swXS5wYWdlcHJvcHMgJiZcbiAgICAgICAgICAgICAgICAgICAgIVtcbiAgICAgICAgICAgICAgICAgICAgICAgICdSIGZyb20gYW1iaWd1b3VzIHNvcnQgbmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnUiBmcm9tIGFtYmlndW91cyB0ZXJtJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdSIHRvIGRpc2FtYmlndWF0aW9uIHBhZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1IgZnJvbSBpbmNvbXBsZXRlIGRpc2FtYmlndWF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdSIGZyb20gaW5jb3JyZWN0IGRpc2FtYmlndWF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdSIGZyb20gb3RoZXIgZGlzYW1iaWd1YXRpb24nLFxuICAgICAgICAgICAgICAgICAgICBdLnNvbWUoKHRlbXBsYXRlKSA9PiB0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcyh0ZW1wbGF0ZSkpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdpcyBhIHJlZGlyZWN0IHRvIGEgZGlzYW1iaWd1YXRpb24gcGFnZSwgYnV0IGl0IGlzIG5vdCB0YWdnZWQgd2l0aCBhIGRpc2FtYmlndWF0aW9uIGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlIScgfSk7XG5cbiAgICAgICAgICAgICAgICAvKiBJbXByb3Blcmx5IHRhZ2dlZCBhcyByZWRpcmVjdCB0byBkaXNhbWJpZ3VhdGlvbiBwYWdlICovXG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAhKCdkaXNhbWJpZ3VhdGlvbicgaW4gZGVzdGluYXRpb25EYXRhIS5xdWVyeS5wYWdlc1swXS5wYWdlcHJvcHMpICYmXG4gICAgICAgICAgICAgICAgICAgIFsnUiBmcm9tIGFtYmlndW91cyBzb3J0IG5hbWUnLCAnUiBmcm9tIGFtYmlndW91cyB0ZXJtJywgJ1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZScsICdSIGZyb20gaW5jb21wbGV0ZSBkaXNhbWJpZ3VhdGlvbiddLnNvbWUoKHRlbXBsYXRlKSA9PiB0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcyh0ZW1wbGF0ZSkpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6ICdpcyBub3QgYSByZWRpcmVjdCB0byBhIGRpc2FtYmlndWF0aW9uIHBhZ2UsIGJ1dCBpdCBpcyB0YWdnZWQgd2l0aCBhIGRpc2FtYmlndWF0aW9uIGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlIScgfSk7XG5cbiAgICAgICAgICAgICAgICAvKiB7e1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZX19IHdpdGhvdXQgXCIgKGRpc2FtYmlndWF0aW9uKVwiIGF0IGVuZCBvZiB0aXRsZSAqL1xuICAgICAgICAgICAgICAgIGlmICh0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcygnUiB0byBkaXNhbWJpZ3VhdGlvbiBwYWdlJykgJiYgIXBhZ2VUaXRsZVBhcnNlZC5nZXRNYWluVGV4dCgpLmVuZHNXaXRoKCcgKGRpc2FtYmlndWF0aW9uKScpKVxuICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpcyB0YWdnZWQgd2l0aCA8Y29kZT57e1IgdG8gZGlzYW1iaWd1YXRpb24gcGFnZX19PC9jb2RlPiwgYnV0IHRoaXMgdGl0bGUgZG9lcyBub3QgZW5kIHdpdGggXCIgKGRpc2FtYmlndWF0aW9uKVwiLiBVc2UgPGNvZGU+e3tSIGZyb20gYW1iaWd1b3VzIHRlcm19fTwvY29kZT4gb3IgYSBzaW1pbGFyIGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlIGluc3RlYWQhJyxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvKiBTeW5jaW5nIHRhbGsgcGFnZSBidXQgdGFsayBwYWdlIGV4aXN0cyBhbmQgaXNuJ3QgYSByZWRpcmVjdCAqL1xuICAgICAgICAgICAgICAgIGlmIChzeW5jVGFsa0NoZWNrYm94Py5pc1NlbGVjdGVkKCkgJiYgIXRhbGtEYXRhIS5xdWVyeS5wYWdlc1swXS5taXNzaW5nICYmICF0YWxrRGF0YSEucXVlcnkucGFnZXNbMF0ucmVkaXJlY3QpXG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgdGl0bGU6IHBhZ2VUaXRsZVBhcnNlZC5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKSwgbWVzc2FnZTogJ2V4aXN0cywgYnV0IGlzIG5vdCBhIHJlZGlyZWN0IScgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmVkaXJlY3QtaGVscGVyLXdhcm5pbmcnKSkgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHsgdGl0bGUsIG1lc3NhZ2UgfSBvZiBlcnJvcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBuZXcgT08udWkuSHRtbFNuaXBwZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBgJHt0aXRsZSA/IGA8YSBocmVmPVwiJHttdy51dGlsLmdldFVybCh0aXRsZSl9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHt0aXRsZX08L2E+YCA6ICdUaGlzIHBhZ2UnfSAke21lc3NhZ2V9IENsaWNrIGFnYWluIHdpdGhvdXQgbWFraW5nIGNoYW5nZXMgdG8gc3VibWl0IGFueXdheS5gLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB3YXJuaW5nTWVzc2FnZSA9IG5ldyBPTy51aS5NZXNzYWdlV2lkZ2V0KHsgdHlwZTogJ2Vycm9yJywgY2xhc3NlczogWydyZWRpcmVjdC1oZWxwZXItd2FybmluZyddLCBpbmxpbmU6IHRydWUsIGxhYmVsIH0pO1xuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTWVzc2FnZS4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4JztcblxuICAgICAgICAgICAgICAgICAgICBlZGl0b3JCb3guJGVsZW1lbnRbMF0uYXBwZW5kKHdhcm5pbmdNZXNzYWdlLiRlbGVtZW50WzBdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgW3JlZGlyZWN0SW5wdXQsIHRhZ1NlbGVjdCwgc3VtbWFyeUlucHV0LCBzdWJtaXRCdXR0b24sIHN5bmNUYWxrQ2hlY2tib3gsIHBhdHJvbENoZWNrYm94XS5maWx0ZXIoQm9vbGVhbikpIChlbGVtZW50IGFzIE9PLnVpLldpZGdldCkuc2V0RGlzYWJsZWQoZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnNldExhYmVsKCdTdWJtaXQgYW55d2F5Jyk7XG4gICAgICAgICAgICAgICAgbmVlZHNDaGVjayA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwYXJzZWREZXN0aW5hdGlvbiA9IG13LlRpdGxlLm5ld0Zyb21UZXh0KHJlZGlyZWN0SW5wdXQuZ2V0VmFsdWUoKSk7XG5cbiAgICAgICAgICAgIC8qIEVkaXQvY3JlYXRlIHJlZGlyZWN0ICovXG4gICAgICAgICAgICBzdWJtaXRCdXR0b24uc2V0TGFiZWwoYCR7ZXhpc3RzID8gJ0VkaXRpbmcnIDogJ0NyZWF0aW5nJ30gcmVkaXJlY3QuLi5gKTtcblxuICAgICAgICAgICAgY29uc3Qgb3V0cHV0ID0gW1xuICAgICAgICAgICAgICAgIGAjUkVESVJFQ1QgW1ske3JlZGlyZWN0SW5wdXQuZ2V0VmFsdWUoKS50cmltKCl9XV1gLCAvL1xuICAgICAgICAgICAgICAgIHRhZ1NlbGVjdC5nZXRWYWx1ZSgpLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICAgICAgPyBge3tSZWRpcmVjdCBjYXRlZ29yeSBzaGVsbHxcXG4keyh0YWdTZWxlY3QuZ2V0VmFsdWUoKSBhcyBzdHJpbmdbXSkubWFwKCh0YWcpID0+IGB7eyR7dGFnfSR7b2xkUmVkaXJlY3RUYWdEYXRhPy5bdGFnXSA/IGB8JHtvbGRSZWRpcmVjdFRhZ0RhdGFbdGFnXX1gIDogJyd9fX1gKS5qb2luKCdcXG4nKX1cXG59fWBcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAgICAgICAgIG9sZFN0cmF5VGV4dCxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgICAgICAgLmpvaW4oJ1xcblxcbicpO1xuXG4gICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0gKHN1bW1hcnlJbnB1dC5nZXRWYWx1ZSgpIHx8IChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIpICsgJyAodmlhIFtbVXNlcjpFZWppdDQzL3NjcmlwdHMvcmVkaXJlY3QtaGVscGVyfHJlZGlyZWN0LWhlbHBlcl1dKSc7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG5ldyBtdy5BcGkoKVxuICAgICAgICAgICAgICAgIC5lZGl0KHBhZ2VUaXRsZSwgKCkgPT4gKHsgdGV4dDogb3V0cHV0LCBzdW1tYXJ5IH0pKVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIHsgZXJyb3IgfTogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvckNvZGUgPT09ICdub2NyZWF0ZS1taXNzaW5nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbXcuQXBpKCkuY3JlYXRlKHBhZ2VUaXRsZSwgeyBzdW1tYXJ5IH0sIG91dHB1dCkuY2F0Y2goKGVycm9yQ29kZTogc3RyaW5nLCB7IGVycm9yIH06IE1lZGlhV2lraURhdGFFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeShgRXJyb3IgY3JlYXRpbmcgJHtwYWdlVGl0bGV9OiAke2Vycm9yLmluZm99ICgke2Vycm9yQ29kZX0pYCwgeyB0eXBlOiAnZXJyb3InIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBlZGl0aW5nIG9yIGNyZWF0aW5nICR7cGFnZVRpdGxlfTogJHtlcnJvci5pbmZvfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XG5cbiAgICAgICAgICAgIG13Lm5vdGlmeShgUmVkaXJlY3QgJHtleGlzdHMgPyAnZWRpdGVkJyA6ICdjcmVhdGVkJ30gc3VjY2Vzc2Z1bGx5IWAsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuXG4gICAgICAgICAgICAvKiBTeW5jIHRhbGsgcGFnZSBjaGVja2JveCBoYW5kbGVyICovXG4gICAgICAgICAgICBpZiAoc3luY1RhbGtDaGVja2JveD8uaXNTZWxlY3RlZCgpKSB7XG4gICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnNldExhYmVsKCdFZGl0aW5nIHRhbGsgcGFnZS4uLicpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZnJvbU1vdmUgPSB0YWdTZWxlY3QuZ2V0VmFsdWUoKS5pbmNsdWRlcygnUiBmcm9tIG1vdmUnKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IFtcbiAgICAgICAgICAgICAgICAgICAgYCNSRURJUkVDVCBbWyR7cGFyc2VkRGVzdGluYXRpb24hLmdldFRhbGtQYWdlKCkhLmdldFByZWZpeGVkVGV4dCgpfV1dYCwgLy9cbiAgICAgICAgICAgICAgICAgICAgZnJvbU1vdmUgPyAne3tSZWRpcmVjdCBjYXRlZ29yeSBzaGVsbHxcXG57e1IgZnJvbSBtb3ZlfX1cXG59fScgOiBudWxsLFxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAgICAgICAgICAgICAuam9pbignXFxuXFxuJyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0YWxrUGFnZSA9IHBhZ2VUaXRsZVBhcnNlZC5nZXRUYWxrUGFnZSgpIS5nZXRQcmVmaXhlZFRleHQoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRhbGtSZXN1bHQgPSBhd2FpdCBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgLmVkaXQodGFsa1BhZ2UsICgpID0+ICh7IHRleHQ6IG91dHB1dCwgc3VtbWFyeTogJ1N5bmNpbmcgcmVkaXJlY3QgZnJvbSBtYWluIHBhZ2UgKHZpYSBbW1VzZXI6RWVqaXQ0My9zY3JpcHRzL3JlZGlyZWN0LWhlbHBlcnxyZWRpcmVjdC1oZWxwZXJdXSknIH0pKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yQ29kZTogc3RyaW5nLCB7IGVycm9yIH06IE1lZGlhV2lraURhdGFFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yQ29kZSA9PT0gJ25vY3JlYXRlLW1pc3NpbmcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbXcuQXBpKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNyZWF0ZSh0YWxrUGFnZSwgeyBzdW1tYXJ5OiAnU3luY2luZyByZWRpcmVjdCBmcm9tIG1haW4gcGFnZSAodmlhIFtbVXNlcjpFZWppdDQzL3NjcmlwdHMvcmVkaXJlY3QtaGVscGVyfHJlZGlyZWN0LWhlbHBlcl1dKScgfSwgb3V0cHV0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yQ29kZTogc3RyaW5nLCB7IGVycm9yIH06IE1lZGlhV2lraURhdGFFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBjcmVhdGluZyAke3RhbGtQYWdlfTogJHtlcnJvci5pbmZvfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoYEVycm9yIGVkaXRpbmcgb3IgY3JlYXRpbmcgJHt0YWxrUGFnZX06ICR7ZXJyb3IuaW5mb30gKCR7ZXJyb3JDb2RlfSlgLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0YWxrUmVzdWx0KSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBtdy5ub3RpZnkoJ1RhbGsgcGFnZSBzeW5jZWQgc3VjY2Vzc2Z1bGx5IScsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBQYXRyb2wgY2hlY2tib3ggaGFuZGxlciAqL1xuICAgICAgICAgICAgaWYgKHBhdHJvbENoZWNrYm94Py5pc1NlbGVjdGVkKCkpIHtcbiAgICAgICAgICAgICAgICBzdWJtaXRCdXR0b24uc2V0TGFiZWwoJ1BhdHJvbGxpbmcgcmVkaXJlY3QuLi4nKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdHJvbExpbms6IEhUTUxBbmNob3JFbGVtZW50IHwgbnVsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXRyb2xsaW5rIGEnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXJrUmV2aWV3ZWRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbXdlLXB0LW1hcmstYXMtcmV2aWV3ZWQtYnV0dG9uJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQgfCBudWxsO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBhdHJvbExpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF0cm9sUmVzdWx0ID0gYXdhaXQgbmV3IG13LkFwaSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zdFdpdGhUb2tlbigncGF0cm9sJywgeyBhY3Rpb246ICdwYXRyb2wnLCByY2lkOiBuZXcgVVJMKHBhdHJvbExpbmsuaHJlZikuc2VhcmNoUGFyYW1zLmdldCgncmNpZCcpISB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvckNvZGU6IHN0cmluZywgeyBlcnJvciB9OiBNZWRpYVdpa2lEYXRhRXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoYEVycm9yIHBhdHJvbGxpbmcgJHtwYWdlVGl0bGV9IHZpYSBBUEk6ICR7ZXJyb3IuaW5mb30gKCR7ZXJyb3JDb2RlfSlgLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhdHJvbFJlc3VsdCkgbXcubm90aWZ5KCdSZWRpcmVjdCBwYXRyb2xsZWQgc3VjY2Vzc2Z1bGx5IScsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFya1Jldmlld2VkQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtSZXZpZXdlZEJ1dHRvbi5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoJ1JlZGlyZWN0IHBhdHJvbGxlZCBzdWNjZXNzZnVsbHkhJywgeyB0eXBlOiAnc3VjY2VzcycgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIG13Lm5vdGlmeSgnUGFnZSBjdXJhdGlvbiB0b29sYmFyIG5vdCBmb3VuZCwgcmVkaXJlY3QgY2Fubm90IGJlIHBhdHJvbGxlZCEnLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRMYWJlbCgnQ29tcGxldGUsIHJlbG9hZGluZy4uLicpO1xuXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG13LnV0aWwuZ2V0VXJsKHBhZ2VUaXRsZSwgeyByZWRpcmVjdDogJ25vJyB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IHRhbGtEYXRhOiBQYWdlSW5mb1Jlc3VsdCB8IHVuZGVmaW5lZDtcblxuICAgICAgICBsZXQgc3luY1RhbGtDaGVja2JveDogT08udWkuQ2hlY2tib3hJbnB1dFdpZGdldCB8IHVuZGVmaW5lZCwgc3luY1RhbGtMYXlvdXQ6IE9PLnVpLldpZGdldCB8IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKCFwYWdlVGl0bGVQYXJzZWQuaXNUYWxrUGFnZSgpKSB7XG4gICAgICAgICAgICB0YWxrRGF0YSA9IChhd2FpdCBuZXcgbXcuQXBpKCkuZ2V0KHsgYWN0aW9uOiAncXVlcnknLCBmb3JtYXR2ZXJzaW9uOiAyLCBwcm9wOiAnaW5mbycsIHRpdGxlczogcGFnZVRpdGxlUGFyc2VkLmdldFRhbGtQYWdlKCkhLmdldFByZWZpeGVkVGV4dCgpIH0pKSBhcyBQYWdlSW5mb1Jlc3VsdDtcbiAgICAgICAgICAgIHN5bmNUYWxrQ2hlY2tib3ggPSBuZXcgT08udWkuQ2hlY2tib3hJbnB1dFdpZGdldCh7IHNlbGVjdGVkOiAhIXRhbGtEYXRhLnF1ZXJ5LnBhZ2VzWzBdLnJlZGlyZWN0IH0pO1xuXG4gICAgICAgICAgICBzeW5jVGFsa0xheW91dCA9IG5ldyBPTy51aS5XaWRnZXQoeyBjb250ZW50OiBbbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHN5bmNUYWxrQ2hlY2tib3gsIHsgbGFiZWw6ICdTeW5jIHRhbGsgcGFnZScsIGFsaWduOiAnaW5saW5lJyB9KV0gfSk7XG4gICAgICAgICAgICBzeW5jVGFsa0xheW91dC4kZWxlbWVudFswXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtYXJrQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI213ZS1wdC1tYXJrIC5td2UtcHQtdG9vbC1pY29uJykgYXMgSFRNTEltYWdlRWxlbWVudCB8IG51bGw7XG4gICAgICAgIG1hcmtCdXR0b24/LmNsaWNrKCk7XG4gICAgICAgIG1hcmtCdXR0b24/LmNsaWNrKCk7XG5cbiAgICAgICAgbGV0IHNob3VsZFByb21wdFBhdHJvbDtcbiAgICAgICAgaWYgKG13LmNvbmZpZy5nZXQoJ3dnTmFtZXNwYWNlTnVtYmVyJykgIT09IDApIHNob3VsZFByb21wdFBhdHJvbCA9IGZhbHNlO1xuICAgICAgICBlbHNlIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGF0cm9sbGluaycpKSBzaG91bGRQcm9tcHRQYXRyb2wgPSB0cnVlO1xuICAgICAgICBlbHNlIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbXdlLXB0LW1hcmstYXMtcmV2aWV3ZWQtYnV0dG9uJykpIHNob3VsZFByb21wdFBhdHJvbCA9IHRydWU7XG4gICAgICAgIGVsc2UgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtd2UtcHQtbWFyay1hcy11bnJldmlld2VkLWJ1dHRvbicpKSBzaG91bGRQcm9tcHRQYXRyb2wgPSBmYWxzZTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoIW13LmNvbmZpZy5nZXQoJ3dnQXJ0aWNsZUlkJykpIHNob3VsZFByb21wdFBhdHJvbCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgdXNlclBlcm1pc3Npb25zID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdxdWVyeScsIG1ldGE6ICd1c2VyaW5mbycsIHVpcHJvcDogJ3JpZ2h0cycgfSkpIGFzIFVzZXJQZXJtaXNzaW9uc1Jlc3BvbnNlO1xuICAgICAgICAgICAgaWYgKCF1c2VyUGVybWlzc2lvbnMucXVlcnkudXNlcmluZm8ucmlnaHRzLmluY2x1ZGVzKCdwYXRyb2wnKSkgc2hvdWxkUHJvbXB0UGF0cm9sID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGNvbnN0IHBhdHJvbFJlc3BvbnNlID0gKGF3YWl0IG5ldyBtdy5BcGkoKS5nZXQoeyBhY3Rpb246ICdwYWdldHJpYWdlbGlzdCcsIHBhZ2VfaWQ6IG13LmNvbmZpZy5nZXQoJ3dnQXJ0aWNsZUlkJykgfSkpIGFzIFBhZ2VUcmlhZ2VMaXN0UmVzcG9uc2U7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uXG5cbiAgICAgICAgICAgIGlmIChwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5wYWdlc1swXT8udXNlcl9uYW1lID09PSBtdy5jb25maWcuZ2V0KCd3Z1VzZXJOYW1lJykpIHNob3VsZFByb21wdFBhdHJvbCA9IGZhbHNlO1xuICAgICAgICAgICAgZWxzZSBpZiAocGF0cm9sUmVzcG9uc2UucGFnZXRyaWFnZWxpc3QucmVzdWx0ICE9PSAnc3VjY2VzcycgfHwgcGF0cm9sUmVzcG9uc2UucGFnZXRyaWFnZWxpc3QucGFnZXMubGVuZ3RoID09PSAwKSBzaG91bGRQcm9tcHRQYXRyb2wgPSBmYWxzZTtcbiAgICAgICAgICAgIGVsc2Ugc2hvdWxkUHJvbXB0UGF0cm9sID0gIU51bWJlci5wYXJzZUludChwYXRyb2xSZXNwb25zZS5wYWdldHJpYWdlbGlzdC5wYWdlc1swXT8ucGF0cm9sX3N0YXR1cyk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcGF0cm9sQ2hlY2tib3g6IE9PLnVpLkNoZWNrYm94SW5wdXRXaWRnZXQgfCB1bmRlZmluZWQsIHBhdHJvbExheW91dDogT08udWkuV2lkZ2V0IHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAoc2hvdWxkUHJvbXB0UGF0cm9sKSB7XG4gICAgICAgICAgICBwYXRyb2xDaGVja2JveCA9IG5ldyBPTy51aS5DaGVja2JveElucHV0V2lkZ2V0KHsgc2VsZWN0ZWQ6IHRydWUgfSk7XG5cbiAgICAgICAgICAgIHBhdHJvbExheW91dCA9IG5ldyBPTy51aS5XaWRnZXQoeyBjb250ZW50OiBbbmV3IE9PLnVpLkZpZWxkTGF5b3V0KHBhdHJvbENoZWNrYm94LCB7IGxhYmVsOiAnTWFyayBhcyBwYXRyb2xsZWQnLCBhbGlnbjogJ2lubGluZScgfSldIH0pO1xuICAgICAgICAgICAgcGF0cm9sTGF5b3V0LiRlbGVtZW50WzBdLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN1Ym1pdExheW91dCA9IG5ldyBPTy51aS5Ib3Jpem9udGFsTGF5b3V0KHsgaXRlbXM6IFtzdWJtaXRCdXR0b24sIHN5bmNUYWxrTGF5b3V0LCBwYXRyb2xMYXlvdXRdLmZpbHRlcihCb29sZWFuKSBhcyBPTy51aS5XaWRnZXRbXSB9KTtcbiAgICAgICAgc3VibWl0TGF5b3V0LiRlbGVtZW50WzBdLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JztcblxuICAgICAgICAvKiBBZGQgZWxlbWVudHMgdG8gc2NyZWVuICovXG4gICAgICAgIGVkaXRvckJveC4kZWxlbWVudFswXS5hcHBlbmQoXG4gICAgICAgICAgICAuLi4oW3N5bmNXaXRoTWFpbkJ1dHRvbj8uJGVsZW1lbnQ/LlswXSwgcmVkaXJlY3RJbnB1dExheW91dC4kZWxlbWVudFswXSwgdGFnU2VsZWN0TGF5b3V0LiRlbGVtZW50WzBdLCBzdW1tYXJ5SW5wdXRMYXlvdXQuJGVsZW1lbnRbMF0sIHN1Ym1pdExheW91dC4kZWxlbWVudFswXV0uZmlsdGVyKFxuICAgICAgICAgICAgICAgIEJvb2xlYW4sXG4gICAgICAgICAgICApIGFzIEhUTUxFbGVtZW50W10pLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnRlbnRUZXh0LnByZXBlbmQoZWRpdG9yQm94LiRlbGVtZW50WzBdKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlcyB0aGUgc3VtbWFyeSBpbnB1dCBwbGFjZWhvbGRlci5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVN1bW1hcnkoKSB7XG4gICAgICAgICAgICBjb25zdCByZWRpcmVjdFZhbHVlID0gcmVkaXJlY3RJbnB1dC5nZXRWYWx1ZSgpLnRyaW0oKTtcblxuICAgICAgICAgICAgaWYgKCFyZWRpcmVjdFZhbHVlKSAoc3VtbWFyeUlucHV0LiR0YWJJbmRleGVkWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnBsYWNlaG9sZGVyID0gJyc7XG4gICAgICAgICAgICBlbHNlIGlmIChleGlzdHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRDaGFuZ2VkID0gcmVkaXJlY3RWYWx1ZSAhPT0gb2xkUmVkaXJlY3RUYXJnZXQ7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFnc0NoYW5nZWQgPSB0YWdTZWxlY3QuZ2V0VmFsdWUoKS5qb2luKCc7JykgIT09IG9sZFJlZGlyZWN0VGFncz8uam9pbignOycpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldENoYW5nZWQgJiYgdGFnc0NoYW5nZWQpIChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSBgQ2hhbmdpbmcgcmVkaXJlY3QgdG8gW1ske3JlZGlyZWN0VmFsdWV9XV0gYW5kIGNoYW5naW5nIGNhdGVnb3JpemF0aW9uIHRlbXBsYXRlc2A7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0Q2hhbmdlZCkgKHN1bW1hcnlJbnB1dC4kdGFiSW5kZXhlZFswXSBhcyBIVE1MSW5wdXRFbGVtZW50KS5wbGFjZWhvbGRlciA9IGBDaGFuZ2luZyByZWRpcmVjdCB0byBbWyR7cmVkaXJlY3RWYWx1ZX1dXWA7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGFnc0NoYW5nZWQpIChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSAnQ2hhbmdpbmcgY2F0ZWdvcml6YXRpb24gdGVtcGxhdGVzJztcbiAgICAgICAgICAgICAgICBlbHNlIChzdW1tYXJ5SW5wdXQuJHRhYkluZGV4ZWRbMF0gYXMgSFRNTElucHV0RWxlbWVudCkucGxhY2Vob2xkZXIgPSAnUmVkaXJlY3QgY2xlYW51cCc7XG4gICAgICAgICAgICB9IGVsc2UgKHN1bW1hcnlJbnB1dC4kdGFiSW5kZXhlZFswXSBhcyBIVE1MSW5wdXRFbGVtZW50KS5wbGFjZWhvbGRlciA9IGBDcmVhdGluZyByZWRpcmVjdCB0byBbWyR7cmVkaXJlY3RWYWx1ZX1dXWA7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBMb2FkIGN1cnJlbnQgdGFyZ2V0IGFuZCB0YWdzLCBpZiBhcHBsaWNhYmxlICovXG4gICAgICAgIGxldCBvbGRSZWRpcmVjdFRhcmdldDogc3RyaW5nIHwgdW5kZWZpbmVkLCBvbGRSZWRpcmVjdFRhZ3M6IHN0cmluZ1tdIHwgdW5kZWZpbmVkLCBvbGRSZWRpcmVjdFRhZ0RhdGE6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQsIG9sZFN0cmF5VGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZXhpc3RzKSB7XG4gICAgICAgICAgICBjb25zdCBwYWdlQ29udGVudCA9IChcbiAgICAgICAgICAgICAgICAoYXdhaXQgbmV3IG13LkFwaSgpLmdldCh7IGFjdGlvbjogJ3F1ZXJ5JywgZm9ybWF0dmVyc2lvbjogMiwgcHJvcDogJ3JldmlzaW9ucycsIHJ2cHJvcDogJ2NvbnRlbnQnLCBydnNsb3RzOiAnKicsIHRpdGxlczogcGFnZVRpdGxlIH0pKSBhcyBQYWdlUmV2aXNpb25zUmVzdWx0XG4gICAgICAgICAgICApLnF1ZXJ5LnBhZ2VzWzBdLnJldmlzaW9uc1swXS5zbG90cy5tYWluLmNvbnRlbnQudHJpbSgpO1xuXG4gICAgICAgICAgICBvbGRSZWRpcmVjdFRhcmdldCA9IC9eI3JlZGlyZWN0Oj9cXHMqXFxbXFxbXFxzKihbXltcXF17fH1dKz8pXFxzKig/OlxcfFteW1xcXXt8fV0rPyk/XV1cXHMqL2kuZXhlYyhwYWdlQ29udGVudCk/LlsxXTtcbiAgICAgICAgICAgIG9sZFJlZGlyZWN0VGFncyA9IChcbiAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyhyZWRpcmVjdFRlbXBsYXRlcylcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgoW3RhZywgcmVkaXJlY3RzXSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIFt0YWcsIC4uLnJlZGlyZWN0c10uc29tZSgodGFnT3JSZWRpcmVjdCkgPT4gbmV3IFJlZ0V4cChge3tcXFxccypbJHt0YWdPclJlZGlyZWN0WzBdLnRvTG93ZXJDYXNlKCl9JHt0YWdPclJlZGlyZWN0WzBdfV0ke3RhZ09yUmVkaXJlY3Quc2xpY2UoMSl9XFxcXHMqKFxcXFx8fH19KWApLnRlc3QocGFnZUNvbnRlbnQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGFnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW11cbiAgICAgICAgICAgICkuc29ydCgoYSwgYikgPT4gYS50b0xvd2VyQ2FzZSgpLmxvY2FsZUNvbXBhcmUoYi50b0xvd2VyQ2FzZSgpKSk7XG4gICAgICAgICAgICBvbGRSZWRpcmVjdFRhZ0RhdGEgPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgICAgICAgICAgICAgb2xkUmVkaXJlY3RUYWdzXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoKHRhZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBuZXcgUmVnRXhwKGB7e1xcXFxzKig/OiR7W3RhZywgLi4ucmVkaXJlY3RUZW1wbGF0ZXNbdGFnXV0ubWFwKCh0YWcpID0+IGBbJHt0YWdbMF0udG9Mb3dlckNhc2UoKX0ke3RhZ1swXX1dJHt0YWcuc2xpY2UoMSl9YCkuam9pbignfCcpfSlcXFxcfD8oLio/KVxcXFxzKn19YCkuZXhlYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2ggPyBbdGFnLCBtYXRjaFsxXV0gOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pIGFzIFtzdHJpbmcsIHN0cmluZ11bXSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBvbGRTdHJheVRleHQgPSBbXG4gICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7c2hvcnQgZGVzY3JpcHRpb25cXHwuKj99fS9pKT8uWzBdLFxuICAgICAgICAgICAgICAgIHBhZ2VDb250ZW50Lm1hdGNoKC97e0RJU1BMQVlUSVRMRTouKj99fS8pPy5bMF0sXG4gICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7aXRhbGljIHRpdGxlXFx8Py4qP319L2kpPy5bMF0sXG4gICAgICAgICAgICAgICAgcGFnZUNvbnRlbnQubWF0Y2goL3t7REVGQVVMVFNPUlQ6Lio/fX0vKT8uWzBdLFxuICAgICAgICAgICAgICAgIC4uLihwYWdlQ29udGVudC5tYXRjaCgvXFxbXFxbW0NjXWF0ZWdvcnk6Lis/XV0vZykgPz8gW10pLFxuICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgICAgICAgICAuam9pbignXFxuJyk7XG5cbiAgICAgICAgICAgIGlmIChvbGRSZWRpcmVjdFRhcmdldCkgcmVkaXJlY3RJbnB1dC5zZXRWYWx1ZShvbGRSZWRpcmVjdFRhcmdldC5yZXBsYWNlQWxsKCdfJywgJyAnKSk7XG4gICAgICAgICAgICBlbHNlIG13Lm5vdGlmeSgnQ291bGQgbm90IGZpbmQgcmVkaXJlY3QgdGFyZ2V0IScsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgIHRhZ1NlbGVjdC5zZXRWYWx1ZShvbGRSZWRpcmVjdFRhZ3MpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG4iXSwKICAibWFwcGluZ3MiOiAiO0FBMEJBLEdBQUcsT0FBTyxNQUFNLENBQUMsa0JBQWtCLGdCQUFnQixtQkFBbUIsZ0NBQWdDLG1DQUFtQyxHQUFHLFlBQVk7QUFDcEosTUFBSSxHQUFHLE9BQU8sSUFBSSxtQkFBbUIsSUFBSTtBQUFHO0FBQzVDLE1BQUksQ0FBQyxHQUFHLE9BQU8sSUFBSSxzQkFBc0I7QUFBRztBQUM1QyxNQUFJLEdBQUcsT0FBTyxJQUFJLFVBQVUsTUFBTSxVQUFVLENBQUMsR0FBRyxPQUFPLElBQUksYUFBYTtBQUFHO0FBQzNFLE1BQUksR0FBRyxLQUFLLGNBQWMsT0FBTyxLQUFLLEdBQUcsT0FBTyxJQUFJLGFBQWE7QUFBRztBQUVwRSxRQUFNLGNBQWMsU0FBUyxjQUFjLGtCQUFrQjtBQUU3RCxNQUFJLENBQUM7QUFBYSxXQUFPLEdBQUcsT0FBTyx3Q0FBd0MsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUU1RixRQUFNLG9CQUFvQixLQUFLO0FBQUEsS0FFdEIsTUFBTSxJQUFJLEdBQUcsSUFBSSxFQUFFLElBQUk7QUFBQSxNQUNwQixRQUFRO0FBQUEsTUFDUixlQUFlO0FBQUEsTUFDZixNQUFNO0FBQUEsTUFDTixRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsTUFDVCxRQUFRO0FBQUEsSUFDWixDQUFDLEdBQ0gsTUFBTSxRQUFRLENBQUMsR0FBRyxZQUFZLENBQUMsR0FBRyxPQUFPLE1BQU0sV0FBVztBQUFBLEVBQ2hFO0FBRUEsUUFBTSxZQUFZLEdBQUcsT0FBTyxJQUFJLFlBQVk7QUFDNUMsUUFBTSxrQkFBa0IsR0FBRyxNQUFNLFlB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
