"use strict";
mw.loader.using(["mediawiki.util"], () => {
  if (mw.config.get("wgUserName") !== "Eejit43" || mw.config.get("wgPageName") !== "User:Eejit43")
    return;
  const repoOwner = "Eejit43";
  const repoName = "wikipedia-scripts";
  const link = mw.util.addPortletLink(mw.config.get("skin") === "minerva" ? "p-tb" : "p-cactions", "#", "Sync user scripts from GitHub", "sync-scripts");
  link.addEventListener("click", async (event) => {
    event.preventDefault();
    const latestCommitHash = (await (await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/commits`)).json())[0].sha;
    const scriptData = await (await fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/${latestCommitHash}/scripts.json`)).json();
    mw.notify("Syncing scripts...", { autoHide: false, tag: "sync-scripts-notification" });
    await Promise.all(
      scriptData.map(async (script) => {
        const subpageName = `User:Eejit43/scripts/${script.name}`;
        const subpageTalkName = `User talk:Eejit43/scripts/${script.name}`;
        const scriptName = `${subpageName}.js`;
        const styleName = `${subpageName}.css`;
        const fullSubpageInfo = [
          "{{User:Eejit43/script-documentation",
          //
          script["use-instead"] ? `| use-instead       = [[User:Eejit43/scripts/${script["use-instead"]}|${script["use-instead"]}]]` : null,
          script["image-size"] ? `| image-size        = ${script["image-size"]}` : null,
          script["image-caption"] ? `| image-caption     = ${script["image-caption"]}` : null,
          script["other-authors"] ? `| other-authors     = ${script["other-authors"].map((author) => `[[User:${author}|${author}]]`).join(", ")}` : null,
          `| description-short = ${script["short-description"]}`,
          `| description       = ${script.description}`,
          `| skin-support      = {{User:Eejit43/skin-support|${Object.entries(script["skin-support"]).map(([skin, status]) => `${skin}=${status}`).join("|")}}}`,
          `| released          = {{start date and age|${script.released}}}`,
          `| updated           = {{start date and age|${script.updated}}}`,
          "}}"
        ].filter(Boolean);
        const scriptContent = await (await fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/${latestCommitHash}/dist/scripts/${script.name}.js`)).text().catch((error) => {
          console.error(error);
          return null;
        });
        const styleContent = script.css ? await (await fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/${latestCommitHash}/dist/styles/${script.name}.css`)).text().catch((error) => {
          console.error(error);
          return null;
        }) : null;
        if (!scriptContent || script.css && !styleContent)
          return mw.notify(`Error syncing "${script.name}" from GitHub, skipping...`, { type: "error" });
        if (!script.personal) {
          await editOrCreate(subpageName, fullSubpageInfo.join("\n"), "Syncing script documentation from GitHub");
          await editOrCreate(subpageTalkName, "#REDIRECT [[User talk:Eejit43]]", "Redirecting script documentation talk page to main user talk page");
        }
        await editOrCreate(
          scriptName,
          `// <nowiki>
// Note: This script was compiled from TypeScript. For a more readable version, see https://github.com/${repoOwner}/${repoName}/blob/main/scripts/${script.name}.ts

${scriptContent}
// </nowiki>`,
          "Syncing script from GitHub"
        );
        if (script.css && styleContent)
          await editOrCreate(
            styleName,
            `/* <nowiki> */
/* Note: This script was compiled from modern CSS. For a more readable version, see https://github.com/${repoOwner}/${repoName}/blob/main/styles/${script.name}.css */

${styleContent}
/* </nowiki> */`,
            "Syncing styles from GitHub"
          );
      })
    );
    await editOrCreate(
      "User:Eejit43/scripts-info",
      [
        mapScripts(scriptData.filter((script) => !script.personal && !script.fork)),
        //
        "",
        "=== Personal-use scripts ===",
        mapScripts(scriptData.filter((script) => script.personal)),
        "",
        "=== Forks ===",
        mapScripts(scriptData.filter((script) => script.fork))
      ].join("\n"),
      "Syncing script list from GitHub"
    );
    mw.notify(`Synced ${scriptData.length} scripts from GitHub!`, { type: "success", tag: "sync-scripts-notification" });
    function mapScripts(scripts) {
      return scripts.map(
        (script) => `* [[User:Eejit43/scripts/${script.name}${script.personal ? ".js" : ""}|${script.name}]] - ${script["short-description"] || script.description}${script["use-instead"] ? ' (<span style="color: #bd2828">deprecated</span>)' : ""}`
      ).join("\n");
    }
    async function editOrCreate(title, text, summary) {
      summary += " (via [[User:Eejit43/scripts/script-updater.js|script]])";
      await new mw.Api().edit(title, () => ({ text, summary, watchlist: "watch" })).catch(async (errorCode, errorInfo) => {
        if (errorCode === "nocreate-missing")
          await new mw.Api().create(title, { summary, watchlist: "watch" }, text).catch((errorCode2, errorInfo2) => {
            mw.notify(`Error creating ${title}: ${errorInfo2?.error.info ?? "Unknown error"} (${errorCode2})`, { type: "error" });
            return;
          });
        else {
          mw.notify(`Error editing or creating ${title}: ${errorInfo?.error.info ?? "Unknown error"} (${errorCode})`, { type: "error" });
          return;
        }
      });
    }
  });
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc2NyaXB0cy9zY3JpcHQtdXBkYXRlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTWVkaWFXaWtpRGF0YUVycm9yIH0gZnJvbSAnLi4vZ2xvYmFsLXR5cGVzJztcblxuaW50ZXJmYWNlIFNjcmlwdCB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgICd1c2UtaW5zdGVhZCc/OiBzdHJpbmc7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uXG4gICAgJ2ltYWdlLXNpemUnPzogc3RyaW5nOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxuICAgICdpbWFnZS1jYXB0aW9uJz86IHN0cmluZzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbmFtaW5nLWNvbnZlbnRpb25cbiAgICAnc2hvcnQtZGVzY3JpcHRpb24nOiBzdHJpbmc7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICAnb3RoZXItYXV0aG9ycyc/OiBzdHJpbmdbXTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbmFtaW5nLWNvbnZlbnRpb25cbiAgICBmb3JrPzogdHJ1ZTtcbiAgICBwZXJzb25hbD86IHRydWU7XG4gICAgJ3NraW4tc3VwcG9ydCc6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxuICAgIHJlbGVhc2VkOiBzdHJpbmc7XG4gICAgdXBkYXRlZDogc3RyaW5nO1xuICAgIGNzcz86IHRydWU7XG59XG5cbm13LmxvYWRlci51c2luZyhbJ21lZGlhd2lraS51dGlsJ10sICgpID0+IHtcbiAgICBpZiAobXcuY29uZmlnLmdldCgnd2dVc2VyTmFtZScpICE9PSAnRWVqaXQ0MycgfHwgbXcuY29uZmlnLmdldCgnd2dQYWdlTmFtZScpICE9PSAnVXNlcjpFZWppdDQzJykgcmV0dXJuO1xuXG4gICAgY29uc3QgcmVwb093bmVyID0gJ0Vlaml0NDMnO1xuICAgIGNvbnN0IHJlcG9OYW1lID0gJ3dpa2lwZWRpYS1zY3JpcHRzJztcblxuICAgIGNvbnN0IGxpbmsgPSBtdy51dGlsLmFkZFBvcnRsZXRMaW5rKG13LmNvbmZpZy5nZXQoJ3NraW4nKSA9PT0gJ21pbmVydmEnID8gJ3AtdGInIDogJ3AtY2FjdGlvbnMnLCAnIycsICdTeW5jIHVzZXIgc2NyaXB0cyBmcm9tIEdpdEh1YicsICdzeW5jLXNjcmlwdHMnKTtcblxuICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBjb25zdCBsYXRlc3RDb21taXRIYXNoID0gKChhd2FpdCAoYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvJHtyZXBvT3duZXJ9LyR7cmVwb05hbWV9L2NvbW1pdHNgKSkuanNvbigpKSBhcyB7IHNoYTogc3RyaW5nIH1bXSlbMF0uc2hhO1xuXG4gICAgICAgIGNvbnN0IHNjcmlwdERhdGEgPSAoYXdhaXQgKGF3YWl0IGZldGNoKGBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vJHtyZXBvT3duZXJ9LyR7cmVwb05hbWV9LyR7bGF0ZXN0Q29tbWl0SGFzaH0vc2NyaXB0cy5qc29uYCkpLmpzb24oKSkgYXMgU2NyaXB0W107XG5cbiAgICAgICAgbXcubm90aWZ5KCdTeW5jaW5nIHNjcmlwdHMuLi4nLCB7IGF1dG9IaWRlOiBmYWxzZSwgdGFnOiAnc3luYy1zY3JpcHRzLW5vdGlmaWNhdGlvbicgfSk7XG5cbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBzY3JpcHREYXRhLm1hcChhc3luYyAoc2NyaXB0KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3VicGFnZU5hbWUgPSBgVXNlcjpFZWppdDQzL3NjcmlwdHMvJHtzY3JpcHQubmFtZX1gO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN1YnBhZ2VUYWxrTmFtZSA9IGBVc2VyIHRhbGs6RWVqaXQ0My9zY3JpcHRzLyR7c2NyaXB0Lm5hbWV9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBzY3JpcHROYW1lID0gYCR7c3VicGFnZU5hbWV9LmpzYDtcbiAgICAgICAgICAgICAgICBjb25zdCBzdHlsZU5hbWUgPSBgJHtzdWJwYWdlTmFtZX0uY3NzYDtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGZ1bGxTdWJwYWdlSW5mbyA9IFtcbiAgICAgICAgICAgICAgICAgICAgJ3t7VXNlcjpFZWppdDQzL3NjcmlwdC1kb2N1bWVudGF0aW9uJywgLy9cbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0Wyd1c2UtaW5zdGVhZCddID8gYHwgdXNlLWluc3RlYWQgICAgICAgPSBbW1VzZXI6RWVqaXQ0My9zY3JpcHRzLyR7c2NyaXB0Wyd1c2UtaW5zdGVhZCddfXwke3NjcmlwdFsndXNlLWluc3RlYWQnXX1dXWAgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBzY3JpcHRbJ2ltYWdlLXNpemUnXSA/IGB8IGltYWdlLXNpemUgICAgICAgID0gJHtzY3JpcHRbJ2ltYWdlLXNpemUnXX1gIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0WydpbWFnZS1jYXB0aW9uJ10gPyBgfCBpbWFnZS1jYXB0aW9uICAgICA9ICR7c2NyaXB0WydpbWFnZS1jYXB0aW9uJ119YCA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHNjcmlwdFsnb3RoZXItYXV0aG9ycyddID8gYHwgb3RoZXItYXV0aG9ycyAgICAgPSAke3NjcmlwdFsnb3RoZXItYXV0aG9ycyddLm1hcCgoYXV0aG9yKSA9PiBgW1tVc2VyOiR7YXV0aG9yfXwke2F1dGhvcn1dXWApLmpvaW4oJywgJyl9YCA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGB8IGRlc2NyaXB0aW9uLXNob3J0ID0gJHtzY3JpcHRbJ3Nob3J0LWRlc2NyaXB0aW9uJ119YCxcbiAgICAgICAgICAgICAgICAgICAgYHwgZGVzY3JpcHRpb24gICAgICAgPSAke3NjcmlwdC5kZXNjcmlwdGlvbn1gLFxuICAgICAgICAgICAgICAgICAgICBgfCBza2luLXN1cHBvcnQgICAgICA9IHt7VXNlcjpFZWppdDQzL3NraW4tc3VwcG9ydHwke09iamVjdC5lbnRyaWVzKHNjcmlwdFsnc2tpbi1zdXBwb3J0J10pXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKChbc2tpbiwgc3RhdHVzXSkgPT4gYCR7c2tpbn09JHtzdGF0dXN9YClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCd8Jyl9fX1gLFxuICAgICAgICAgICAgICAgICAgICBgfCByZWxlYXNlZCAgICAgICAgICA9IHt7c3RhcnQgZGF0ZSBhbmQgYWdlfCR7c2NyaXB0LnJlbGVhc2VkfX19YCxcbiAgICAgICAgICAgICAgICAgICAgYHwgdXBkYXRlZCAgICAgICAgICAgPSB7e3N0YXJ0IGRhdGUgYW5kIGFnZXwke3NjcmlwdC51cGRhdGVkfX19YCxcbiAgICAgICAgICAgICAgICAgICAgJ319JyxcbiAgICAgICAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBhd2FpdCAoYXdhaXQgZmV0Y2goYGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS8ke3JlcG9Pd25lcn0vJHtyZXBvTmFtZX0vJHtsYXRlc3RDb21taXRIYXNofS9kaXN0L3NjcmlwdHMvJHtzY3JpcHQubmFtZX0uanNgKSkudGV4dCgpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBzdHlsZUNvbnRlbnQgPSBzY3JpcHQuY3NzXG4gICAgICAgICAgICAgICAgICAgID8gYXdhaXQgKGF3YWl0IGZldGNoKGBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vJHtyZXBvT3duZXJ9LyR7cmVwb05hbWV9LyR7bGF0ZXN0Q29tbWl0SGFzaH0vZGlzdC9zdHlsZXMvJHtzY3JpcHQubmFtZX0uY3NzYCkpLnRleHQoKS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmICghc2NyaXB0Q29udGVudCB8fCAoc2NyaXB0LmNzcyAmJiAhc3R5bGVDb250ZW50KSkgcmV0dXJuIG13Lm5vdGlmeShgRXJyb3Igc3luY2luZyBcIiR7c2NyaXB0Lm5hbWV9XCIgZnJvbSBHaXRIdWIsIHNraXBwaW5nLi4uYCwgeyB0eXBlOiAnZXJyb3InIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFzY3JpcHQucGVyc29uYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZWRpdE9yQ3JlYXRlKHN1YnBhZ2VOYW1lLCBmdWxsU3VicGFnZUluZm8uam9pbignXFxuJyksICdTeW5jaW5nIHNjcmlwdCBkb2N1bWVudGF0aW9uIGZyb20gR2l0SHViJyk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGVkaXRPckNyZWF0ZShzdWJwYWdlVGFsa05hbWUsICcjUkVESVJFQ1QgW1tVc2VyIHRhbGs6RWVqaXQ0M11dJywgJ1JlZGlyZWN0aW5nIHNjcmlwdCBkb2N1bWVudGF0aW9uIHRhbGsgcGFnZSB0byBtYWluIHVzZXIgdGFsayBwYWdlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF3YWl0IGVkaXRPckNyZWF0ZShcbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYC8vIDxub3dpa2k+XFxuLy8gTm90ZTogVGhpcyBzY3JpcHQgd2FzIGNvbXBpbGVkIGZyb20gVHlwZVNjcmlwdC4gRm9yIGEgbW9yZSByZWFkYWJsZSB2ZXJzaW9uLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tLyR7cmVwb093bmVyfS8ke3JlcG9OYW1lfS9ibG9iL21haW4vc2NyaXB0cy8ke3NjcmlwdC5uYW1lfS50c1xcblxcbiR7c2NyaXB0Q29udGVudH1cXG4vLyA8L25vd2lraT5gLFxuICAgICAgICAgICAgICAgICAgICAnU3luY2luZyBzY3JpcHQgZnJvbSBHaXRIdWInLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKHNjcmlwdC5jc3MgJiYgc3R5bGVDb250ZW50KVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBlZGl0T3JDcmVhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBgLyogPG5vd2lraT4gKi9cXG4vKiBOb3RlOiBUaGlzIHNjcmlwdCB3YXMgY29tcGlsZWQgZnJvbSBtb2Rlcm4gQ1NTLiBGb3IgYSBtb3JlIHJlYWRhYmxlIHZlcnNpb24sIHNlZSBodHRwczovL2dpdGh1Yi5jb20vJHtyZXBvT3duZXJ9LyR7cmVwb05hbWV9L2Jsb2IvbWFpbi9zdHlsZXMvJHtzY3JpcHQubmFtZX0uY3NzICovXFxuXFxuJHtzdHlsZUNvbnRlbnR9XFxuLyogPC9ub3dpa2k+ICovYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdTeW5jaW5nIHN0eWxlcyBmcm9tIEdpdEh1YicsXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgKTtcblxuICAgICAgICBhd2FpdCBlZGl0T3JDcmVhdGUoXG4gICAgICAgICAgICAnVXNlcjpFZWppdDQzL3NjcmlwdHMtaW5mbycsXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgbWFwU2NyaXB0cyhzY3JpcHREYXRhLmZpbHRlcigoc2NyaXB0KSA9PiAhc2NyaXB0LnBlcnNvbmFsICYmICFzY3JpcHQuZm9yaykpLCAvL1xuICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICc9PT0gUGVyc29uYWwtdXNlIHNjcmlwdHMgPT09JyxcbiAgICAgICAgICAgICAgICBtYXBTY3JpcHRzKHNjcmlwdERhdGEuZmlsdGVyKChzY3JpcHQpID0+IHNjcmlwdC5wZXJzb25hbCkpLFxuICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICc9PT0gRm9ya3MgPT09JyxcbiAgICAgICAgICAgICAgICBtYXBTY3JpcHRzKHNjcmlwdERhdGEuZmlsdGVyKChzY3JpcHQpID0+IHNjcmlwdC5mb3JrKSksXG4gICAgICAgICAgICBdLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgJ1N5bmNpbmcgc2NyaXB0IGxpc3QgZnJvbSBHaXRIdWInLFxuICAgICAgICApO1xuXG4gICAgICAgIG13Lm5vdGlmeShgU3luY2VkICR7c2NyaXB0RGF0YS5sZW5ndGh9IHNjcmlwdHMgZnJvbSBHaXRIdWIhYCwgeyB0eXBlOiAnc3VjY2VzcycsIHRhZzogJ3N5bmMtc2NyaXB0cy1ub3RpZmljYXRpb24nIH0pO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXBzIHNjcmlwdHMgdG8gYSBidWxsZXRlZCBsaXN0LlxuICAgICAgICAgKiBAcGFyYW0gc2NyaXB0cyBUaGUgc2NyaXB0cyB0byBtYXAuXG4gICAgICAgICAqIEByZXR1cm5zIFRoZSBtYXBwZWQgc2NyaXB0cy5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1hcFNjcmlwdHMoc2NyaXB0czogU2NyaXB0W10pIHtcbiAgICAgICAgICAgIHJldHVybiBzY3JpcHRzXG4gICAgICAgICAgICAgICAgLm1hcChcbiAgICAgICAgICAgICAgICAgICAgKHNjcmlwdCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGAqIFtbVXNlcjpFZWppdDQzL3NjcmlwdHMvJHtzY3JpcHQubmFtZX0ke3NjcmlwdC5wZXJzb25hbCA/ICcuanMnIDogJyd9fCR7c2NyaXB0Lm5hbWV9XV0gLSAke3NjcmlwdFsnc2hvcnQtZGVzY3JpcHRpb24nXSB8fCBzY3JpcHQuZGVzY3JpcHRpb259JHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRbJ3VzZS1pbnN0ZWFkJ10gPyAnICg8c3BhbiBzdHlsZT1cImNvbG9yOiAjYmQyODI4XCI+ZGVwcmVjYXRlZDwvc3Bhbj4pJyA6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9YCxcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLmpvaW4oJ1xcbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEVkaXRzIGEgcGFnZSwgb3IgY3JlYXRlcyBpdCBpZiBpdCBkb2Vzbid0IGV4aXN0LlxuICAgICAgICAgKiBAcGFyYW0gdGl0bGUgVGhlIHRpdGxlIG9mIHRoZSBwYWdlIHRvIGVkaXQuXG4gICAgICAgICAqIEBwYXJhbSB0ZXh0IFRoZSBwYWdlIGNvbnRlbnQgdG8gc2V0LlxuICAgICAgICAgKiBAcGFyYW0gc3VtbWFyeSBUaGUgZWRpdCBzdW1tYXJ5ICh3aWxsIGFwcGVuZCBzY3JpcHQgbm90aWNlKS5cbiAgICAgICAgICovXG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uIGVkaXRPckNyZWF0ZSh0aXRsZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcsIHN1bW1hcnk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAgICAgc3VtbWFyeSArPSAnICh2aWEgW1tVc2VyOkVlaml0NDMvc2NyaXB0cy9zY3JpcHQtdXBkYXRlci5qc3xzY3JpcHRdXSknO1xuICAgICAgICAgICAgYXdhaXQgbmV3IG13LkFwaSgpXG4gICAgICAgICAgICAgICAgLmVkaXQodGl0bGUsICgpID0+ICh7IHRleHQsIHN1bW1hcnksIHdhdGNobGlzdDogJ3dhdGNoJyB9KSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goYXN5bmMgKGVycm9yQ29kZTogc3RyaW5nLCBlcnJvckluZm86IE1lZGlhV2lraURhdGFFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3JDb2RlID09PSAnbm9jcmVhdGUtbWlzc2luZycpXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgbXcuQXBpKCkuY3JlYXRlKHRpdGxlLCB7IHN1bW1hcnksIHdhdGNobGlzdDogJ3dhdGNoJyB9LCB0ZXh0KS5jYXRjaCgoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9ySW5mbzogTWVkaWFXaWtpRGF0YUVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KGBFcnJvciBjcmVhdGluZyAke3RpdGxlfTogJHtlcnJvckluZm8/LmVycm9yLmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsIHsgdHlwZTogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoYEVycm9yIGVkaXRpbmcgb3IgY3JlYXRpbmcgJHt0aXRsZX06ICR7ZXJyb3JJbmZvPy5lcnJvci5pbmZvID8/ICdVbmtub3duIGVycm9yJ30gKCR7ZXJyb3JDb2RlfSlgLCB7IHR5cGU6ICdlcnJvcicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1c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
