// <nowiki>
// Note: This script was compiled and minified from TypeScript. For a more readable version, see https://github.com/Eejit43/wikipedia-scripts/blob/main/scripts/to-monitor-list.ts

"use strict";(()=>{var n=class{api=new mw.Api;link;toCheck;totalToCheck;isRunning=!1;handledRequests=0;load(){mw.util.addCSS(`
.to-monitor-list-count {
    cursor: pointer;
}`);let i=document.querySelector(".mw-editsection").cloneNode(!0);this.link=document.createElement("a"),this.link.href="#",this.link.style.fontWeight="bold",this.link.textContent="Add missing counts",this.link.addEventListener("click",async r=>{if(r.preventDefault(),!this.isRunning){this.isRunning=!0;for(let e of document.querySelectorAll(".to-monitor-list-count"))e.id&&(e.innerHTML='<span style="color: #ed8e07; font-weight: bold">?</span>');await this.loadToCheckData();for(let e of this.toCheck.categories)this.handleCheck(e,async()=>{let t=await this.api.get({action:"query",list:"search",srinfo:"totalhits",srnamespace:this.getCategory(e),srsearch:`incategory:"${e.category}"`}).catch((s,a)=>(mw.notify(`An error occurred while trying to get category members: ${a?.error?.info??"Unknown error"} (${s})`,{type:"error"}),null));if(t)return t.query.searchinfo.totalhits});for(let e of this.toCheck.searches)this.handleCheck(e,async()=>{let t=await this.api.get({action:"query",list:"search",srinfo:"totalhits",srnamespace:this.getCategory(e),srsearch:e.search}).catch((s,a)=>(mw.notify(`An error occurred while trying to get search results: ${a?.error?.info??"Unknown error"} (${s})`,{type:"error"}),null));if(t)return t.query.searchinfo.totalhits});for(let e of this.toCheck.whatLinksHere)this.handleCheck(e,async()=>{let t=await this.api.get({action:"query",list:"backlinks",bllimit:500,blnamespace:this.getCategory(e),bltitle:e.title}).catch((s,a)=>(mw.notify(`An error occurred while trying to get backlinks: ${a?.error?.info??"Unknown error"} (${s})`,{type:"error"}),null));if(t)return t.query.backlinks.length});for(let e of this.toCheck.transclusions)this.handleCheck(e,async()=>{let t=await this.api.get({action:"query",list:"embeddedin",eilimit:500,einamespace:this.getCategory(e),eititle:e.title}).catch((s,a)=>(mw.notify(`An error occurred while trying to get transclusions: ${a?.error?.info??"Unknown error"} (${s})`,{type:"error"}),null));if(t)return t.query.embeddedin.length})}}),i.querySelector("a").replaceWith(this.link),document.querySelector("h2#Stuff_to_monitor + .mw-editsection").after(i);for(let r of document.querySelectorAll(".to-monitor-list-count"))r.addEventListener("click",()=>{r.innerHTML='<span style="color: #00733f">None</span>'})}async loadToCheckData(){this.toCheck=JSON.parse((await this.api.get({action:"query",formatversion:"2",prop:"revisions",rvprop:"content",rvslots:"main",titles:"User:Eejit43/scripts/to-monitor-list.json"})).query.pages[0].revisions[0].slots.main.content),this.totalToCheck=Object.values(this.toCheck).flat().length}async handleCheck(i,r){let e=await r();if(e===void 0)return;let t=document.querySelector(`#to-monitor-list-${i.id}`);if(!t)return mw.notify(`Failed to find element for ID "${i.id}"`);t.innerHTML=e===0?'<span style="color: #00733f">None</span>':`<b><span style="color: #bd2828">${e===500?"500+":e}</span></b>`,this.handledRequests++,this.link.textContent=`Add missing counts (${this.handledRequests}/${this.totalToCheck} loaded)`,this.handledRequests===this.totalToCheck&&setTimeout(()=>{this.isRunning=!1,this.handledRequests=0,this.link.textContent="Add missing counts"},1e3)}getCategory({namespace:i,notNamespace:r}){if(!i&&!r)return 0;if(i){let e=Object.entries(mw.config.get("wgFormattedNamespaces")).find(([,t])=>t===i);return e?Number.parseInt(e[0]):0}else return Object.entries(mw.config.get("wgFormattedNamespaces")).filter(([,e])=>r!==(e||"Article")).map(([e])=>Number.parseInt(e))}};mw.loader.using(["mediawiki.util"],()=>{mw.config.get("wgPageName")==="User:Eejit43"&&new n().load()});})();

// </nowiki>
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc2NyaXB0cy90by1tb25pdG9yLWxpc3QudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB0eXBlIHsgQXBpUXVlcnlCYWNrbGlua3NQYXJhbXMsIEFwaVF1ZXJ5UmV2aXNpb25zUGFyYW1zLCBBcGlRdWVyeVNlYXJjaFBhcmFtcyB9IGZyb20gJ3R5cGVzLW1lZGlhd2lraS9hcGlfcGFyYW1zJztcbmltcG9ydCB0eXBlIHsgQmFja2xpbmtzUmVzdWx0LCBFbWJlZGRlZGluUmVzdWx0LCBNZWRpYVdpa2lEYXRhRXJyb3IsIFBhZ2VSZXZpc2lvbnNSZXN1bHQsIFNlYXJjaFJlc3VsdCB9IGZyb20gJy4uL2dsb2JhbC10eXBlcyc7XG5cbmludGVyZmFjZSBTZWFyY2hEYXRhIHtcbiAgICBjYXRlZ29yaWVzOiB7IGlkOiBzdHJpbmc7IGNhdGVnb3J5OiBzdHJpbmc7IG5hbWVzcGFjZT86IHN0cmluZzsgbm90TmFtZXNwYWNlPzogc3RyaW5nIH1bXTtcbiAgICBzZWFyY2hlczogeyBpZDogc3RyaW5nOyBzZWFyY2g6IHN0cmluZzsgbmFtZXNwYWNlPzogc3RyaW5nOyBub3ROYW1lc3BhY2U/OiBzdHJpbmcgfVtdO1xuICAgIHdoYXRMaW5rc0hlcmU6IHsgaWQ6IHN0cmluZzsgdGl0bGU6IHN0cmluZzsgbmFtZXNwYWNlPzogc3RyaW5nOyBub3ROYW1lc3BhY2U/OiBzdHJpbmcgfVtdO1xuICAgIHRyYW5zY2x1c2lvbnM6IHsgaWQ6IHN0cmluZzsgdGl0bGU6IHN0cmluZzsgbmFtZXNwYWNlPzogc3RyaW5nOyBub3ROYW1lc3BhY2U/OiBzdHJpbmcgfVtdO1xufVxuXG50eXBlIFNlYXJjaERhdGFDaGVjayA9XG4gICAgfCBTZWFyY2hEYXRhWydjYXRlZ29yaWVzJ11bMF1cbiAgICB8IFNlYXJjaERhdGFbJ3NlYXJjaGVzJ11bMF1cbiAgICB8IFNlYXJjaERhdGFbJ3doYXRMaW5rc0hlcmUnXVswXVxuICAgIHwgU2VhcmNoRGF0YVsndHJhbnNjbHVzaW9ucyddWzBdO1xuXG4vKipcbiAqIEFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MgaGFuZGxlcyB0aGUgZW50aXJlIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIHRvLW1vbml0b3ItbGlzdCBzY3JpcHQuXG4gKi9cbmNsYXNzIE1vbml0b3JpbmdMaXN0TWFuYWdlciB7XG4gICAgcHJpdmF0ZSBhcGkgPSBuZXcgbXcuQXBpKCk7XG5cbiAgICBwcml2YXRlIGxpbmshOiBIVE1MQW5jaG9yRWxlbWVudDtcblxuICAgIHByaXZhdGUgdG9DaGVjayE6IFNlYXJjaERhdGE7XG4gICAgcHJpdmF0ZSB0b3RhbFRvQ2hlY2shOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIGlzUnVubmluZyA9IGZhbHNlO1xuXG4gICAgcHJpdmF0ZSBoYW5kbGVkUmVxdWVzdHMgPSAwO1xuXG4gICAgLyoqXG4gICAgICogTG9hZHMgdGhlIFwiQWRkIG1pc3NpbmcgY291bnRzXCIgbGluayBlbGVtZW50LlxuICAgICAqL1xuICAgIHB1YmxpYyBsb2FkKCkge1xuICAgICAgICBtdy51dGlsLmFkZENTUyhgXG4udG8tbW9uaXRvci1saXN0LWNvdW50IHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG59YCk7XG5cbiAgICAgICAgY29uc3QgZnVsbExpbmtFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm13LWVkaXRzZWN0aW9uJykhLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MU3BhbkVsZW1lbnQ7XG5cbiAgICAgICAgdGhpcy5saW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICB0aGlzLmxpbmsuaHJlZiA9ICcjJztcbiAgICAgICAgdGhpcy5saW5rLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XG4gICAgICAgIHRoaXMubGluay50ZXh0Q29udGVudCA9ICdBZGQgbWlzc2luZyBjb3VudHMnO1xuICAgICAgICB0aGlzLmxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvLW1vbml0b3ItbGlzdC1jb3VudCcpKVxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmlkKSBlbGVtZW50LmlubmVySFRNTCA9ICc8c3BhbiBzdHlsZT1cImNvbG9yOiAjZWQ4ZTA3OyBmb250LXdlaWdodDogYm9sZFwiPj88L3NwYW4+JztcblxuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkVG9DaGVja0RhdGEoKTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBjaGVjayBvZiB0aGlzLnRvQ2hlY2suY2F0ZWdvcmllcylcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMuaGFuZGxlQ2hlY2soY2hlY2ssIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IChhd2FpdCB0aGlzLmFwaVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdzZWFyY2gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyaW5mbzogJ3RvdGFsaGl0cycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JuYW1lc3BhY2U6IHRoaXMuZ2V0Q2F0ZWdvcnkoY2hlY2spLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyc2VhcmNoOiBgaW5jYXRlZ29yeTpcIiR7Y2hlY2suY2F0ZWdvcnl9XCJgLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBzYXRpc2ZpZXMgQXBpUXVlcnlTZWFyY2hQYXJhbXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yQ29kZSwgZXJyb3JJbmZvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXcubm90aWZ5KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGdldCBjYXRlZ29yeSBtZW1iZXJzOiAkeyhlcnJvckluZm8gYXMgTWVkaWFXaWtpRGF0YUVycm9yKT8uZXJyb3I/LmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdHlwZTogJ2Vycm9yJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSkgYXMgU2VhcmNoUmVzdWx0IHwgbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEucXVlcnkhLnNlYXJjaGluZm8udG90YWxoaXRzO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNoZWNrIG9mIHRoaXMudG9DaGVjay5zZWFyY2hlcylcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMuaGFuZGxlQ2hlY2soY2hlY2ssIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IChhd2FpdCB0aGlzLmFwaVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncXVlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdzZWFyY2gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyaW5mbzogJ3RvdGFsaGl0cycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JuYW1lc3BhY2U6IHRoaXMuZ2V0Q2F0ZWdvcnkoY2hlY2spLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyc2VhcmNoOiBjaGVjay5zZWFyY2gsXG4gICAgICAgICAgICAgICAgICAgICAgICB9IHNhdGlzZmllcyBBcGlRdWVyeVNlYXJjaFBhcmFtcylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3JDb2RlLCBlcnJvckluZm8pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdy5ub3RpZnkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gZ2V0IHNlYXJjaCByZXN1bHRzOiAkeyhlcnJvckluZm8gYXMgTWVkaWFXaWtpRGF0YUVycm9yKT8uZXJyb3I/LmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdHlwZTogJ2Vycm9yJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSkgYXMgU2VhcmNoUmVzdWx0IHwgbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEucXVlcnkhLnNlYXJjaGluZm8udG90YWxoaXRzO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNoZWNrIG9mIHRoaXMudG9DaGVjay53aGF0TGlua3NIZXJlKVxuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5oYW5kbGVDaGVjayhjaGVjaywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gKGF3YWl0IHRoaXMuYXBpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdxdWVyeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDogJ2JhY2tsaW5rcycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxsaW1pdDogNTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsbmFtZXNwYWNlOiB0aGlzLmdldENhdGVnb3J5KGNoZWNrKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibHRpdGxlOiBjaGVjay50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gc2F0aXNmaWVzIEFwaVF1ZXJ5QmFja2xpbmtzUGFyYW1zKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvckNvZGUsIGVycm9ySW5mbykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYEFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBnZXQgYmFja2xpbmtzOiAkeyhlcnJvckluZm8gYXMgTWVkaWFXaWtpRGF0YUVycm9yKT8uZXJyb3I/LmluZm8gPz8gJ1Vua25vd24gZXJyb3InfSAoJHtlcnJvckNvZGV9KWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdHlwZTogJ2Vycm9yJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSkgYXMgQmFja2xpbmtzUmVzdWx0IHwgbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEucXVlcnkhLmJhY2tsaW5rcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hlY2sgb2YgdGhpcy50b0NoZWNrLnRyYW5zY2x1c2lvbnMpXG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLmhhbmRsZUNoZWNrKGNoZWNrLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSAoYXdhaXQgdGhpcy5hcGlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3F1ZXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0OiAnZW1iZWRkZWRpbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWlsaW1pdDogNTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVpbmFtZXNwYWNlOiB0aGlzLmdldENhdGVnb3J5KGNoZWNrKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlaXRpdGxlOiBjaGVjay50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gc2F0aXNmaWVzIEFwaVF1ZXJ5QmFja2xpbmtzUGFyYW1zKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvckNvZGUsIGVycm9ySW5mbykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG13Lm5vdGlmeShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYEFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBnZXQgdHJhbnNjbHVzaW9uczogJHsoZXJyb3JJbmZvIGFzIE1lZGlhV2lraURhdGFFcnJvcik/LmVycm9yPy5pbmZvID8/ICdVbmtub3duIGVycm9yJ30gKCR7ZXJyb3JDb2RlfSlgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHR5cGU6ICdlcnJvcicgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpIGFzIEVtYmVkZGVkaW5SZXN1bHQgfCBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEpIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5xdWVyeSEuZW1iZWRkZWRpbi5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bGxMaW5rRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdhJykhLnJlcGxhY2VXaXRoKHRoaXMubGluayk7XG5cbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaDIjU3R1ZmZfdG9fbW9uaXRvciArIC5tdy1lZGl0c2VjdGlvbicpIS5hZnRlcihmdWxsTGlua0VsZW1lbnQpO1xuXG4gICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG8tbW9uaXRvci1saXN0LWNvdW50JykpXG4gICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gJzxzcGFuIHN0eWxlPVwiY29sb3I6ICMwMDczM2ZcIj5Ob25lPC9zcGFuPic7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyB0aGUgZGF0YSBvZiBjaGVja3MgdG8gaGFuZGxlLlxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBsb2FkVG9DaGVja0RhdGEoKSB7XG4gICAgICAgIHRoaXMudG9DaGVjayA9IEpTT04ucGFyc2UoXG4gICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgKGF3YWl0IHRoaXMuYXBpLmdldCh7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3F1ZXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dmVyc2lvbjogJzInLFxuICAgICAgICAgICAgICAgICAgICBwcm9wOiAncmV2aXNpb25zJyxcbiAgICAgICAgICAgICAgICAgICAgcnZwcm9wOiAnY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIHJ2c2xvdHM6ICdtYWluJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVzOiAnVXNlcjpFZWppdDQzL3NjcmlwdHMvdG8tbW9uaXRvci1saXN0Lmpzb24nLFxuICAgICAgICAgICAgICAgIH0gc2F0aXNmaWVzIEFwaVF1ZXJ5UmV2aXNpb25zUGFyYW1zKSkgYXMgUGFnZVJldmlzaW9uc1Jlc3VsdFxuICAgICAgICAgICAgKS5xdWVyeSEucGFnZXNbMF0ucmV2aXNpb25zWzBdLnNsb3RzLm1haW4uY29udGVudCxcbiAgICAgICAgKSBhcyBTZWFyY2hEYXRhO1xuXG4gICAgICAgIHRoaXMudG90YWxUb0NoZWNrID0gT2JqZWN0LnZhbHVlcyh0aGlzLnRvQ2hlY2spLmZsYXQoKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlcyBhIGdpdmVuIGNoZWNrLlxuICAgICAqIEBwYXJhbSBjaGVjayBUaGUgY2hlY2sgZGF0YSB0byBoYW5kbGUuXG4gICAgICogQHBhcmFtIGhhbmRsZXIgVGhlIGhhbmRsZXIgdG8gZmluZCB0aGUgY291bnQgZnJvbSBhIGNoZWNrLlxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlQ2hlY2soY2hlY2s6IFNlYXJjaERhdGFDaGVjaywgaGFuZGxlcjogKCkgPT4gUHJvbWlzZTxudW1iZXIgfCB1bmRlZmluZWQ+KSB7XG4gICAgICAgIGNvbnN0IGNvdW50ID0gYXdhaXQgaGFuZGxlcigpO1xuICAgICAgICBpZiAoY291bnQgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjdG8tbW9uaXRvci1saXN0LSR7Y2hlY2suaWR9YCk7XG4gICAgICAgIGlmICghZWxlbWVudCkgcmV0dXJuIG13Lm5vdGlmeShgRmFpbGVkIHRvIGZpbmQgZWxlbWVudCBmb3IgSUQgXCIke2NoZWNrLmlkfVwiYCk7XG4gICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID1cbiAgICAgICAgICAgIGNvdW50ID09PSAwXG4gICAgICAgICAgICAgICAgPyAnPHNwYW4gc3R5bGU9XCJjb2xvcjogIzAwNzMzZlwiPk5vbmU8L3NwYW4+J1xuICAgICAgICAgICAgICAgIDogYDxiPjxzcGFuIHN0eWxlPVwiY29sb3I6ICNiZDI4MjhcIj4ke2NvdW50ID09PSA1MDAgPyAnNTAwKycgOiBjb3VudH08L3NwYW4+PC9iPmA7XG5cbiAgICAgICAgdGhpcy5oYW5kbGVkUmVxdWVzdHMrKztcbiAgICAgICAgdGhpcy5saW5rLnRleHRDb250ZW50ID0gYEFkZCBtaXNzaW5nIGNvdW50cyAoJHt0aGlzLmhhbmRsZWRSZXF1ZXN0c30vJHt0aGlzLnRvdGFsVG9DaGVja30gbG9hZGVkKWA7XG5cbiAgICAgICAgaWYgKHRoaXMuaGFuZGxlZFJlcXVlc3RzID09PSB0aGlzLnRvdGFsVG9DaGVjaylcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZWRSZXF1ZXN0cyA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5rLnRleHRDb250ZW50ID0gJ0FkZCBtaXNzaW5nIGNvdW50cyc7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgdGhlIHNlYXJjaGVkIGNhdGVnb3JpZXMgZnJvbSB0aGUgY2hlY2sgb2JqZWN0LlxuICAgICAqIEBwYXJhbSBjaGVjayBUaGUgY2hlY2sgb2JqZWN0LlxuICAgICAqIEBwYXJhbSBjaGVjay5uYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSB0byBzZWFyY2ggaW4uXG4gICAgICogQHBhcmFtIGNoZWNrLm5vdE5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIHRvIGV4Y2x1ZGUgZnJvbSB0aGUgc2VhcmNoLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYXRlZ29yeSBJRCBvciBsaXN0IG9mIGNhdGVnb3J5IElEcyAoc2VwYXJhdGVkIGJ5ICd8JykuXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRDYXRlZ29yeSh7IG5hbWVzcGFjZSwgbm90TmFtZXNwYWNlIH06IHsgbmFtZXNwYWNlPzogc3RyaW5nOyBub3ROYW1lc3BhY2U/OiBzdHJpbmcgfSkge1xuICAgICAgICBpZiAoIW5hbWVzcGFjZSAmJiAhbm90TmFtZXNwYWNlKSByZXR1cm4gMDtcbiAgICAgICAgZWxzZSBpZiAobmFtZXNwYWNlKSB7XG4gICAgICAgICAgICBjb25zdCBmb3VuZE5hbWVzcGFjZSA9IE9iamVjdC5lbnRyaWVzKG13LmNvbmZpZy5nZXQoJ3dnRm9ybWF0dGVkTmFtZXNwYWNlcycpKS5maW5kKFxuICAgICAgICAgICAgICAgIChbLCBuYW1lc3BhY2VOYW1lXSkgPT4gbmFtZXNwYWNlTmFtZSA9PT0gbmFtZXNwYWNlLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgcmV0dXJuIGZvdW5kTmFtZXNwYWNlID8gTnVtYmVyLnBhcnNlSW50KGZvdW5kTmFtZXNwYWNlWzBdKSA6IDA7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKG13LmNvbmZpZy5nZXQoJ3dnRm9ybWF0dGVkTmFtZXNwYWNlcycpKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoKFssIG5hbWVzcGFjZU5hbWVdKSA9PiBub3ROYW1lc3BhY2UgIT09IChuYW1lc3BhY2VOYW1lIHx8ICdBcnRpY2xlJykpXG4gICAgICAgICAgICAgICAgLm1hcCgoW25hbWVzcGFjZUlkXSkgPT4gTnVtYmVyLnBhcnNlSW50KG5hbWVzcGFjZUlkKSk7XG4gICAgfVxufVxuXG5tdy5sb2FkZXIudXNpbmcoWydtZWRpYXdpa2kudXRpbCddLCAoKSA9PiB7XG4gICAgaWYgKG13LmNvbmZpZy5nZXQoJ3dnUGFnZU5hbWUnKSA9PT0gJ1VzZXI6RWVqaXQ0MycpIG5ldyBNb25pdG9yaW5nTGlzdE1hbmFnZXIoKS5sb2FkKCk7XG59KTtcbiJdLAogICJtYXBwaW5ncyI6ICI7OzttQkFtQkEsSUFBTUEsRUFBTixLQUE0QixDQUNoQixJQUFNLElBQUksR0FBRyxJQUViLEtBRUEsUUFDQSxhQUVBLFVBQVksR0FFWixnQkFBa0IsRUFLbkIsTUFBTyxDQUNWLEdBQUcsS0FBSyxPQUFPO0FBQUE7QUFBQTtBQUFBLEVBR3JCLEVBRU0sSUFBTUMsRUFBa0IsU0FBUyxjQUFjLGlCQUFpQixFQUFHLFVBQVUsRUFBSSxFQUVqRixLQUFLLEtBQU8sU0FBUyxjQUFjLEdBQUcsRUFDdEMsS0FBSyxLQUFLLEtBQU8sSUFDakIsS0FBSyxLQUFLLE1BQU0sV0FBYSxPQUM3QixLQUFLLEtBQUssWUFBYyxxQkFDeEIsS0FBSyxLQUFLLGlCQUFpQixRQUFTLE1BQU9DLEdBQVUsQ0FHakQsR0FGQUEsRUFBTSxlQUFlLEVBRWpCLE1BQUssVUFDVCxNQUFLLFVBQVksR0FFakIsUUFBV0MsS0FBVyxTQUFTLGlCQUFpQix3QkFBd0IsRUFDaEVBLEVBQVEsS0FBSUEsRUFBUSxVQUFZLDREQUV4QyxNQUFNLEtBQUssZ0JBQWdCLEVBRTNCLFFBQVdDLEtBQVMsS0FBSyxRQUFRLFdBQ3hCLEtBQUssWUFBWUEsRUFBTyxTQUFZLENBQ3JDLElBQU1DLEVBQVEsTUFBTSxLQUFLLElBQ3BCLElBQUksQ0FDRCxPQUFRLFFBQ1IsS0FBTSxTQUNOLE9BQVEsWUFDUixZQUFhLEtBQUssWUFBWUQsQ0FBSyxFQUNuQyxTQUFVLGVBQWVBLEVBQU0sUUFBUSxHQUMzQyxDQUFnQyxFQUMvQixNQUFNLENBQUNFLEVBQVdDLEtBQ2YsR0FBRyxPQUNDLDJEQUE0REEs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bUNBLElBQVUsSUFBTSxPQUFTQSxDQUFLLGNBRTNFLEtBQUssa0JBQ0wsS0FBSyxLQUFLLFlBQWMsdUJBQXVCLEtBQUssZUFBZSxJQUFJLEtBQUssWUFBWSxXQUVwRixLQUFLLGtCQUFvQixLQUFLLGNBQzlCLFdBQVcsSUFBTSxDQUNiLEtBQUssVUFBWSxHQUVqQixLQUFLLGdCQUFrQixFQUN2QixLQUFLLEtBQUssWUFBYyxvQkFDNUIsRUFBRyxHQUFJLENBQ2YsQ0FTUSxZQUFZLENBQUUsVUFBQUMsRUFBVyxhQUFBQyxDQUFhLEVBQWtELENBQzVGLEdBQUksQ0FBQ0QsR0FBYSxDQUFDQyxFQUFjLE1BQU8sR0FDbkMsR0FBSUQsRUFBVyxDQUNoQixJQUFNRSxFQUFpQixPQUFPLFFBQVEsR0FBRyxPQUFPLElBQUksdUJBQXVCLENBQUMsRUFBRSxLQUMxRSxDQUFDLENBQUMsQ0FBRUMsQ0FBYSxJQUFNQSxJQUFrQkgsQ0FDN0MsRUFFQSxPQUFPRSxFQUFpQixPQUFPLFNBQVNBLEVBQWUsQ0FBQyxDQUFDLEVBQUksQ0FDakUsS0FDSSxRQUFPLE9BQU8sUUFBUSxHQUFHLE9BQU8sSUFBSSx1QkFBdUIsQ0FBQyxFQUN2RCxPQUFPLENBQUMsQ0FBQyxDQUFFQyxDQUFhLElBQU1GLEtBQWtCRSxHQUFpQixVQUFVLEVBQzNFLElBQUksQ0FBQyxDQUFDQyxDQUFXLElBQU0sT0FBTyxTQUFTQSxDQUFXLENBQUMsQ0FDaEUsQ0FDSixFQUVBLEdBQUcsT0FBTyxNQUFNLENBQUMsZ0JBQWdCLEVBQUcsSUFBTSxDQUNsQyxHQUFHLE9BQU8sSUFBSSxZQUFZLElBQU0sZ0JBQWdCLElBQUlkLEVBQXNCLEVBQUUsS0FBSyxDQUN6RixDQUFDIiwKICAibmFtZXMiOiBbIk1vbml0b3JpbmdMaXN0TWFuYWdlciIsICJmdWxsTGlua0VsZW1lbnQiLCAiZXZlbnQiLCAiZWxlbWVudCIsICJjaGVjayIsICJkYXRhIiwgImVycm9yQ29kZSIsICJlcnJvckluZm8iLCAiaGFuZGxlciIsICJjb3VudCIsICJuYW1lc3BhY2UiLCAibm90TmFtZXNwYWNlIiwgImZvdW5kTmFtZXNwYWNlIiwgIm5hbWVzcGFjZU5hbWUiLCAibmFtZXNwYWNlSWQiXQp9Cg==
